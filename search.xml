<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>XCPCä¸­çš„æ—¶é—´æŠ€å·§</title>
    <url>/2024/09/08/XCPC/Tips/XCPC%E4%B8%AD%E7%9A%84%E6%97%B6%E9%97%B4%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[<p>é™¤äº†æ—¶é—´å¤æ‚åº¦,è¿˜æœ‰ä»€ä¹ˆä¼šå½±å“ç¨‹åºçš„è¿è¡Œæ—¶é—´</p>
<span id="more"></span>

<p>æœ¬æ–‡åªæ¥è‡ªäºè‡ªå·±çš„åšé¢˜ç»éªŒï¼Œå¹¶æ²¡æœ‰å…¶ä»–æ¥æºï¼Œæ¬¢è¿çº é”™</p>
<p>å¯ä¾›éªŒè¯çš„é¢˜ç›®æœ‰</p>
<ol>
<li><a href="https://ac.nowcoder.com/acm/contest/7501/A">A-Intelligent Warehouse_2020ICPCÂ·å°ç±³ ç½‘ç»œé€‰æ‹”èµ›ç¬¬ä¸€åœº (nowcoder.com)</a></li>
</ol>
<h2 id="int-ä¸-long-long"><a href="#int-ä¸-long-long" class="headerlink" title="int ä¸ long long"></a>int ä¸ long long</h2><p>å¼€long long ä¼šæå¤§å¢åŠ ç¨‹åºè¿è¡Œçš„æ—¶é—´,æ‰€ä»¥å»ºè®®ä»”ç»†åˆ¤æ–­é¢˜ç›®æ˜¯å¦æœ‰å¼€long longçš„å¿…è¦,è€Œä¸æ˜¯æ¯é“é¢˜éƒ½åŠ #define int long long </p>
<h2 id="å®å®šä¹‰ä¸æ›¿æ¢"><a href="#å®å®šä¹‰ä¸æ›¿æ¢" class="headerlink" title="å®å®šä¹‰ä¸æ›¿æ¢"></a>å®å®šä¹‰ä¸æ›¿æ¢</h2><ol>
<li><p>å®å®šä¹‰(#define)ä¼šå¢åŠ è¿è¡Œæ—¶é—´</p>
</li>
<li><p>æ›¿æ¢(typedef&#x2F;const&#x2F;constexpr&#x2F;using)ä¹Ÿä¼šå¢åŠ è¿è¡Œæ—¶é—´</p>
</li>
</ol>
]]></content>
      <categories>
        <category>XCPC</category>
        <category>Tips</category>
      </categories>
  </entry>
  <entry>
    <title>å­åºåˆ—ç›¸å…³</title>
    <url>/2024/09/11/XCPC/XCPC%E6%A8%A1%E6%9D%BF/XCPC%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/</url>
    <content><![CDATA[<p>åŠ¨æ€è§„åˆ’ä¸­çš„å­åºåˆ—é—®é¢˜</p>
<span id="more"></span>

<p>å­åºåˆ—(subsequence)ä¸è¦æ±‚è¿ç»­ï¼Œä½†ç›¸å¯¹é¡ºåºä¸èƒ½æ”¹å˜</p>
<h2 id="æœ€é•¿ä¸Šå‡å­åºåˆ—-LIS"><a href="#æœ€é•¿ä¸Šå‡å­åºåˆ—-LIS" class="headerlink" title="æœ€é•¿ä¸Šå‡å­åºåˆ—(LIS)"></a>æœ€é•¿ä¸Šå‡å­åºåˆ—(LIS)</h2><p>Longest Increasing Subsequence</p>
<h3 id="O-n-2"><a href="#O-n-2" class="headerlink" title="O(n^2)"></a>O(n^2)</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//dp[i]è¡¨ç¤ºä»¥num[i]ç»“å°¾çš„æœ€é•¿ä¸Šå‡å­åºåˆ—</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">    dp[i]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;i;j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(num[j]&lt;num[i])&#123;</span><br><span class="line">            dp[i]=<span class="built_in">max</span>(dp[i],dp[j]<span class="number">+1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="O-nlogn"><a href="#O-nlogn" class="headerlink" title="O(nlogn)"></a>O(nlogn)</h3><p>äºŒåˆ†æ³•</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt;stk;<span class="comment">//æ¨¡æ‹Ÿå †æ ˆ</span></span><br><span class="line">    stk.<span class="built_in">push_back</span>(a[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i]&gt;stk.<span class="built_in">back</span>())&#123;</span><br><span class="line">            stk.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            *<span class="built_in">lower_bound</span>(stk.<span class="built_in">begin</span>(),stk.<span class="built_in">end</span>(),a[i])=a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//stk.size()ä¸ºLISé•¿åº¦</span></span><br></pre></td></tr></table></figure>

<h2 id="æœ€é•¿ä¸‹é™å­åºåˆ—-LDS"><a href="#æœ€é•¿ä¸‹é™å­åºåˆ—-LDS" class="headerlink" title="æœ€é•¿ä¸‹é™å­åºåˆ—(LDS)"></a>æœ€é•¿ä¸‹é™å­åºåˆ—(LDS)</h2><p>Longest Decreasing Subsequence,åæ–¹å‘çš„LIS</p>
<h3 id="O-nlogn-1"><a href="#O-nlogn-1" class="headerlink" title="O(nlogn)"></a>O(nlogn)</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt;stk;<span class="comment">//æ¨¡æ‹Ÿå †æ ˆ</span></span><br><span class="line">    stk.<span class="built_in">push_back</span>(a[n]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;=<span class="number">1</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i]&gt;stk.<span class="built_in">back</span>())&#123;</span><br><span class="line">            stk.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            *<span class="built_in">lower_bound</span>(stk.<span class="built_in">begin</span>(),stk.<span class="built_in">end</span>(),a[i])=a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="æœ€é•¿ä¸ä¸Šå‡å­åºåˆ—-LNIS"><a href="#æœ€é•¿ä¸ä¸Šå‡å­åºåˆ—-LNIS" class="headerlink" title="æœ€é•¿ä¸ä¸Šå‡å­åºåˆ—(LNIS)"></a>æœ€é•¿ä¸ä¸Šå‡å­åºåˆ—(LNIS)</h2><p>Longest Non-increasing Subsequence</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">stk.<span class="built_in">push_back</span>(a[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i]&lt;=stk.<span class="built_in">back</span>())&#123;</span><br><span class="line">            stk.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            *<span class="built_in">upper_bound</span>(stk.<span class="built_in">begin</span>(),stk.<span class="built_in">end</span>(),a[i],<span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;())=a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="æœ€é•¿å…¬å…±å­åºåˆ—-LCS"><a href="#æœ€é•¿å…¬å…±å­åºåˆ—-LCS" class="headerlink" title="æœ€é•¿å…¬å…±å­åºåˆ—(LCS)"></a>æœ€é•¿å…¬å…±å­åºåˆ—(LCS)</h2><p>Longest Common Subsequence</p>
<h3 id="O-nm"><a href="#O-nm" class="headerlink" title="O(nm)"></a>O(nm)</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;j++)&#123;</span><br><span class="line">        dp[i][j]=<span class="built_in">max</span>(dp[i][j<span class="number">-1</span>],dp[i<span class="number">-1</span>][j]);</span><br><span class="line">        <span class="keyword">if</span>(s[i]==t[j])&#123;</span><br><span class="line">           dp[i][j]=<span class="built_in">max</span>(dp[i][j],dp[i<span class="number">-1</span>][j<span class="number">-1</span>]<span class="number">+1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="O-nlogm"><a href="#O-nlogm" class="headerlink" title="O(nlogm)"></a>O(nlogm)</h3><p>ä¸€èˆ¬æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦ä¸ºO(nlogm)ï¼Œä½†æ˜¯æœ€åå¯é€€åŒ–è‡³O(nm)</p>
<p>å…·ä½“å°±æ˜¯å°†LCSé—®é¢˜è½¬åŒ–ä¸ºLISé—®é¢˜æ¥åš</p>
]]></content>
      <categories>
        <category>XCPC</category>
        <category>XCPCæ¨¡æ¿</category>
        <category>XCPCåŠ¨æ€è§„åˆ’</category>
      </categories>
  </entry>
  <entry>
    <title>2023ICPCç½‘ç»œèµ›(ä¸€)</title>
    <url>/2024/09/13/XCPC/XCPC%E7%B3%BB%E5%88%97%E8%B5%9B/2023ICPC%E7%BD%91%E7%BB%9C%E8%B5%9B(%E4%B8%80)/</url>
    <content><![CDATA[<span id="more"></span>

<h2 id="D-Transitivity"><a href="#D-Transitivity" class="headerlink" title="D. Transitivity"></a>D. Transitivity</h2><p>Given a <strong>simple undirected graph</strong> with $n$ vertices and $m$ edges, and itâ€™s guaranteed that</p>
<p>We define an undirected graph to be transitive if and only if for any two <strong>different</strong> vertices $u, v$ :</p>
<p>If there exists a path starting from $u$ and ending at $v$ in the graph, then there should exists an edge connected $u$ and $v$ in the graph.</p>
<p>Now you should add some undirected edges to the graph (<strong>add at least one edge</strong>). You need to ensure that after adding edges, the graph is still a simple undirected graph and is transitive.</p>
<p>The question is, how many edges need to be added at least?</p>
<p>Recall that a simple undirected graph is an undirected graph that does not have more than one edge between any two vertices and no edge starts and ends at the same vertex.</p>
<p>$n_{k}^9$</p>
]]></content>
      <categories>
        <category>XCPC</category>
        <category>XCPCç³»åˆ—èµ›</category>
      </categories>
  </entry>
  <entry>
    <title>ICPCÂ·2020Â·å°ç±³ç½‘ç»œèµ›äºŒ</title>
    <url>/2024/09/11/XCPC/XCPC%E7%B3%BB%E5%88%97%E8%B5%9B/ICPC%C2%B72020%C2%B7%E5%B0%8F%E7%B1%B3%E7%BD%91%E7%BB%9C%E8%B5%9B%E4%BA%8C/</url>
    <content><![CDATA[<span id="more"></span>

<h2 id="G-Shift-and-Reverse"><a href="#G-Shift-and-Reverse" class="headerlink" title="G Shift and Reverse"></a>G Shift and Reverse</h2><h3 id="Topic"><a href="#Topic" class="headerlink" title="Topic"></a>Topic</h3><p>Bobo has a sequence $a_1,a_2,\dots,a_n$. He can rearrange the sequence using the following operation any number of times:  </p>
<p>+ Select an integer i ($1 \le i \le n$) and change the sequence to $a_i, a_{i-1}, \dots, a_1, a_n, a_{n-1}, \dots, a_{i+1}$.  </p>
<p>Bobo would like to know the number of different sequences can be obtained modulo $(10^9+7)$.</p>
<p>æ³¢æ³¢æœ‰ä¸€ä¸ªåºåˆ—$a_1,a_2,\dots,a_n$ã€‚ä»–å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ“ä½œä»»æ„æ¬¡æ•°é‡æ–°æ’åˆ—åºåˆ—:</p>
<p>é€‰æ‹©æ•´æ•°i($1 \le i \le n$)å¹¶å°†åºåˆ—æ›´æ”¹ä¸º$a_i, a_{i-1}, \dots, a_1, a_n, a_{n-1}, \dots, a_{i+1}$ã€‚</p>
<p>Boboæƒ³çŸ¥é“æœ‰å¤šå°‘ä¸ªä¸åŒçš„åºåˆ—å¯¹$(10^9+7)$å–æ¨¡ã€‚</p>
<h3 id="Analyse"><a href="#Analyse" class="headerlink" title="Analyse"></a>Analyse</h3><p>é‡åˆ°é¢˜ç›®æ²¡æ€è·¯å°±å…ˆæ¨¡æ‹Ÿä¸€ä¸‹</p>
<p>ä¸€ä¸ªæ–°çš„æ•°ç»„a,æ ‡å·ä»a1-an,å‡å®šé€‰æ‹©kè¿›è¡Œåè½¬æ“ä½œï¼Œæ‰§è¡Œæ“ä½œåçš„åºåˆ—ä¸º$a_{k},a_{k-1}â€¦a_{k+2},a_{k+1},$</p>
]]></content>
      <categories>
        <category>XCPC</category>
        <category>XCPCç³»åˆ—èµ›</category>
      </categories>
  </entry>
  <entry>
    <title>ICPCç½‘ç»œèµ›ç¬¬ä¸€åœº</title>
    <url>/2024/09/08/XCPC/XCPC%E7%B3%BB%E5%88%97%E8%B5%9B/ICPC%E7%BD%91%E7%BB%9C%E8%B5%9B%E7%AC%AC%E4%B8%80%E5%9C%BA/</url>
    <content><![CDATA[<h2 id="A-Intelligent-Warehouse"><a href="#A-Intelligent-Warehouse" class="headerlink" title="A  Intelligent Warehouse"></a>A  Intelligent Warehouse</h2><h3 id="Topic"><a href="#Topic" class="headerlink" title="Topic"></a>Topic</h3><p>In <em>MI Intelligent Warehouse</em>, there are $n_{}$ products, where the $i_{}$-th product is of size $a_i$. We always need to box producsts into all kinds of containers, and it will be safer and more cost efficient(æ•ˆç‡é«˜çš„) if for any two sizes of products, one is the otherâ€™s multiple, since(å› ä¸º) there wonâ€™t be any residual(æ®‹ä½™çš„) room in one container. So for each boxing we need to choose some products that for any two chosen products, either $a_i$ is multiple of $a_j$ or $a_j$ is multiple of $a_i$. Print the maximum number of products that can be chosen in one boxing.</p>
<p>åœ¨miæ™ºèƒ½ä»“åº“ä¸­ï¼Œæœ‰$n_{}$ä¸ªäº§å“ï¼Œå…¶ä¸­$i_{}$ä¸ªäº§å“çš„å°ºå¯¸ä¸º$a_i$ã€‚æˆ‘ä»¬æ€»æ˜¯éœ€è¦æŠŠäº§å“è£…è¿›å„ç§å„æ ·çš„å®¹å™¨ä¸­ï¼Œå¦‚æœä»»æ„ä¸¤ä¸ªå°ºå¯¸çš„äº§å“ï¼Œä¸€ä¸ªæ˜¯å¦ä¸€ä¸ªçš„å€æ•°ï¼Œè¿™æ ·ä¼šæ›´å®‰å…¨ä¸”æˆæœ¬æ•ˆç›Šæ›´é«˜ï¼Œå› ä¸ºä¸€ä¸ªå®¹å™¨é‡Œä¸ä¼šæœ‰å‰©ä½™çš„ç©ºé—´ã€‚å› æ­¤ï¼Œå¯¹äºæ¯æ¬¡è£…ç®±ï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€äº›äº§å“ï¼Œå¯¹äºä»»æ„ä¸¤ä¸ªé€‰æ‹©çš„äº§å“ï¼Œè¦ä¹ˆæ˜¯$a_i$æ˜¯$a_j$çš„å€æ•°ï¼Œè¦ä¹ˆæ˜¯$a_j$æ˜¯$a_i$çš„å€æ•°ã€‚æ‰“å°å‡ºåœ¨ä¸€æ¬¡è£…ç®±ä¸­é€‰æ‹©çš„äº§å“çš„æœ€å¤§æ•°é‡ã€‚</p>
<h3 id="Analyse"><a href="#Analyse" class="headerlink" title="Analyse"></a>Analyse</h3><p>ç›®çš„æ˜¯é€‰æ‹©è‹¥å¹²ä¸ªæ•°å­—ï¼Œå…¶ä¸­ä»»æ„ä¸¤ä¸ªæ•°å‡æˆå€æ•°å…³ç³»</p>
<p>è€ƒè™‘æœ€ç»ˆé€‰å®šçš„åºåˆ—ï¼Œå°†å…¶æ’åºåï¼Œæ¯ä¸ªæ•°éƒ½å¿…ç„¶æ˜¯æœ€å¤§æ•°çš„çº¦æ•°ï¼Œæ‰€ä»¥å…¶å®å­˜åœ¨ä¸€ç§é€’æ¨å…³ç³»ï¼Œå½“$ai$æ˜¯æŸä¸ªæ•°åˆ—çš„æœ€å¤§æ•°æ—¶ï¼Œå°†$ai$çš„å€æ•°åŠ è¿›æ¥ï¼Œæ•´ä¸ªæ•°åˆ—å¿…ç„¶ä¹Ÿæ»¡è¶³æ¡ä»¶</p>
<p>è€ƒè™‘dpï¼Œdp[i]è¡¨ç¤ºä»¥iç»“å°¾çš„æœ€é•¿åºåˆ—ï¼Œdpå…³ç³»å¼ä¹Ÿå¦‚ä¸Šæ–‡æ‰€è¯´</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N=<span class="number">1e7</span>;</span><br><span class="line"><span class="type">int</span> dp[N<span class="number">+10</span>],mp[N<span class="number">+10</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="type">int</span> x;cin&gt;&gt;x;</span><br><span class="line">        mp[x]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(mp[i])&#123;</span><br><span class="line">            dp[i]+=mp[i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i*<span class="number">2</span>;j&lt;=N;j+=i)&#123;</span><br><span class="line">                dp[j]=<span class="built_in">max</span>(dp[i],dp[j]);</span><br><span class="line">            &#125;</span><br><span class="line">            ans=<span class="built_in">max</span>(ans,dp[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="B-Intelligent-Robot"><a href="#B-Intelligent-Robot" class="headerlink" title="B  Intelligent Robot"></a>B  Intelligent Robot</h2><h2 id="C-Smart-Browser"><a href="#C-Smart-Browser" class="headerlink" title="C  Smart Browser"></a>C  Smart Browser</h2><h3 id="Topic-1"><a href="#Topic-1" class="headerlink" title="Topic"></a>Topic</h3><p>In some social platforms(ç¤¾äº¤å¹³å°), there are some netizen(å¹³å°) who like to post â€œ<em>www</em>â€œ. Since the string is like the grass(è‰), which contains plenty of â€œ&#x2F;\â€œ shapes, so there are also some netizen who post â€œ<em>grass</em>â€œ.  </p>
<p>As a fast, smart, and convenient browser, <em>MI Browser</em> can recognize this kind of text and show some special effects. Specifically(å…·ä½“æ¥è¯´), given a string, <em>MI Browser</em> will determine(ç¡®å®š) the number of â€œ&#x2F;\â€œ shapes made by character â€œ<em>w</em>â€œ, where â€œ<em>w</em>â€œ itself and the gap(é—´éš™) between two adjacent(ç›¸é‚»çš„) â€œ<em>w</em>â€œs both give one `&#x2F;\` shape. If still not clear, please turn to sample input&#x2F;output for more details.  </p>
<p>As a <em>MI fan</em>, you want to detect(æ¢ç©¶) the relationship between the special effects and the number of â€œ&#x2F;\â€œ shapes, so the thing you should do first is to determine the number of â€œ&#x2F;\â€œ shapes by yourself.</p>
<p>åœ¨ä¸€äº›ç¤¾äº¤å¹³å°ä¸Šï¼Œæœ‰äº›ç½‘æ°‘å–œæ¬¢å‘å¸ƒâ€œwwwâ€ã€‚ç”±äºè¿™ä¸ªå­—ç¬¦ä¸²çœ‹èµ·æ¥å¾ˆåƒè‰ï¼Œå…¶ä¸­åŒ…å«äº†è®¸å¤šâ€œ&#x2F;\â€çš„å½¢çŠ¶ï¼Œå› æ­¤ä¹Ÿæœ‰ä¸€äº›ç½‘æ°‘å‘å¸ƒâ€œgrassâ€ã€‚</p>
<p>ä½œä¸ºä¸€æ¬¾å¿«é€Ÿã€æ™ºèƒ½ä¸”ä¾¿æ·çš„æµè§ˆå™¨ï¼ŒMIæµè§ˆå™¨èƒ½å¤Ÿè¯†åˆ«è¿™ç§æ–‡æœ¬å¹¶å±•ç¤ºä¸€äº›ç‰¹æ®Šæ•ˆæœã€‚å…·ä½“æ¥è¯´ï¼Œç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒMIæµè§ˆå™¨ä¼šç¡®å®šç”±å­—ç¬¦â€œwâ€æ„æˆçš„â€œ&#x2F;\â€å½¢çŠ¶çš„æ•°é‡ï¼Œå…¶ä¸­â€œwâ€æœ¬èº«ä»¥åŠä¸¤ä¸ªç›¸é‚»â€œwâ€ä¹‹é—´çš„é—´éš™éƒ½æ„æˆä¸€ä¸ªâ€œ&#x2F;\â€å½¢çŠ¶ã€‚å¦‚æœä»ç„¶ä¸æ¸…æ¥šï¼Œè¯·å‚è€ƒç¤ºä¾‹è¾“å…¥è¾“å‡ºä»¥è·å–æ›´å¤šè¯¦æƒ…ã€‚</p>
<p>ä½œä¸ºMIæµè§ˆå™¨çš„ç²‰ä¸ï¼Œä½ æƒ³è¦æ¢ç©¶è¿™äº›ç‰¹æ®Šæ•ˆæœä¸â€œ&#x2F;\â€å½¢çŠ¶æ•°é‡ä¹‹é—´çš„å…³ç³»ï¼Œå› æ­¤ä½ é¦–å…ˆè¦åšçš„å°±æ˜¯è‡ªå·±ç¡®å®šâ€œ&#x2F;\â€å½¢çŠ¶çš„æ•°é‡ã€‚</p>
<h3 id="Analyse-1"><a href="#Analyse-1" class="headerlink" title="Analyse"></a>Analyse</h3><p>åŒæŒ‡é’ˆåˆ¤æ–­ä»¥våˆ†éš”å¼€çš„wçš„å­—ç¬¦æ•°é‡</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    string s;cin&gt;&gt;s;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s.<span class="built_in">length</span>();i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i]==<span class="string">&#x27;w&#x27;</span>)&#123;</span><br><span class="line">            <span class="type">int</span> cnt=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span>(s[i<span class="number">+1</span>]==<span class="string">&#x27;w&#x27;</span>&amp;&amp;i<span class="number">+1</span>&lt;s.<span class="built_in">length</span>())&#123;</span><br><span class="line">                i++;cnt++;</span><br><span class="line">            &#125;</span><br><span class="line">            ans+=<span class="number">2</span>*cnt<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>XCPC</category>
        <category>XCPCç³»åˆ—èµ›</category>
      </categories>
  </entry>
  <entry>
    <title>2024CCPCç½‘ç»œèµ›</title>
    <url>/2024/09/12/XCPC/XCPC%E7%B3%BB%E5%88%97%E8%B5%9B/2024CCPC%E7%BD%91%E7%BB%9C%E8%B5%9B/</url>
    <content><![CDATA[<span id="more"></span>

<h2 id="B-å†›è®­-II"><a href="#B-å†›è®­-II" class="headerlink" title="B å†›è®­ II"></a>B å†›è®­ II</h2><p>å¯¹äºè¿™ç±»é—®é¢˜ä¸€ä¸ªå¾ˆç»å…¸çš„æ€è·¯å°±æ˜¯æ±‚æ¯ä¸ªä½ç½®çš„è´¡çŒ®</p>
<p>é¦–å…ˆèƒ½æ„Ÿæ€§çš„åˆ¤æ–­å‡ºæ¥ä»å°åˆ°å¤§&#x2F;ä»å¤§åˆ°å°æ’ä¸æ•´é½åº¦æ˜¯æœ€å°çš„(å› ä¸ºæœ€å¤§&#x2F;æœ€å°å€¼éƒ½æ˜¯ä¾æ¬¡é€’å¢çš„)</p>
<p>ç„¶åå¯ä»¥ç†æ€§çš„è¯æ˜ä¸€ä¸‹ï¼š</p>
<p>å¯¹äºå·²ç»æ’å¥½åºçš„æ•°ç»„a æœ‰a1&lt;&#x3D;a2&lt;&#x3D;a3&lt;&#x3D;â€¦&lt;&#x3D;an,æ­¤æ—¶äº¤æ¢a2,ak(å‡è®¾a2&lt;ak);</p>
<p>äº¤æ¢å®Œçš„ç»“æœå°±æ˜¯låœ¨[1,k-1],råœ¨[l,k-1]çš„åŒºé—´å†…æœ€å¤§å€¼å˜å¤§ï¼Œæœ€å°å€¼ä¸å˜,låœ¨[k,n]ï¼Œråœ¨[l,n]çš„åŒºé—´å†…æœ€å¤§å€¼ä¸å˜ï¼Œæœ€å°å€¼å˜å°</p>
<p>èº«é«˜ç›¸åŒçš„äººå¯ä»¥äº¤æ¢ä½ç½®,$A_{k}^k$,è¡¨ç¤ºkä¸ªèº«é«˜ç›¸åŒçš„äººçš„æ’åˆ—æ–¹æ¡ˆ,</p>
<p>æ³¨æ„ç‰¹åˆ¤å…¨ç›¸ç­‰åºåˆ—(ä»å°åˆ°å¤§å’Œä»å¤§åˆ°å°æ’åˆ—ä¸€æ ·)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;cin&gt;&gt;n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;<span class="built_in">a</span>(n);</span><br><span class="line">    map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;mp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;a[i];mp[a[i]]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> ans1=<span class="number">0</span>,ans2=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=i;j&lt;n;j++)&#123;</span><br><span class="line">            ans1+=a[j]-a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">auto</span> A=[&amp;](<span class="type">int</span> x)&#123;</span><br><span class="line">        <span class="type">int</span> tem=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=x;i++)&#123;</span><br><span class="line">            tem=(tem*i)%mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tem;</span><br><span class="line">    &#125;;</span><br><span class="line">    a.<span class="built_in">erase</span>(<span class="built_in">unique</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>()),a.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i:a)&#123;</span><br><span class="line">        ans2=(ans2*<span class="built_in">A</span>(mp[i]))%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(a.<span class="built_in">size</span>()!=<span class="number">1</span>) ans2=(ans2*<span class="number">2</span>)%mod;</span><br><span class="line">    cout&lt;&lt;ans1&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;ans2&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="K-å–æ²™å­æ¸¸æˆ"><a href="#K-å–æ²™å­æ¸¸æˆ" class="headerlink" title="K å–æ²™å­æ¸¸æˆ"></a>K å–æ²™å­æ¸¸æˆ</h2><p>è€ƒè™‘nçš„å¥‡å¶æ€§</p>
<p>å½“nä¸ºå¥‡æ•°æ—¶ï¼Œç¬¬ä¸€æ‰‹å–1å¿…ç„¶è·èƒœ</p>
<p>å½“nä¸ºå¶æ•°æ—¶ï¼Œè€ƒè™‘å˜æˆå¿…èƒœæ€ï¼Œå³å°†nå‡å»æŸä¸¤ä¸ªæ•°å¾—åˆ°å¥‡æ•°ï¼Œå¯çŸ¥è¿™ä¸¤ä¸ªæ•°å¿…ç„¶ä¸ºä¸€å¥‡ä¸€å¶ï¼Œä¸”å…ˆæ‰‹å¿…é€‰å¶æ•°ï¼Œå½“å…ˆæ‰‹é€‰æ‹©å¥‡æ•°åï¼Œåæ‰‹å¿…èƒœã€‚</p>
<p>ç”±äºé€‰æ‹©çš„æ˜¯å¶æ•°ï¼Œåˆæ­¥çŒœæƒ³å¯„äº†ï¼Œå› ä¸ºåæ‰‹å¿…ç„¶ä¸ä¼šé€‰æ‹©å¥‡æ•°ï¼Œæ‰€ä»¥åæ‰‹é€‰æ‹©å¶æ•°é˜»æ­¢å…ˆæ‰‹åˆ°è¾¾å¿…èƒœæ€ï¼Œæ­¤æ—¶ç¬¬äºŒè½®åˆ°è¾¾å…ˆæ‰‹æ‰‹ä¸Šçš„æ•°è¿˜æ˜¯å¶æ•°ï¼Œè¿™æ ·å½’çº³ä¸€ä¸‹å¯ä»¥å‘ç°å½“nä¸ºå¶æ•°çš„æ—¶å€™ï¼Œå…ˆåæ‰‹éƒ½åªä¼šé€‰æ‹©å¶æ•°</p>
<p>è€ƒè™‘äºŒè¿›åˆ¶ï¼Œå½“å…ˆæ‰‹ç¬¬ä¸€æ¬¡é€‰æ‹©lowbit(n)æ—¶ï¼Œåæ‰‹æ— è®ºé€‰æ‹©ä»€ä¹ˆæˆ‘ä»¬éƒ½å’Œå…¶é€‰æ‹©ä¸€æ ·å³å¯è·èƒœï¼Œå› ä¸ºäºŒè¿›åˆ¶ä¸‹éœ€è¦å¶æ•°æ¬¡é€‰æ‹©å¶æ•°æ‰èƒ½å°†è¿™ä¸ªæ•°å½’é›¶</p>
]]></content>
      <categories>
        <category>XCPC</category>
        <category>XCPCç³»åˆ—èµ›</category>
      </categories>
  </entry>
  <entry>
    <title>XCPCæ•°è®º</title>
    <url>/2024/09/11/XCPC/XCPC%E6%A8%A1%E6%9D%BF/XCPC/XCPC%E6%95%B0%E8%AE%BA/</url>
    <content><![CDATA[<p>ä»‹ç»XCPCèµ›äº‹ä¸­æ•°è®ºçš„çŸ¥è¯†</p>
<span id="more"></span>

<h1 id="æ•°è®º"><a href="#æ•°è®º" class="headerlink" title="æ•°è®º"></a>æ•°è®º</h1><h2 id="å¿«é€Ÿå¹‚-Power"><a href="#å¿«é€Ÿå¹‚-Power" class="headerlink" title="å¿«é€Ÿå¹‚(Power)"></a>å¿«é€Ÿå¹‚(Power)</h2><p>å¿«é€Ÿå¹‚æ±‚$a^b$ % pï¼Œå…¶ä¸­a,b,på‡âˆˆ[1,1e9],æ—¶é—´å¤æ‚åº¦ä¸º$O(logb)$</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">power</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b /= <span class="number">2</span>, a = a * a % p) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b % <span class="number">2</span>) &#123;</span><br><span class="line">            res = <span class="number">1LL</span> * res * a % p;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¿«é€Ÿå¹‚æ±‚è´¨æ•°çš„ä¹˜æ³•é€†å…ƒ"><a href="#å¿«é€Ÿå¹‚æ±‚è´¨æ•°çš„ä¹˜æ³•é€†å…ƒ" class="headerlink" title="å¿«é€Ÿå¹‚æ±‚è´¨æ•°çš„ä¹˜æ³•é€†å…ƒ"></a>å¿«é€Ÿå¹‚æ±‚è´¨æ•°çš„ä¹˜æ³•é€†å…ƒ</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¿«é€Ÿå¹‚æ±‚x mod pçš„ä¹˜æ³•é€†å…ƒï¼šé€‚ç”¨äºpä¸ºè´¨æ•°</span></span><br><span class="line">powerï¼ˆx,p<span class="number">-2</span>,pï¼‰</span><br></pre></td></tr></table></figure>

<h2 id="é¾Ÿé€Ÿä¹˜"><a href="#é¾Ÿé€Ÿä¹˜" class="headerlink" title="é¾Ÿé€Ÿä¹˜"></a>é¾Ÿé€Ÿä¹˜</h2><p>æ±‚(ğ‘âˆ—ğ‘)ğ‘šğ‘œğ‘‘ğ‘çš„å€¼ï¼Œaï¼Œbï¼ŒpèŒƒå›´å‡[1,1e18]ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">LL <span class="title">qadd</span><span class="params">(LL a, LL b, LL p)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = (res + a) % p;</span><br><span class="line">        a = (a + a) % p;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> res;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="exgcd"><a href="#exgcd" class="headerlink" title="exgcd"></a>exgcd</h2><p>x,yä¸ºå¯è¡Œè§£ï¼Œgä¸ºaï¼Œbçš„gcd</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> &amp;x, <span class="type">int</span> &amp;y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> g = <span class="built_in">exgcd</span>(b, a % b, y, x);</span><br><span class="line">    y -= a / b * x;</span><br><span class="line">    <span class="keyword">return</span> g;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Pollard-Rho-Miller-Rabin"><a href="#Pollard-Rho-Miller-Rabin" class="headerlink" title="Pollard-Rho &amp; Miller Rabin"></a>Pollard-Rho &amp; Miller Rabin</h2><p>æœŸæœ›å¤æ‚åº¦O($n^{1&#x2F;4}$)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">namespace</span> factor &#123;</span><br><span class="line">    <span class="keyword">using</span> f64 = <span class="type">long</span> <span class="type">double</span>;</span><br><span class="line">    ll p;</span><br><span class="line">    f64 invp;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setmod</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">        p = x, invp = (f64) <span class="number">1</span> / x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">mul</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">        ll z = a * invp * b + <span class="number">0.5</span>;</span><br><span class="line">        ll res = a * b - z * p;</span><br><span class="line">        <span class="keyword">return</span> res + (res &gt;&gt; <span class="number">63</span> &amp; p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">pow</span><span class="params">(ll a, ll x, ll res = <span class="number">1</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(;x;x &gt;&gt;= <span class="number">1</span>, a = <span class="built_in">mul</span>(a, a))</span><br><span class="line">            <span class="keyword">if</span>(x &amp; <span class="number">1</span>) res = <span class="built_in">mul</span>(res, a);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">rho</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!(n &amp; <span class="number">1</span>)) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="function"><span class="type">static</span> std::mt19937_64 <span class="title">gen</span><span class="params">((<span class="type">size_t</span>)<span class="string">&quot;hehezhou&quot;</span>)</span></span>;</span><br><span class="line">        ll x = <span class="number">0</span>, y = <span class="number">0</span>, prod = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">auto</span> f = [&amp;](ll o) &#123; <span class="keyword">return</span> <span class="built_in">mul</span>(o, o) + <span class="number">1</span>; &#125;;</span><br><span class="line">        <span class="built_in">setmod</span>(n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> t = <span class="number">30</span>, z = <span class="number">0</span>;t % <span class="number">64</span> || std::<span class="built_in">gcd</span>(prod, n) == <span class="number">1</span>;++t) &#123;</span><br><span class="line">            <span class="keyword">if</span> (x == y) x = ++ z, y = <span class="built_in">f</span>(x);</span><br><span class="line">            <span class="keyword">if</span>(ll q = <span class="built_in">mul</span>(prod, x + n - y)) prod = q;</span><br><span class="line">            x = <span class="built_in">f</span>(x), y = <span class="built_in">f</span>(<span class="built_in">f</span>(y));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> std::<span class="built_in">gcd</span>(prod, n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">checkprime</span><span class="params">(ll p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(p == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">setmod</span>(p);</span><br><span class="line">        ll d = __builtin_ctzll(p - <span class="number">1</span>), s = (p - <span class="number">1</span>) &gt;&gt; d;</span><br><span class="line">        <span class="keyword">for</span>(ll a : &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">82</span>, <span class="number">373</span>&#125;) &#123;</span><br><span class="line">            <span class="keyword">if</span>(a % p == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            ll x = <span class="built_in">pow</span>(a, s), y;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; d;++i, x = y) &#123;</span><br><span class="line">                y = <span class="built_in">mul</span>(x, x);</span><br><span class="line">                <span class="keyword">if</span>(y == <span class="number">1</span> &amp;&amp; x != <span class="number">1</span> &amp;&amp; x != p - <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(x != <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">std::vector&lt;ll&gt; <span class="title">factor</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">        std::queue&lt;ll&gt; q; q.<span class="built_in">push</span>(x);</span><br><span class="line">        std::vector&lt;ll&gt; res;</span><br><span class="line">        <span class="keyword">for</span>(;q.<span class="built_in">size</span>();) &#123;</span><br><span class="line">            ll x = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(x == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">checkprime</span>(x)) &#123;</span><br><span class="line">                res.<span class="built_in">push_back</span>(x);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ll y = <span class="built_in">rho</span>(x);</span><br><span class="line">            q.<span class="built_in">push</span>(y), q.<span class="built_in">push</span>(x / y);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(res.<span class="built_in">begin</span>(), res.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll n; cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">if</span>(factor::<span class="built_in">checkprime</span>(n)) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Prime&quot;</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">auto</span> res = factor::<span class="built_in">factor</span>(n);</span><br><span class="line">        <span class="comment">//è¿”å›nçš„è´¨å› å­ï¼Œæœ‰é‡å¤ï¼Œå³resä¸­å…ƒç´ ä¹˜ç§¯å°±æ˜¯n</span></span><br><span class="line">        cout &lt;&lt; res.<span class="built_in">back</span>() &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="çº¿æ€§ç­›-æ¬§æ‹‰ç­›-Sieve"><a href="#çº¿æ€§ç­›-æ¬§æ‹‰ç­›-Sieve" class="headerlink" title="çº¿æ€§ç­›&#x2F;æ¬§æ‹‰ç­›(Sieve)"></a>çº¿æ€§ç­›&#x2F;æ¬§æ‹‰ç­›(Sieve)</h2><p>æ—¶é—´å¤æ‚åº¦O(n)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; minp, primes;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sieve</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    minp.<span class="built_in">assign</span>(n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    primes.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (minp[i] == <span class="number">0</span>) &#123;</span><br><span class="line">            minp[i] = i;</span><br><span class="line">            primes.<span class="built_in">push_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> p : primes) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i * p &gt; n) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            minp[i * p] = p;</span><br><span class="line">            <span class="keyword">if</span> (p == minp[i]) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//primesæ•°ç»„å­˜å‚¨æ‰€æœ‰çš„è´¨æ•°ï¼Œminp[i]è¡¨ç¤ºiçš„æœ€å°è´¨å› å­</span></span><br></pre></td></tr></table></figure>

<h2 id="æœŸæœ›"><a href="#æœŸæœ›" class="headerlink" title="æœŸæœ›"></a>æœŸæœ›</h2><p>æœŸæœ›çš„çº¿æ€§æ€§è´¨ï¼š</p>
<p>$E[f(s)^{2}]&#x3D;\sum _{x&#x3D;start}^{end}x^{2}*P(x) $</p>
<p>ä¸¾ä¾‹ï¼š</p>
<p>$E[f(s)^{2}]$ è¡¨ç¤ºé›†åˆsä¸­æ‰€æœ‰æ•°çš„æŒ‰ä½å¼‚æˆ–ï¼Œå…¶ä¸­sä¸­çš„æ•°è¡¨ç¤ºä¸ºxï¼ŒèŒƒå›´ä¸º[0,1024] å°±å¯ä»¥å±•å¼€ä¸º$\sum _{x&#x3D;0}^{1024}x^{2}*P(x)$</p>
<p>å…¶ä¸­P(x)å¯ä»¥ç´¯ä¹˜ï¼Œæœ€ç»ˆä¹˜å–æ¨¡æ•°çš„é€†å…ƒæ±‚å‡ºç­”æ¡ˆ</p>
<h2 id="Matrix-Determinant-Lemma-çŸ©é˜µè¡Œåˆ—å¼å¼•ç†"><a href="#Matrix-Determinant-Lemma-çŸ©é˜µè¡Œåˆ—å¼å¼•ç†" class="headerlink" title="Matrix Determinant Lemma(çŸ©é˜µè¡Œåˆ—å¼å¼•ç†)"></a>Matrix Determinant Lemma(çŸ©é˜µè¡Œåˆ—å¼å¼•ç†)</h2><h3 id="å¼•ç†"><a href="#å¼•ç†" class="headerlink" title="å¼•ç†"></a>å¼•ç†</h3><p>å¯¹äºå¯é€†çŸ©é˜µA,å­˜åœ¨det($A+uv^T$)&#x3D;det(A)*($1+v^TA^{-1}u$)</p>
<h3 id="é¢˜å‹"><a href="#é¢˜å‹" class="headerlink" title="é¢˜å‹"></a>é¢˜å‹</h3><ol>
<li><a href="https://ac.nowcoder.com/acm/contest/7502/D">D-Determinant_2020ICPCÂ·å°ç±³ ç½‘ç»œé€‰æ‹”èµ›ç¬¬äºŒåœº (nowcoder.com)</a></li>
<li></li>
</ol>
<h2 id="ç»„åˆæ•°"><a href="#ç»„åˆæ•°" class="headerlink" title="ç»„åˆæ•°"></a>ç»„åˆæ•°</h2><h3 id="1-å¤šæ¬¡è¯¢é—®ï¼Œa-bèŒƒå›´è¾ƒå°ã€‚-ä¸€èˆ¬åœ¨å‡ åƒçš„æ•°æ®èŒƒå›´ï¼Œè¯¢é—®æ•°å¯ä»¥100000"><a href="#1-å¤šæ¬¡è¯¢é—®ï¼Œa-bèŒƒå›´è¾ƒå°ã€‚-ä¸€èˆ¬åœ¨å‡ åƒçš„æ•°æ®èŒƒå›´ï¼Œè¯¢é—®æ•°å¯ä»¥100000" class="headerlink" title="1.å¤šæ¬¡è¯¢é—®ï¼Œa,bèŒƒå›´è¾ƒå°ã€‚(ä¸€èˆ¬åœ¨å‡ åƒçš„æ•°æ®èŒƒå›´ï¼Œè¯¢é—®æ•°å¯ä»¥100000)"></a>1.å¤šæ¬¡è¯¢é—®ï¼Œa,bèŒƒå›´è¾ƒå°ã€‚(ä¸€èˆ¬åœ¨å‡ åƒçš„æ•°æ®èŒƒå›´ï¼Œè¯¢é—®æ•°å¯ä»¥100000)</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2010</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> c[N][N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i ++ )<span class="comment">//Næ˜¯max(a,b)å³è¯¢é—®çš„æœ€å¤§å€¼+10</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= i; j ++ )</span><br><span class="line">            <span class="keyword">if</span> (!j) c[i][j] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> c[i][j] = (c[i - <span class="number">1</span>][j] + c[i - <span class="number">1</span>][j - <span class="number">1</span>]) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">init</span>();<span class="comment">//é¢„å¤„ç†é¢˜ç›®ä¸­ç»™å®šçš„æ‰€æœ‰æ•°æ®</span></span><br><span class="line">    <span class="keyword">while</span> (n -- )&#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, c[a][b]); &#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-å°‘é‡è¯¢é—®-10000-ï¼Œaï¼ŒbèŒƒå›´è¾ƒå¤§ï¼ˆä¸€èˆ¬åœ¨1e5ï¼‰"><a href="#2-å°‘é‡è¯¢é—®-10000-ï¼Œaï¼ŒbèŒƒå›´è¾ƒå¤§ï¼ˆä¸€èˆ¬åœ¨1e5ï¼‰" class="headerlink" title="2.å°‘é‡è¯¢é—®(10000)ï¼Œaï¼ŒbèŒƒå›´è¾ƒå¤§ï¼ˆä¸€èˆ¬åœ¨1e5ï¼‰"></a>2.å°‘é‡è¯¢é—®(10000)ï¼Œaï¼ŒbèŒƒå›´è¾ƒå¤§ï¼ˆä¸€èˆ¬åœ¨1e5ï¼‰</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> fact[N], infact[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k, <span class="type">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k)&#123;</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (LL)res * a % p;</span><br><span class="line">        a = (LL)a * a % p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> <span class="keyword">return</span> res;&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fact[<span class="number">0</span>] = infact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i ++ )&#123;</span><br><span class="line">        fact[i] = (LL)fact[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">        infact[i] = (LL)infact[i - <span class="number">1</span>] * <span class="built_in">qmi</span>(i, mod - <span class="number">2</span>, mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> n;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">while</span> (n -- )&#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (LL)fact[a] * infact[b] % mod * infact[a - b] % mod);&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-æå°‘è¯¢é—®-åï¼Œç™¾ï¼Œåƒ-ï¼Œaï¼Œbæå¤§èŒƒå›´ï¼ˆ1e18ï¼‰-på¯ä»¥åˆ°1e5"><a href="#3-æå°‘è¯¢é—®-åï¼Œç™¾ï¼Œåƒ-ï¼Œaï¼Œbæå¤§èŒƒå›´ï¼ˆ1e18ï¼‰-på¯ä»¥åˆ°1e5" class="headerlink" title="3.æå°‘è¯¢é—®(åï¼Œç™¾ï¼Œåƒ)ï¼Œaï¼Œbæå¤§èŒƒå›´ï¼ˆ1e18ï¼‰,på¯ä»¥åˆ°1e5"></a>3.æå°‘è¯¢é—®(åï¼Œç™¾ï¼Œåƒ)ï¼Œaï¼Œbæå¤§èŒƒå›´ï¼ˆ1e18ï¼‰,på¯ä»¥åˆ°1e5</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k, <span class="type">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k)&#123;</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (LL)res * a % p;</span><br><span class="line">        a = (LL)a * a % p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b &gt; a) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, j = a; i &lt;= b; i ++, j -- )&#123;</span><br><span class="line">        res = (LL)res * j % p;</span><br><span class="line">        res = (LL)res * <span class="built_in">qmi</span>(i, p - <span class="number">2</span>, p) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lucas</span><span class="params">(LL a, LL b, <span class="type">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; p &amp;&amp; b &lt; p) <span class="keyword">return</span> <span class="built_in">C</span>(a, b, p);</span><br><span class="line">    <span class="keyword">return</span> (LL)<span class="built_in">C</span>(a % p, b % p, p) * <span class="built_in">lucas</span>(a / p, b / p, p) % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n; cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n -- )&#123;</span><br><span class="line">        LL a, b;</span><br><span class="line">        <span class="type">int</span> p;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; p;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">lucas</span>(a, b, p) &lt;&lt; endl;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-ä¸modpï¼Œé…åˆé«˜ç²¾åº¦ç®—å‡ºç­”æ¡ˆ"><a href="#4-ä¸modpï¼Œé…åˆé«˜ç²¾åº¦ç®—å‡ºç­”æ¡ˆ" class="headerlink" title="4.ä¸modpï¼Œé…åˆé«˜ç²¾åº¦ç®—å‡ºç­”æ¡ˆ"></a>4.ä¸modpï¼Œé…åˆé«˜ç²¾åº¦ç®—å‡ºç­”æ¡ˆ</h3><p>è¿ç”¨å®šä¹‰ğ¶ğ‘ğ‘&#x3D;ğ‘!&#x2F;ğ‘!âˆ—(ğ‘âˆ’ğ‘)!,å°†ğ¶ğ‘ğ‘åˆ†è§£è´¨å› æ•°æ‹†æˆğ‘ğ›¼1Ã—ğ‘ğ›¼2Ã—â€¦Ã—ğ‘ğ‘ğ‘˜ï¼ˆæŒ‡æ•°å¯ä»¥ä¸º1ï¼‰,å³å°†æ‰€æœ‰é˜¶ä¹˜å…¨éƒ¨åˆ†è§£ä¸ºè´¨å› æ•°ç›¸ä¹˜ï¼Œå†å°†åˆ†å­åˆ†æ¯ä¸­å‡å‡ºç°è¿‡çš„æŠµæ¶ˆæ‰ï¼Œå°†é™¤æ³•è½¬åŒ–ä¸ºä¹˜æ³•ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5010</span>;</span><br><span class="line"><span class="type">int</span> primes[N], cnt;</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_primes</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i ++ )&#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) primes[cnt ++ ] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; primes[j] &lt;= n / i; j ++ )&#123;</span><br><span class="line">            st[primes[j] * i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % primes[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n)&#123;</span><br><span class="line">        res += n / p;</span><br><span class="line">        n /= p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">mul</span><span class="params">(vector&lt;<span class="type">int</span>&gt; a, <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; c;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i ++ )&#123;</span><br><span class="line">        t += a[i] * b;</span><br><span class="line">        c.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (t)&#123;</span><br><span class="line">        c.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a, b; cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="built_in">get_primes</span>(a);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cnt; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> p = primes[i];</span><br><span class="line">        sum[i] = <span class="built_in">get</span>(a, p) - <span class="built_in">get</span>(a - b, p) - <span class="built_in">get</span>(b, p);</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">    res.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cnt; i ++ )</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; sum[i]; j ++ )</span><br><span class="line">            res = <span class="built_in">mul</span>(res, primes[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = res.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -- ) <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, res[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>XCPC</category>
        <category>XCPCæ¨¡æ¿</category>
        <category>XCPCæ•°è®º</category>
      </categories>
      <tags>
        <tag>Power</tag>
        <tag>Qadd</tag>
        <tag>Exgcd</tag>
        <tag>Pollard-Rho</tag>
        <tag>Miller Rabin</tag>
        <tag>Sieve</tag>
        <tag>Expectation</tag>
        <tag>Matrix Determinant Lemma</tag>
        <tag>Combination</tag>
      </tags>
  </entry>
  <entry>
    <title>XCPCæ•°æ®ç»“æ„</title>
    <url>/2024/09/11/XCPC/XCPC%E6%A8%A1%E6%9D%BF/XCPC/XCPC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
    <content><![CDATA[<p>ä»‹ç»XCPCèµ›äº‹ä¸­çš„åˆä¸­é«˜çº§æ•°æ®ç»“æ„ï¼Œå¹¶å¯¹éƒ¨åˆ†è¿›è¡Œäº†ä¸€å®šç¨‹åº¦ä¸Šçš„å°è£…</p>
<span id="more"></span>

<h1 id="XCPC-æ•°æ®ç»“æ„"><a href="#XCPC-æ•°æ®ç»“æ„" class="headerlink" title="XCPC æ•°æ®ç»“æ„"></a>XCPC æ•°æ®ç»“æ„</h1><h2 id="åŒå“ˆå¸Œå°è£…"><a href="#åŒå“ˆå¸Œå°è£…" class="headerlink" title="åŒå“ˆå¸Œå°è£…"></a>åŒå“ˆå¸Œå°è£…</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Shash</span>&#123;  </span><br><span class="line">    <span class="type">const</span> ll base[<span class="number">2</span>]=&#123;<span class="number">29</span>,<span class="number">31</span>&#125;;</span><br><span class="line">    <span class="comment">//baseå­˜å‚¨åŸºæ•°</span></span><br><span class="line">    <span class="type">const</span> ll hashmod[<span class="number">2</span>]=&#123;(ll)<span class="number">1e9</span><span class="number">+9</span>,<span class="number">998244353</span>&#125;;</span><br><span class="line">    <span class="comment">//hashmodå­˜å‚¨æ¨¡æ•°</span></span><br><span class="line">    array&lt;vector&lt;ll&gt;,2&gt;hsh;</span><br><span class="line">    array&lt;vector&lt;ll&gt;,2&gt;pwMod;</span><br><span class="line">    <span class="comment">//hsh[2] å’Œ pwMod[2]ï¼šè¿™ä¸¤ä¸ªäºŒç»´ vector åˆ†åˆ«ç”¨äºå­˜å‚¨å“ˆå¸Œå€¼å’Œå¹‚æ¨¡å€¼ã€‚</span></span><br><span class="line">    <span class="comment">//å…¶ä¸­ï¼Œhsh[i][j] è¡¨ç¤ºå­—ç¬¦ä¸²å‰ j ä¸ªå­—ç¬¦åœ¨åŸºæ•° base[i] å’Œæ¨¡æ•° hashmod[i] ä¸‹çš„å“ˆå¸Œå€¼ï¼›</span></span><br><span class="line">    <span class="comment">//pwMod[i][j] è¡¨ç¤ºåŸºæ•° base[i] çš„ j æ¬¡å¹‚å¯¹ hashmod[i] å–æ¨¡çš„ç»“æœã€‚</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(string S)</span></span>&#123;</span><br><span class="line">        <span class="type">int</span> n=S.<span class="built_in">size</span>();S=<span class="string">&#x27; &#x27;</span>+S;</span><br><span class="line">        hsh[<span class="number">0</span>].<span class="built_in">resize</span>(n<span class="number">+1</span>),hsh[<span class="number">1</span>].<span class="built_in">resize</span>(n<span class="number">+1</span>);</span><br><span class="line">        pwMod[<span class="number">0</span>].<span class="built_in">resize</span>(n<span class="number">+1</span>),pwMod[<span class="number">1</span>].<span class="built_in">resize</span>(n<span class="number">+1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>;++i)&#123;</span><br><span class="line">            pwMod[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line">                pwMod[i][j]=pwMod[i][j<span class="number">-1</span>]*base[i]%hashmod[i];</span><br><span class="line">                hsh[i][j]=(hsh[i][j<span class="number">-1</span>]*base[i]+S[j])%hashmod[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//getå‡½æ•°è¾“å‡º[l,r]è¿™æ®µå­—ç¬¦çš„å“ˆå¸Œå€¼,firstæ˜¯ç¬¬ä¸€ä¸ªæ¨¡æ•°ä¸‹å“ˆå¸Œå€¼,secondæ˜¯ç¬¬äºŒä¸ª</span></span><br><span class="line">    pair&lt;ll,ll&gt;<span class="built_in">get</span>(<span class="type">int</span> l,<span class="type">int</span> r)&#123;</span><br><span class="line">        pair&lt;ll,ll&gt; ans;</span><br><span class="line">        ans.first=(hsh[<span class="number">0</span>][r]-hsh[<span class="number">0</span>][l<span class="number">-1</span>]*pwMod[<span class="number">0</span>][r-l<span class="number">+1</span>])%hashmod[<span class="number">0</span>];</span><br><span class="line">        ans.second=(hsh[<span class="number">1</span>][r]-hsh[<span class="number">1</span>][l<span class="number">-1</span>]*pwMod[<span class="number">1</span>][r-l<span class="number">+1</span>])%hashmod[<span class="number">1</span>];</span><br><span class="line">        ans.first=(ans.first+hashmod[<span class="number">0</span>])%hashmod[<span class="number">0</span>];</span><br><span class="line">        ans.second=(ans.second+hashmod[<span class="number">1</span>])%hashmod[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">same</span><span class="params">(Shash &amp;a,<span class="type">int</span> la,<span class="type">int</span> ra,Shash &amp;b,<span class="type">int</span> lb,<span class="type">int</span> rb)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">get</span>(la,ra)==b.<span class="built_in">get</span>(lb,rb);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å£°æ˜æ–¹å¼"><a href="#å£°æ˜æ–¹å¼" class="headerlink" title="å£°æ˜æ–¹å¼"></a>å£°æ˜æ–¹å¼</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">Shash a;</span><br><span class="line">a.<span class="built_in">init</span>(s)<span class="comment">//sæ˜¯å¾…å¤„ç†å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">same</span>(a,l,r,b,l,r))<span class="comment">//åˆ¤æ–­å­—ç¬¦ä¸²a,båœ¨l,råŒºé—´å†…æ˜¯å¦ç›¸ç­‰    </span></span><br></pre></td></tr></table></figure>

<h3 id="åˆ é™¤æŸå‡ ä¸ªå­—ç¬¦ä¸²å¾—åˆ°æ–°çš„å“ˆå¸Œå€¼"><a href="#åˆ é™¤æŸå‡ ä¸ªå­—ç¬¦ä¸²å¾—åˆ°æ–°çš„å“ˆå¸Œå€¼" class="headerlink" title="åˆ é™¤æŸå‡ ä¸ªå­—ç¬¦ä¸²å¾—åˆ°æ–°çš„å“ˆå¸Œå€¼"></a>åˆ é™¤æŸå‡ ä¸ªå­—ç¬¦ä¸²å¾—åˆ°æ–°çš„å“ˆå¸Œå€¼</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å‡è®¾åˆ é™¤s[i],s[i+1]ä¸¤ä¸ªå­—ç¬¦ï¼Œå¾—åˆ°æ–°çš„å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼å°±æ˜¯hsh[i-1][0]*pmMod[n-(i+1)][0]+get(i+2,n).first</span></span><br><span class="line"><span class="comment">//(ä»¥ä¸Šä¸ºåœ¨ç¬¬ä¸€ä¸ªæ¨¡åº•ä¸‹çš„æ–°çš„å­—ç¬¦ä¸²å“ˆå¸Œå€¼)</span></span><br></pre></td></tr></table></figure>

<h2 id="å¹¶æŸ¥é›†"><a href="#å¹¶æŸ¥é›†" class="headerlink" title="å¹¶æŸ¥é›†"></a>å¹¶æŸ¥é›†</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">DSU</span> &#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; f,siz;</span><br><span class="line">    <span class="built_in">DSU</span>() &#123;&#125;</span><br><span class="line">    <span class="built_in">DSU</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        f.<span class="built_in">resize</span>(n);</span><br><span class="line">        <span class="built_in">iota</span>(f.<span class="built_in">begin</span>(), f.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">        siz.<span class="built_in">assign</span>(n, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (x != f[x]) &#123;</span><br><span class="line">            x = f[x] = f[f[x]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">same</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">find</span>(x) == <span class="built_in">find</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x = <span class="built_in">find</span>(x);</span><br><span class="line">        y = <span class="built_in">find</span>(y);</span><br><span class="line">        <span class="keyword">if</span> (x == y) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        siz[x] += siz[y];</span><br><span class="line">        f[y] = x;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">size</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> siz[<span class="built_in">find</span>(x)];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="å£°æ˜æ–¹å¼-1"><a href="#å£°æ˜æ–¹å¼-1" class="headerlink" title="å£°æ˜æ–¹å¼"></a>å£°æ˜æ–¹å¼</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">DSU <span class="title">dsu</span><span class="params">(N)</span><span class="comment">//å£°æ˜ä¸€ä¸ªå¤§å°ä¸ºNï¼Œåç§°ä¸ºdsuçš„å¹¶æŸ¥é›†</span></span></span><br><span class="line"><span class="function">dsu.<span class="title">merge</span><span class="params">(a,b)</span><span class="comment">//åˆå¹¶a,b</span></span></span><br><span class="line"><span class="function">dsu.<span class="title">find</span><span class="params">(x)</span><span class="comment">//æ‰¾åˆ°xçš„ç¥–å®—èŠ‚ç‚¹</span></span></span><br><span class="line"><span class="function">dsu.<span class="title">size</span><span class="params">(x)</span><span class="comment">//ä»¥xä¸ºç¥–å®—èŠ‚ç‚¹çš„ä¸ªæ•°    </span></span></span><br></pre></td></tr></table></figure>

<h2 id="çº¿æ®µæ ‘"><a href="#çº¿æ®µæ ‘" class="headerlink" title="çº¿æ®µæ ‘"></a>çº¿æ®µæ ‘</h2><h3 id="çº¿æ®µæ ‘-SegmentTree-Info"><a href="#çº¿æ®µæ ‘-SegmentTree-Info" class="headerlink" title="çº¿æ®µæ ‘ ( SegmentTree+Info )"></a>çº¿æ®µæ ‘ ( SegmentTree+Info )</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Info</span>&#123;</span><br><span class="line">    <span class="type">int</span> lc, rc, ls, rs, len, ans;</span><br><span class="line">&#125;;</span><br><span class="line">Info <span class="keyword">operator</span>+(Info a, Info b) &#123;</span><br><span class="line">    Info c = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    c.ans = <span class="built_in">max</span>(a.ans, b.ans);</span><br><span class="line">    <span class="keyword">if</span> (a.rc == <span class="number">0</span> &amp;&amp; b.lc == <span class="number">0</span>) c.ans = <span class="built_in">max</span>(c.ans, a.rs + b.ls);</span><br><span class="line">    c.lc = a.lc, c.rc = b.rc;</span><br><span class="line">    c.ls = a.ls;</span><br><span class="line">    <span class="keyword">if</span> (a.ls == a.len &amp;&amp; a.rc == b.lc) c.ls += b.ls;</span><br><span class="line">    c.rs = b.rs;</span><br><span class="line">    <span class="keyword">if</span> (b.rs == b.len &amp;&amp; a.rc == b.lc) c.rs += a.rs;</span><br><span class="line">    c.len = a.len + b.len;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">segtree</span>&#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="type">int</span> l, r;</span><br><span class="line">        Info info;</span><br><span class="line">    &#125; tr[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pull</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        tr[u].info = tr[u &lt;&lt; <span class="number">1</span>].info + tr[u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].info;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        tr[u] = &#123;l, r&#125;;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            tr[u].info = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">build</span>(u &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">        <span class="built_in">build</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">        <span class="built_in">pull</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (tr[u].l == tr[u].r) &#123;</span><br><span class="line">            tr[u].info.lc ^= <span class="number">1</span>;</span><br><span class="line">            tr[u].info.rc ^= <span class="number">1</span>;</span><br><span class="line">            tr[u].info.ans ^= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid = tr[u].l + tr[u].r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (x &lt;= mid) <span class="built_in">modify</span>(u &lt;&lt; <span class="number">1</span>, x);</span><br><span class="line">        <span class="keyword">if</span> (x &gt; mid) <span class="built_in">modify</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, x);</span><br><span class="line">        <span class="built_in">pull</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function">Info <span class="title">query</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (tr[u].l &gt;= l &amp;&amp; tr[u].r &lt;= r) <span class="keyword">return</span> tr[u].info;</span><br><span class="line">        <span class="type">int</span> mid = tr[u].l + tr[u].r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (r &lt;= mid) <span class="keyword">return</span> <span class="built_in">query</span>(u &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">        <span class="keyword">if</span> (l &gt; mid) <span class="keyword">return</span> <span class="built_in">query</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(u &lt;&lt; <span class="number">1</span>, l, r) + <span class="built_in">query</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;t;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m;cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    t.<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="type">int</span> op;cin&gt;&gt;op;</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="type">int</span> x;cin&gt;&gt;x;</span><br><span class="line">            t.<span class="built_in">modify</span>(<span class="number">1</span>,x);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> l,r;cin&gt;&gt;l&gt;&gt;r;</span><br><span class="line">            cout&lt;&lt;t.<span class="built_in">query</span>(<span class="number">1</span>,l,r).ans&lt;&lt;endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="LazySegmentTree-åŸºç¡€åŒºé—´ä¿®æ”¹"><a href="#LazySegmentTree-åŸºç¡€åŒºé—´ä¿®æ”¹" class="headerlink" title="LazySegmentTree åŸºç¡€åŒºé—´ä¿®æ”¹"></a>LazySegmentTree åŸºç¡€åŒºé—´ä¿®æ”¹</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">Info</span>, <span class="keyword">class</span> <span class="title class_">Tag</span>&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LSGT</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> l(p) (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> r(p) (p &lt;&lt; 1 | 1)</span></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    std::vector&lt;Info&gt; info;</span><br><span class="line">    std::vector&lt;Tag&gt; tag;</span><br><span class="line">    <span class="built_in">LSGT</span>() &#123;&#125;</span><br><span class="line">    <span class="built_in">LSGT</span>(<span class="type">int</span> _n, Info _v = <span class="built_in">Info</span>()) &#123;</span><br><span class="line">        <span class="built_in">init</span>(_n, _v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="title">LSGT</span><span class="params">(std::vector&lt;T&gt; _init)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">init</span>(_init);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _n, Info _v = Info())</span> </span>&#123;</span><br><span class="line">        <span class="built_in">init</span>(std::<span class="built_in">vector</span>(_n, _v));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="type">void</span> <span class="title">init</span><span class="params">(std::vector&lt;T&gt; _init)</span> </span>&#123;</span><br><span class="line">        n = _init.<span class="built_in">size</span>();</span><br><span class="line">        info.<span class="built_in">assign</span>(<span class="number">4</span> &lt;&lt; std::__lg(n), <span class="built_in">Info</span>());</span><br><span class="line">        tag.<span class="built_in">assign</span>(<span class="number">4</span> &lt;&lt; std::__lg(n), <span class="built_in">Tag</span>());</span><br><span class="line">        <span class="keyword">auto</span> build = [&amp;](<span class="keyword">auto</span> self, <span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r) &#123;</span><br><span class="line">            <span class="keyword">if</span> (r - l == <span class="number">1</span>) &#123;</span><br><span class="line">                info[p] = _init[l];</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> m = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">self</span>(self, <span class="built_in">l</span>(p), l, m);</span><br><span class="line">            <span class="built_in">self</span>(self, <span class="built_in">r</span>(p), m, r);</span><br><span class="line">            <span class="built_in">pull</span>(p);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">build</span>(build, <span class="number">1</span>, <span class="number">0</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pull</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">        info[p] = info[<span class="built_in">l</span>(p)] + info[<span class="built_in">r</span>(p)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">apply</span><span class="params">(<span class="type">int</span> p, <span class="type">const</span> Tag &amp;v, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        info[p].<span class="built_in">apply</span>(v, len);</span><br><span class="line">        tag[p].<span class="built_in">apply</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">apply</span>(<span class="built_in">l</span>(p), tag[p], len / <span class="number">2</span>);</span><br><span class="line">        <span class="built_in">apply</span>(<span class="built_in">r</span>(p), tag[p], len - len / <span class="number">2</span>);</span><br><span class="line">        tag[p] = <span class="built_in">Tag</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">const</span> Info &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r - l == <span class="number">1</span>) &#123;</span><br><span class="line">            info[p] = v;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> m = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">push</span>(p, r - l);</span><br><span class="line">        <span class="keyword">if</span> (x &lt; m) &#123;</span><br><span class="line">            <span class="built_in">modify</span>(<span class="built_in">l</span>(p), l, m, x, v);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">modify</span>(<span class="built_in">r</span>(p), m, r, x, v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">pull</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> p, <span class="type">const</span> Info &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">0</span>, n, p, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Info <span class="title">query</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= y <span class="keyword">or</span> r &lt;= x) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Info</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= x <span class="keyword">and</span> r &lt;= y) &#123;</span><br><span class="line">            <span class="keyword">return</span> info[p];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> m = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">push</span>(p, r - l);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(<span class="built_in">l</span>(p), l, m, x, y) + <span class="built_in">query</span>(<span class="built_in">r</span>(p), m, r, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Info <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, n, l, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Apply</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">const</span> Tag &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= y <span class="keyword">or</span> r &lt;= x) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= x <span class="keyword">and</span> r &lt;= y) &#123;</span><br><span class="line">            <span class="built_in">apply</span>(p, v, r - l);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> m = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">push</span>(p, r - l);</span><br><span class="line">        <span class="built_in">Apply</span>(<span class="built_in">l</span>(p), l, m, x, y, v);</span><br><span class="line">        <span class="built_in">Apply</span>(<span class="built_in">r</span>(p), m, r, x, y, v);</span><br><span class="line">        <span class="built_in">pull</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Apply</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">const</span> Tag &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Apply</span>(<span class="number">1</span>, <span class="number">0</span>, n, l, r, v);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> l(p)</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> r(p)</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Tag</span> &#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰è¦ä¸‹æ”¾ä»€ä¹ˆæ ‡è®°</span></span><br><span class="line">    <span class="type">int</span> mul,add;</span><br><span class="line">    <span class="comment">//Tag(...): ... &#123;&#125; // åˆå§‹åŒ–</span></span><br><span class="line">    <span class="built_in">Tag</span>(<span class="type">int</span> _mul=<span class="number">1</span>,<span class="type">int</span> _add=<span class="number">0</span>):<span class="built_in">mul</span>(_mul),<span class="built_in">add</span>(_add)&#123;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">apply</span><span class="params">(Tag t)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ€ä¹ˆç”¨çˆ¶ç»“ç‚¹çš„æ ‡è®°æ›´æ–°å„¿å­çš„æ ‡è®°</span></span><br><span class="line">        mul=mul*t.mul;</span><br><span class="line">        add=(add*t.mul+t.add);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Info</span> &#123;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">apply</span><span class="params">(Tag t, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å¦‚æœæ˜¯åªæœ‰addæ ‡è®°,æ³¨æ„sum=sum+t.add;</span></span><br><span class="line">        <span class="comment">// æ€ä¹ˆç”¨çˆ¶ç»“ç‚¹çš„æ ‡è®°æ›´æ–°å„¿å­å­˜å‚¨çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="comment">// è¿™é‡Œ jls åŸæœ¬æ²¡æœ‰åŒºé—´é•¿åº¦ len è¿™ä¸ªå½¢å‚ï¼Œä½†æˆ‘è§‰å¾—å¯èƒ½å¸¸ç”¨å°±è‡ªå·±åŠ ä¸Šäº†</span></span><br><span class="line">        sum = (sum * t.mul + <span class="number">1LL</span> * t.add * len);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Info <span class="keyword">operator</span>+(Info a, Info b) &#123;</span><br><span class="line">    Info c;</span><br><span class="line">    <span class="comment">// a å’Œ b ä¸€é€šæ“ä½œå¼„å‡º c</span></span><br><span class="line">    c.sum = (a.sum + b.sum);</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;cin&gt;&gt;n;</span><br><span class="line">    vector&lt;Info&gt;<span class="built_in">a</span>(n<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="type">int</span> x;cin&gt;&gt;a[i].sum;</span><br><span class="line">    &#125;</span><br><span class="line">    LSGT&lt;Info,Tag&gt;<span class="built_in">sgt</span>(a);</span><br><span class="line">    <span class="type">int</span> m;cin&gt;&gt;m;</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="type">int</span> t,l,r;cin&gt;&gt;t&gt;&gt;l&gt;&gt;r;</span><br><span class="line">        r+=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(t==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="type">int</span> c;cin&gt;&gt;c;</span><br><span class="line">            sgt.<span class="built_in">Apply</span>(l,r,<span class="built_in">Tag</span>(c,<span class="number">0</span>));</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="type">int</span> c;cin&gt;&gt;c;</span><br><span class="line">            sgt.<span class="built_in">Apply</span>(l, r, <span class="built_in">Tag</span>(<span class="number">1</span>, c));</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            cout&lt;&lt;sgt.<span class="built_in">query</span>(l,r).sum&lt;&lt;endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IOS;</span><br><span class="line">    <span class="type">int</span> T=<span class="number">1</span>;</span><br><span class="line">    <span class="comment">//cin&gt;&gt;T;</span></span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å•è°ƒæ ˆè§£å†³NGEé—®é¢˜"><a href="#å•è°ƒæ ˆè§£å†³NGEé—®é¢˜" class="headerlink" title="å•è°ƒæ ˆè§£å†³NGEé—®é¢˜"></a>å•è°ƒæ ˆè§£å†³NGEé—®é¢˜</h2><p>å³è¾¹ç¬¬ä¸€ä¸ªä¸¥æ ¼å¤§äºå½“å‰å…ƒç´ çš„æ•°çš„ä¸‹æ ‡</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">stack&lt;<span class="type">int</span>&gt;stk;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">    <span class="keyword">while</span>(!stk.<span class="built_in">empty</span>()&amp;&amp;a[stk.<span class="built_in">top</span>()]&lt;=a[i]) stk.<span class="built_in">pop</span>();</span><br><span class="line">    b[i]=stk.<span class="built_in">size</span>()?stk.<span class="built_in">top</span>():<span class="number">-1</span>;</span><br><span class="line">    stk.<span class="built_in">push</span>(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å•è°ƒé˜Ÿåˆ—-æ»‘åŠ¨çª—å£"><a href="#å•è°ƒé˜Ÿåˆ—-æ»‘åŠ¨çª—å£" class="headerlink" title="å•è°ƒé˜Ÿåˆ—(æ»‘åŠ¨çª—å£)"></a>å•è°ƒé˜Ÿåˆ—(æ»‘åŠ¨çª—å£)</h2><p>ä»¥æœ€å°å€¼ä¸ºä¾‹ï¼Œæœ€å¤§å€¼çš„åŒºåˆ«å°±æ˜¯ç¬¬ä¸€è¡Œwhile popæ—¶çš„æ¡ä»¶çš„åŒºåˆ«</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">deque&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">    <span class="comment">//å•è°ƒé˜Ÿåˆ—æ±‚æœ€å°å€¼</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(q.<span class="built_in">size</span>()&amp;&amp;a[q.<span class="built_in">back</span>()]&gt;=a[i]) q.<span class="built_in">pop_back</span>();</span><br><span class="line">        <span class="comment">//å°†é˜Ÿå°¾æ‰€æœ‰å¤§äºç­‰äºéå†åˆ°å½“å‰å…ƒç´ çš„æ•°popå‡ºå»</span></span><br><span class="line">        q.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="comment">//æ–°å…ƒç´ å…¥é˜Ÿ</span></span><br><span class="line">        <span class="keyword">while</span>(q.<span class="built_in">size</span>()&amp;&amp;i-k&gt;=q.<span class="built_in">front</span>()) q.<span class="built_in">pop_front</span>();</span><br><span class="line">        <span class="comment">//å°†å·²ç»åˆ’å‡ºå»çš„é˜Ÿå¤´popå‡ºå»</span></span><br><span class="line">        <span class="keyword">if</span>(i&gt;=k<span class="number">-1</span>) cout&lt;&lt;a[q.<span class="built_in">front</span>()]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">        <span class="comment">//å½“å‰å…ƒç´ å°±æ˜¯çª—å£å€¼kä¹‹å†…æœ€å°çš„å…ƒç´ </span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Trieæ ‘"><a href="#Trieæ ‘" class="headerlink" title="Trieæ ‘"></a>Trieæ ‘</h2><p>å¿«é€ŸæŸ¥è¯¢å¤šä¸ªå­—ç¬¦ä¸²ä¸­çš„å‰ç¼€å’Œï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(m),å…¶ä¸­mæ˜¯å¾…æŸ¥è¯¢&#x2F;æ’å…¥çš„å­—ç¬¦ä¸²é•¿åº¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> p=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;x.<span class="built_in">length</span>();i++)&#123;</span><br><span class="line">        <span class="type">int</span> u=x[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(!son[p][u]) son[p][u]=++idx;</span><br><span class="line">        p=son[p][u];</span><br><span class="line">        cnt[p]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(string x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> p=<span class="number">0</span>,op=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;x.<span class="built_in">length</span>();i++)&#123;</span><br><span class="line">        <span class="type">int</span> u=x[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(!son[p][u]) <span class="keyword">return</span> op;</span><br><span class="line">        p=son[p][u];</span><br><span class="line">        op+=(cnt[p]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> op;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å­—å…¸æ ‘ä¹Ÿå¯ä»¥å¿«é€ŸæŸ¥è¯¢æŸä¸ªå­—ç¬¦ä¸²æœ‰æ²¡æœ‰å‡ºç°è¿‡"><a href="#å­—å…¸æ ‘ä¹Ÿå¯ä»¥å¿«é€ŸæŸ¥è¯¢æŸä¸ªå­—ç¬¦ä¸²æœ‰æ²¡æœ‰å‡ºç°è¿‡" class="headerlink" title="å­—å…¸æ ‘ä¹Ÿå¯ä»¥å¿«é€ŸæŸ¥è¯¢æŸä¸ªå­—ç¬¦ä¸²æœ‰æ²¡æœ‰å‡ºç°è¿‡"></a>å­—å…¸æ ‘ä¹Ÿå¯ä»¥å¿«é€ŸæŸ¥è¯¢æŸä¸ªå­—ç¬¦ä¸²æœ‰æ²¡æœ‰å‡ºç°è¿‡</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> p=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;x.<span class="built_in">length</span>();i++)&#123;</span><br><span class="line">        <span class="type">int</span> u=x[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(!son[p][u]) son[p][u]=++idx;</span><br><span class="line">        p=son[p][u];</span><br><span class="line">    &#125;</span><br><span class="line">    cnt[p]+=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(string x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> p=<span class="number">0</span>,op=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;x.<span class="built_in">length</span>();i++)&#123;</span><br><span class="line">        <span class="type">int</span> u=x[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(!son[p][u]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        p=son[p][u];</span><br><span class="line">    &#125;</span><br><span class="line">    op+=cnt[p];</span><br><span class="line">    <span class="keyword">return</span> op;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ ‘çŠ¶æ•°ç»„"><a href="#æ ‘çŠ¶æ•°ç»„" class="headerlink" title="æ ‘çŠ¶æ•°ç»„"></a>æ ‘çŠ¶æ•°ç»„</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Fenwick</span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;T&gt; tr;</span><br><span class="line">    <span class="built_in">Fenwick</span>(<span class="type">int</span> n) : <span class="built_in">n</span>(n), <span class="built_in">tr</span>(n + <span class="number">1</span>, <span class="number">0</span>)&#123;&#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> x, T c)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = x; i &lt;= n; i += <span class="built_in">lowbit</span>(i)) tr[i] += c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, T c)</span></span>&#123;</span><br><span class="line">        <span class="built_in">modify</span>(l, c);</span><br><span class="line">        <span class="keyword">if</span> (r + <span class="number">1</span> &lt;= n) <span class="built_in">modify</span>(r + <span class="number">1</span>, -c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">query</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">        T res = <span class="built_in">T</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = x; i; i -= <span class="built_in">lowbit</span>(i)) res += tr[i];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(r) - <span class="built_in">query</span>(l - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find_first</span><span class="params">(T sum)</span></span>&#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>; T val = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = __lg(n); i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">if</span> ((ans | (<span class="number">1</span> &lt;&lt; i)) &lt;= n &amp;&amp; val + tr[ans | (<span class="number">1</span> &lt;&lt; i)] &lt; sum)&#123;</span><br><span class="line">                ans |= <span class="number">1</span> &lt;&lt; i;</span><br><span class="line">                val += tr[ans];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find_last</span><span class="params">(T sum)</span></span>&#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>; T val = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = __lg(n); i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">if</span> ((ans | (<span class="number">1</span> &lt;&lt; i)) &lt;= n &amp;&amp; val + tr[ans | (<span class="number">1</span> &lt;&lt; i)] &lt;= sum)&#123;</span><br><span class="line">                ans |= <span class="number">1</span> &lt;&lt; i;</span><br><span class="line">                val += tr[ans];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">using</span> BIT = Fenwick&lt;<span class="type">int</span>&gt;;</span><br></pre></td></tr></table></figure>

<h3 id="å£°æ˜æ–¹å¼-2"><a href="#å£°æ˜æ–¹å¼-2" class="headerlink" title="å£°æ˜æ–¹å¼"></a>å£°æ˜æ–¹å¼</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">BIT <span class="title">tr</span><span class="params">(n)</span></span>;<span class="comment">//næ˜¯å¤§å°</span></span><br><span class="line"><span class="comment">//æ³¨æ„è¾“å…¥çš„æ—¶å€™è¦ä»1-nè¾“å…¥,vactorå¼€n+1;</span></span><br><span class="line">tr.<span class="built_in">modify</span>(n,k)<span class="comment">//ç¬¬nä¸ªæ•°åŠ ä¸Šk</span></span><br><span class="line">tr.<span class="built_in">modify</span>(<span class="number">1</span>,n,k)<span class="comment">//ä»1åˆ°næ¯ä¸ªæ•°åŠ k</span></span><br><span class="line">tr.<span class="built_in">query</span>(x)<span class="comment">//æŸ¥è¯¢ç¬¬xä¸ªæ•°    </span></span><br><span class="line"><span class="comment">//ä¸‰æ˜Ÿæé†’ï¼šåˆå§‹åŒ–çš„æ—¶å€™æ˜¯tr.modify(pos,pos,c),è¿™æ ·æ‰ä»£è¡¨åªç»™posä½ç½®èµ‹å€¼c</span></span><br></pre></td></tr></table></figure>

<h2 id="æ ‘çŠ¶æ•°ç»„æ±‚é€†åºå¯¹"><a href="#æ ‘çŠ¶æ•°ç»„æ±‚é€†åºå¯¹" class="headerlink" title="æ ‘çŠ¶æ•°ç»„æ±‚é€†åºå¯¹"></a>æ ‘çŠ¶æ•°ç»„æ±‚é€†åºå¯¹</h2><h3 id="æ•°å€¼å¤§çš„æƒ…å†µä¸‹è¦è¿›è¡Œç¦»æ•£åŒ–-ç¦»æ•£åŒ–ä¸‹æ ‡ä»1å¼€å§‹"><a href="#æ•°å€¼å¤§çš„æƒ…å†µä¸‹è¦è¿›è¡Œç¦»æ•£åŒ–-ç¦»æ•£åŒ–ä¸‹æ ‡ä»1å¼€å§‹" class="headerlink" title="æ•°å€¼å¤§çš„æƒ…å†µä¸‹è¦è¿›è¡Œç¦»æ•£åŒ–,ç¦»æ•£åŒ–ä¸‹æ ‡ä»1å¼€å§‹"></a>æ•°å€¼å¤§çš„æƒ…å†µä¸‹è¦è¿›è¡Œç¦»æ•£åŒ–,ç¦»æ•£åŒ–ä¸‹æ ‡ä»1å¼€å§‹</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;cin&gt;&gt;n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;<span class="built_in">a</span>(n);</span><br><span class="line">    <span class="function">BIT <span class="title">tr</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        tr.<span class="built_in">modify</span>(a[i],<span class="number">1</span>);</span><br><span class="line">        ans+=(i-tr.<span class="built_in">query</span>(a[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ ‘çŠ¶æ•°ç»„jiangly"><a href="#æ ‘çŠ¶æ•°ç»„jiangly" class="headerlink" title="æ ‘çŠ¶æ•°ç»„jiangly"></a>æ ‘çŠ¶æ•°ç»„jiangly</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Fenwick</span> &#123;</span><br><span class="line">    <span class="type">int</span> n; vector&lt;T&gt;a;</span><br><span class="line">    <span class="built_in">Fenwick</span>(<span class="type">int</span> n_ = <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">init</span>(n_);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n_)</span> </span>&#123;</span><br><span class="line">        n = n_;</span><br><span class="line">        a.<span class="built_in">assign</span>(n, T&#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">const</span> T &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = x + <span class="number">1</span>; i &lt;= n; i += i &amp; -i) &#123;</span><br><span class="line">            a[i - <span class="number">1</span>] = a[i - <span class="number">1</span>] + v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        T ans&#123;&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = x; i &gt; <span class="number">0</span>; i -= i &amp; -i) &#123;</span><br><span class="line">            ans = ans + a[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">rangeSum</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(r) - <span class="built_in">sum</span>(l);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">select</span><span class="params">(<span class="type">const</span> T &amp;k)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">        T cur&#123;&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span> &lt;&lt; std::__lg(n); i; i /= <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (x + i &lt;= n &amp;&amp; cur + a[x + i - <span class="number">1</span>] &lt;= k) &#123;</span><br><span class="line">                x += i;</span><br><span class="line">                cur = cur + a[x - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="STè¡¨"><a href="#STè¡¨" class="headerlink" title="STè¡¨"></a>STè¡¨</h2><h3 id="è§£å†³RMQé—®é¢˜ï¼Œé¢„å¤„ç†å¤æ‚åº¦ä¸ºO-nlogn-O-1-æŸ¥è¯¢-å¸¸æ•°æ¯”çº¿æ®µæ ‘å°"><a href="#è§£å†³RMQé—®é¢˜ï¼Œé¢„å¤„ç†å¤æ‚åº¦ä¸ºO-nlogn-O-1-æŸ¥è¯¢-å¸¸æ•°æ¯”çº¿æ®µæ ‘å°" class="headerlink" title="è§£å†³RMQé—®é¢˜ï¼Œé¢„å¤„ç†å¤æ‚åº¦ä¸ºO(nlogn),O(1)æŸ¥è¯¢,å¸¸æ•°æ¯”çº¿æ®µæ ‘å°"></a>è§£å†³RMQé—®é¢˜ï¼Œé¢„å¤„ç†å¤æ‚åº¦ä¸ºO(nlogn),O(1)æŸ¥è¯¢,å¸¸æ•°æ¯”çº¿æ®µæ ‘å°</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ST</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;lg;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; mx, mn;</span><br><span class="line">    <span class="built_in">ST</span>(vector&lt;<span class="type">int</span>&gt;init)&#123;</span><br><span class="line">        n=init.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        lg.<span class="built_in">resize</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            lg[i] = lg[i / <span class="number">2</span>] + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        mx.<span class="built_in">resize</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(lg[n] + <span class="number">1</span>));</span><br><span class="line">        mn.<span class="built_in">resize</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(lg[n] + <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            mx[i][<span class="number">0</span>] = init[i];</span><br><span class="line">            mn[i][<span class="number">0</span>] = init[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> k = lg[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= k; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; i++) &#123;</span><br><span class="line">                mx[i][j] = <span class="built_in">max</span>(mx[i][j - <span class="number">1</span>], mx[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">                mn[i][j] = <span class="built_in">min</span>(mn[i][j - <span class="number">1</span>], mn[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getmax</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt; r) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(l, r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> k = lg[r - l + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(mx[l][k], mx[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getmin</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt; r) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(l, r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> k = lg[r - l + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(mn[l][k], mn[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="è§£å†³åŒºé—´gcdé—®é¢˜"><a href="#è§£å†³åŒºé—´gcdé—®é¢˜" class="headerlink" title="è§£å†³åŒºé—´gcdé—®é¢˜"></a>è§£å†³åŒºé—´gcdé—®é¢˜</h3><p>é¢„å¤„ç†å¤æ‚åº¦ä¸º$O(n(logn+logv))$,æŸ¥è¯¢å¤æ‚åº¦$O(logv)$,å…¶ä¸­vä¸ºå€¼åŸŸ</p>
<p>è¯¥é—®é¢˜â€åŒºé—´gcdâ€ä¸­ï¼Œçº¿æ®µæ ‘æŸ¥è¯¢çš„å¤æ‚åº¦ä¸º$O(logn+logv)$</p>
<p>STè¡¨å¯ä»¥ç”¨æ¥è§£å†³å¯é‡å¤è´¡çŒ®é—®é¢˜ï¼Œä¾‹å¦‚ã€ŒåŒºé—´æŒ‰ä½ä¸ã€ã€ã€ŒåŒºé—´æŒ‰ä½æˆ–ã€ã€ã€ŒåŒºé—´ GCDã€ï¼ŒST è¡¨éƒ½èƒ½é«˜æ•ˆåœ°è§£å†³ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ST</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;lg;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; g;</span><br><span class="line">    <span class="built_in">ST</span>(vector&lt;<span class="type">int</span>&gt;init)&#123;</span><br><span class="line">        n=init.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        lg.<span class="built_in">resize</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            lg[i] = lg[i / <span class="number">2</span>] + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        g.<span class="built_in">resize</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(lg[n] + <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            g[i][<span class="number">0</span>] = init[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> k = lg[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= k; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; i++) &#123;</span><br><span class="line">                g[i][j] = <span class="built_in">gcd</span>(g[i][j - <span class="number">1</span>], g[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> k=lg[r - l + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">gcd</span>(g[l][k], g[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="è‡ªåŠ¨å–æ¨¡ä¸æ’åˆ—ç»„åˆ"><a href="#è‡ªåŠ¨å–æ¨¡ä¸æ’åˆ—ç»„åˆ" class="headerlink" title="è‡ªåŠ¨å–æ¨¡ä¸æ’åˆ—ç»„åˆ"></a>è‡ªåŠ¨å–æ¨¡ä¸æ’åˆ—ç»„åˆ</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">3e5</span> + <span class="number">5</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="type">const</span> <span class="type">int</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ModInt</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">static</span> <span class="type">int</span> mod = T;</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="built_in">ModInt</span>(<span class="type">int</span> x = <span class="number">0</span>) : <span class="built_in">x</span>(x % mod) &#123;&#125;</span><br><span class="line">    <span class="built_in">ModInt</span>(<span class="type">long</span> <span class="type">long</span> x) : <span class="built_in">x</span>(<span class="built_in">int</span>(x % mod)) &#123;&#125; </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">val</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> x; &#125;</span><br><span class="line">    ModInt <span class="keyword">operator</span> + (<span class="type">const</span> ModInt &amp;a) <span class="type">const</span> &#123; <span class="type">int</span> x0 = x + a.x; <span class="keyword">return</span> <span class="built_in">ModInt</span>(x0 &lt; mod ? x0 : x0 - mod); &#125;</span><br><span class="line">    ModInt <span class="keyword">operator</span> - (<span class="type">const</span> ModInt &amp;a) <span class="type">const</span> &#123; <span class="type">int</span> x0 = x - a.x; <span class="keyword">return</span> <span class="built_in">ModInt</span>(x0 &lt; <span class="number">0</span> ? x0 + mod : x0); &#125;</span><br><span class="line">    ModInt <span class="keyword">operator</span> * (<span class="type">const</span> ModInt &amp;a) <span class="type">const</span> &#123; <span class="keyword">return</span> <span class="built_in">ModInt</span>(<span class="number">1LL</span> * x * a.x % mod); &#125;</span><br><span class="line">    ModInt <span class="keyword">operator</span> / (<span class="type">const</span> ModInt &amp;a) <span class="type">const</span> &#123; <span class="keyword">return</span> *<span class="keyword">this</span> * a.<span class="built_in">inv</span>(); &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> == (<span class="type">const</span> ModInt &amp;a) <span class="type">const</span> &#123; <span class="keyword">return</span> x == a.x; &#125;;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> != (<span class="type">const</span> ModInt &amp;a) <span class="type">const</span> &#123; <span class="keyword">return</span> x != a.x; &#125;;</span><br><span class="line">    <span class="type">void</span> <span class="keyword">operator</span> += (<span class="type">const</span> ModInt &amp;a) &#123; x += a.x; <span class="keyword">if</span> (x &gt;= mod) x -= mod; &#125;</span><br><span class="line">    <span class="type">void</span> <span class="keyword">operator</span> -= (<span class="type">const</span> ModInt &amp;a) &#123; x -= a.x; <span class="keyword">if</span> (x &lt; <span class="number">0</span>) x += mod; &#125;</span><br><span class="line">    <span class="type">void</span> <span class="keyword">operator</span> *= (<span class="type">const</span> ModInt &amp;a) &#123; x = <span class="number">1LL</span> * x * a.x % mod; &#125;</span><br><span class="line">    <span class="type">void</span> <span class="keyword">operator</span> /= (<span class="type">const</span> ModInt &amp;a) &#123; *<span class="keyword">this</span> = *<span class="keyword">this</span> / a; &#125;</span><br><span class="line">    <span class="keyword">friend</span> ModInt <span class="keyword">operator</span> + (<span class="type">int</span> y, <span class="type">const</span> ModInt &amp;a)&#123; <span class="type">int</span> x0 = y + a.x; <span class="keyword">return</span> <span class="built_in">ModInt</span>(x0 &lt; mod ? x0 : x0 - mod); &#125;</span><br><span class="line">    <span class="keyword">friend</span> ModInt <span class="keyword">operator</span> - (<span class="type">int</span> y, <span class="type">const</span> ModInt &amp;a)&#123; <span class="type">int</span> x0 = y - a.x; <span class="keyword">return</span> <span class="built_in">ModInt</span>(x0 &lt; <span class="number">0</span> ? x0 + mod : x0); &#125;</span><br><span class="line">    <span class="keyword">friend</span> ModInt <span class="keyword">operator</span> * (<span class="type">int</span> y, <span class="type">const</span> ModInt &amp;a)&#123; <span class="keyword">return</span> <span class="built_in">ModInt</span>(<span class="number">1LL</span> * y * a.x % mod);&#125;</span><br><span class="line">    <span class="keyword">friend</span> ModInt <span class="keyword">operator</span> / (<span class="type">int</span> y, <span class="type">const</span> ModInt &amp;a)&#123; <span class="keyword">return</span> <span class="built_in">ModInt</span>(y) / a;&#125;</span><br><span class="line">    <span class="keyword">friend</span> ostream &amp;<span class="keyword">operator</span>&lt;&lt;(ostream &amp;os, <span class="type">const</span> ModInt &amp;a) &#123; <span class="keyword">return</span> os &lt;&lt; a.x;&#125;</span><br><span class="line">    <span class="keyword">friend</span> istream &amp;<span class="keyword">operator</span>&gt;&gt;(istream &amp;is, ModInt &amp;t)&#123;<span class="keyword">return</span> is &gt;&gt; t.x;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ModInt <span class="title">pow</span><span class="params">(<span class="type">int64_t</span> n)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="function">ModInt <span class="title">res</span><span class="params">(<span class="number">1</span>)</span>, <span class="title">mul</span><span class="params">(x)</span></span>;</span><br><span class="line">        <span class="keyword">while</span>(n)&#123;</span><br><span class="line">            <span class="keyword">if</span> (n &amp; <span class="number">1</span>) res *= mul;</span><br><span class="line">            mul *= mul;</span><br><span class="line">            n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">ModInt <span class="title">inv</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> a = x, b = mod, u = <span class="number">1</span>, v = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (b) &#123;</span><br><span class="line">            <span class="type">int</span> t = a / b;</span><br><span class="line">            a -= t * b; <span class="built_in">swap</span>(a, b);</span><br><span class="line">            u -= t * v; <span class="built_in">swap</span>(u, v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (u &lt; <span class="number">0</span>) u += mod;</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">using</span> mint = ModInt&lt;mod&gt;;</span><br><span class="line"></span><br><span class="line">mint fact[maxn], invfact[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fact[<span class="number">0</span>] = invfact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; maxn; i++) fact[i] = fact[i - <span class="number">1</span>] * i;</span><br><span class="line">    invfact[maxn - <span class="number">1</span>] = fact[maxn - <span class="number">1</span>].<span class="built_in">inv</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = maxn - <span class="number">2</span>; i; i--)</span><br><span class="line">        invfact[i] = invfact[i + <span class="number">1</span>] * (i + <span class="number">1</span>);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> mint <span class="title">C</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; <span class="number">0</span> || b &lt; <span class="number">0</span> || a &lt; b) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> fact[a] * invfact[b] * invfact[a - b];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è«é˜Ÿ"><a href="#è«é˜Ÿ" class="headerlink" title="è«é˜Ÿ"></a>è«é˜Ÿ</h2><h3 id="åŸºç¡€è«é˜Ÿ"><a href="#åŸºç¡€è«é˜Ÿ" class="headerlink" title="åŸºç¡€è«é˜Ÿ"></a>åŸºç¡€è«é˜Ÿ</h3><p>å±äºç¦»çº¿ç®—æ³•ï¼Œè§£å†³æ•°æ®èŒƒå›´åœ¨[1,1e5]èŒƒå›´å†…çš„é¢˜;</p>
<p>å¦‚æœnï¼ŒmåŒé˜¶(n&#x3D;&#x3D;m),æ—¶é—´å¤æ‚åº¦ä¸º$n\sqrt{n}$,æ’åºæŒ‰ç…§å·¦ç«¯ç‚¹å—é¡ºåºä¸å³ç«¯ç‚¹æ¥æ’åº</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;array&lt;<span class="type">int</span>,3&gt;&gt;<span class="built_in">query</span>(q<span class="number">+1</span>);</span><br><span class="line">    <span class="type">int</span> siz=(<span class="type">int</span>)(<span class="built_in">ceil</span>(<span class="built_in">pow</span>(n,<span class="number">0.5</span>)));</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;<span class="built_in">k</span>(n<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        k[i]=(i<span class="number">-1</span>)/siz<span class="number">+1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</span><br><span class="line">        <span class="type">int</span> l,r;cin&gt;&gt;l&gt;&gt;r;</span><br><span class="line">        query[i]=&#123;l,r,i&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(query.<span class="built_in">begin</span>()<span class="number">+1</span>,query.<span class="built_in">end</span>(),[&amp;](<span class="keyword">auto</span> x,<span class="keyword">auto</span> y)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k[x[<span class="number">0</span>]]!=k[y[<span class="number">0</span>]]) <span class="keyword">return</span> k[x[<span class="number">0</span>]]&lt;k[y[<span class="number">0</span>]];</span><br><span class="line">        <span class="keyword">if</span>(k[x[<span class="number">0</span>]]&amp;<span class="number">1</span>) <span class="keyword">return</span> x[<span class="number">1</span>]&lt;y[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> x[<span class="number">1</span>]&gt;y[<span class="number">1</span>];</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>,val=<span class="number">0</span>;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;<span class="built_in">ans</span>(q<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">auto</span> add=[&amp;](<span class="type">int</span> x)&#123;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">auto</span> del=[&amp;](<span class="type">int</span> x)&#123;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</span><br><span class="line">        <span class="keyword">auto</span> [ql,qr,id]:query[i];</span><br><span class="line">        <span class="keyword">while</span>(l&gt;ql) <span class="built_in">add</span>(a[--l]);</span><br><span class="line">        <span class="keyword">while</span>(r&lt;qr) <span class="built_in">add</span>(a[++r]);</span><br><span class="line">        <span class="keyword">while</span>(l&lt;ql) <span class="built_in">del</span>(a[l++]);</span><br><span class="line">        <span class="keyword">while</span>(r&gt;qr) <span class="built_in">del</span>(a[r--]);</span><br><span class="line">        ans[id]=val;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ ‘é“¾å‰–åˆ†"><a href="#æ ‘é“¾å‰–åˆ†" class="headerlink" title="æ ‘é“¾å‰–åˆ†"></a>æ ‘é“¾å‰–åˆ†</h2><h3 id="HLD"><a href="#HLD" class="headerlink" title="HLD"></a>HLD</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">HLD</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; siz, top, dep, parent, in, out, seq;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; adj;</span><br><span class="line">    <span class="type">int</span> cur;</span><br><span class="line">    <span class="built_in">HLD</span>() &#123;&#125;</span><br><span class="line">    <span class="built_in">HLD</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        siz.<span class="built_in">resize</span>(n);</span><br><span class="line">        top.<span class="built_in">resize</span>(n);</span><br><span class="line">        dep.<span class="built_in">resize</span>(n);</span><br><span class="line">        parent.<span class="built_in">resize</span>(n);</span><br><span class="line">        in.<span class="built_in">resize</span>(n);</span><br><span class="line">        out.<span class="built_in">resize</span>(n);</span><br><span class="line">        seq.<span class="built_in">resize</span>(n);</span><br><span class="line">        cur = <span class="number">0</span>;</span><br><span class="line">        adj.<span class="built_in">assign</span>(n, &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        adj[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">work</span><span class="params">(<span class="type">int</span> root )</span> </span>&#123;</span><br><span class="line">        top[root] = root;</span><br><span class="line">        dep[root] = <span class="number">0</span>;</span><br><span class="line">        parent[root] = <span class="number">-1</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(root);</span><br><span class="line">        <span class="built_in">dfs2</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">           æ ‡è®°æ¯ä¸ªç‚¹çš„æ·±åº¦dep[]</span></span><br><span class="line"><span class="comment">           æ ‡è®°æ¯ä¸ªç‚¹çš„çˆ¶äº²parent[]</span></span><br><span class="line"><span class="comment">           æ ‡è®°æ¯ä¸ªéå¶å­èŠ‚ç‚¹çš„å­æ ‘å¤§å°(å«å®ƒè‡ªå·±)</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span> (parent[u] != <span class="number">-1</span>) &#123;</span><br><span class="line">            adj[u].<span class="built_in">erase</span>(<span class="built_in">find</span>(adj[u].<span class="built_in">begin</span>(), adj[u].<span class="built_in">end</span>(), parent[u]));</span><br><span class="line">        &#125;</span><br><span class="line">        siz[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;v : adj[u]) &#123;</span><br><span class="line">            parent[v] = u;</span><br><span class="line">            dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">dfs1</span>(v);</span><br><span class="line">            siz[u] += siz[v];</span><br><span class="line">            <span class="keyword">if</span> (siz[v] &gt; siz[adj[u][<span class="number">0</span>]]) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(v, adj[u][<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        in[u] = cur++;</span><br><span class="line">        seq[in[u]] = u;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> v : adj[u]) &#123;</span><br><span class="line">            top[v] = v == adj[u][<span class="number">0</span>] ? top[u] : v;</span><br><span class="line">            <span class="built_in">dfs2</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">        out[u] = cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (top[u] != top[v]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dep[top[u]] &gt; dep[top[v]]) &#123;</span><br><span class="line">                u = parent[top[u]];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                v = parent[top[v]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dep[u] &lt; dep[v] ? u : v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">dist</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è¿”å›ä¸¤ç‚¹çš„è·ç¦»</span></span><br><span class="line">        <span class="keyword">return</span> dep[u] + dep[v] - <span class="number">2</span> * dep[<span class="built_in">lca</span>(u, v)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">jump</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å‘ä¸Šè·³kæ­¥ï¼Œè¿”å›è·³è·ƒåçš„èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (dep[u] &lt; k) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> d = dep[u] - k;</span><br><span class="line">        <span class="keyword">while</span> (dep[top[u]] &gt; d) &#123;</span><br><span class="line">            u = parent[top[u]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> seq[in[u] - dep[u] + d];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isAncester</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­uæ˜¯å¦æ˜¯vçš„ç¥–å…ˆ</span></span><br><span class="line">        <span class="keyword">return</span> in[u] &lt;= in[v] &amp;&amp; in[v] &lt; out[u];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">rootedParent</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            åœ¨ä»¥uä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œæ‰¾åˆ°vçš„ç›´æ¥çˆ¶èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="built_in">swap</span>(u, v);</span><br><span class="line">        <span class="keyword">if</span> (u == v) &#123;</span><br><span class="line">            <span class="keyword">return</span> u;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">isAncester</span>(u, v)) &#123;</span><br><span class="line">            <span class="keyword">return</span> parent[u];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> it = <span class="built_in">upper_bound</span>(adj[u].<span class="built_in">begin</span>(), adj[u].<span class="built_in">end</span>(), v, [&amp;](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">            <span class="keyword">return</span> in[x] &lt; in[y];</span><br><span class="line">        &#125;) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> *it;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">rootedSize</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * åœ¨ä»¥uä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œè®¡ç®—ä»¥vä¸ºæ ¹çš„å­æ ‘çš„å¤§å°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (u == v) &#123;</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">isAncester</span>(v, u)) &#123;</span><br><span class="line">            <span class="keyword">return</span> siz[v];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n - siz[<span class="built_in">rootedParent</span>(u, v)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">rootedLca</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">lca</span>(a, b) ^ <span class="built_in">lca</span>(b, c) ^ <span class="built_in">lca</span>(c, a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="ç‚¹æƒä¸çº¿æ®µæ ‘æ“ä½œ"><a href="#ç‚¹æƒä¸çº¿æ®µæ ‘æ“ä½œ" class="headerlink" title="ç‚¹æƒä¸çº¿æ®µæ ‘æ“ä½œ"></a>ç‚¹æƒä¸çº¿æ®µæ ‘æ“ä½œ</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">HLD</span> &#123;</span><br><span class="line">    <span class="type">int</span> n,cur;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; siz, top, dep, parent, in, out, seq;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; adj;</span><br><span class="line">    <span class="built_in">HLD</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        siz.<span class="built_in">resize</span>(n);</span><br><span class="line">        top.<span class="built_in">resize</span>(n);</span><br><span class="line">        dep.<span class="built_in">resize</span>(n);</span><br><span class="line">        parent.<span class="built_in">resize</span>(n);</span><br><span class="line">        in.<span class="built_in">resize</span>(n);</span><br><span class="line">        out.<span class="built_in">resize</span>(n);</span><br><span class="line">        seq.<span class="built_in">resize</span>(n);</span><br><span class="line">        cur = <span class="number">1</span>;</span><br><span class="line">        adj.<span class="built_in">assign</span>(n, &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        adj[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">work</span><span class="params">(<span class="type">int</span> root )</span> </span>&#123;</span><br><span class="line">        top[root] = root;</span><br><span class="line">        dep[root] = <span class="number">0</span>;</span><br><span class="line">        parent[root] = <span class="number">-1</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(root);</span><br><span class="line">        <span class="built_in">dfs2</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (parent[u] != <span class="number">-1</span>) &#123;</span><br><span class="line">            adj[u].<span class="built_in">erase</span>(<span class="built_in">find</span>(adj[u].<span class="built_in">begin</span>(), adj[u].<span class="built_in">end</span>(), parent[u]));</span><br><span class="line">        &#125;</span><br><span class="line">        siz[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;v : adj[u]) &#123;</span><br><span class="line">            parent[v] = u;</span><br><span class="line">            dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">dfs1</span>(v);</span><br><span class="line">            siz[u] += siz[v];</span><br><span class="line">            <span class="keyword">if</span> (siz[v] &gt; siz[adj[u][<span class="number">0</span>]]) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(v, adj[u][<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        in[u] = cur++;</span><br><span class="line">        seq[in[u]] = u;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> v : adj[u]) &#123;</span><br><span class="line">            top[v] = v == adj[u][<span class="number">0</span>] ? top[u] : v;</span><br><span class="line">            <span class="built_in">dfs2</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">        out[u] = cur;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">Info</span>, <span class="keyword">class</span> <span class="title class_">Tag</span>&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LSGT</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> l(p) (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> r(p) (p &lt;&lt; 1 | 1)</span></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;Info&gt; info;</span><br><span class="line">    vector&lt;Tag&gt; tag;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="title">LSGT</span><span class="params">(vector&lt;T&gt; init1)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">init</span>(init1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="type">void</span> <span class="title">init</span><span class="params">(vector&lt;T&gt; init1)</span> </span>&#123;</span><br><span class="line">        n = init<span class="number">1.</span><span class="built_in">size</span>();</span><br><span class="line">        info.<span class="built_in">assign</span>(<span class="number">4</span> &lt;&lt; __lg(n), <span class="built_in">Info</span>());</span><br><span class="line">        tag.<span class="built_in">assign</span>(<span class="number">4</span> &lt;&lt; __lg(n), <span class="built_in">Tag</span>());</span><br><span class="line">        <span class="keyword">auto</span> build = [&amp;](<span class="keyword">auto</span> self, <span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r) &#123;</span><br><span class="line">            <span class="keyword">if</span> (r - l == <span class="number">1</span>) &#123;</span><br><span class="line">                info[p] = init1[l];</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> m = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">self</span>(self, <span class="built_in">l</span>(p), l, m);</span><br><span class="line">            <span class="built_in">self</span>(self, <span class="built_in">r</span>(p), m, r);</span><br><span class="line">            <span class="built_in">pull</span>(p);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">build</span>(build, <span class="number">1</span>, <span class="number">0</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pull</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">        info[p] = info[<span class="built_in">l</span>(p)] + info[<span class="built_in">r</span>(p)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">apply</span><span class="params">(<span class="type">int</span> p, <span class="type">const</span> Tag&amp; v, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        info[p].<span class="built_in">apply</span>(v, len);</span><br><span class="line">        tag[p].<span class="built_in">apply</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">apply</span>(<span class="built_in">l</span>(p), tag[p], len / <span class="number">2</span>);</span><br><span class="line">        <span class="built_in">apply</span>(<span class="built_in">r</span>(p), tag[p], len - len / <span class="number">2</span>);</span><br><span class="line">        tag[p] = <span class="built_in">Tag</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Info <span class="title">query</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= y <span class="keyword">or</span> r &lt;= x) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Info</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= x <span class="keyword">and</span> r &lt;= y) &#123;</span><br><span class="line">            <span class="keyword">return</span> info[p];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> m = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">push</span>(p, r - l);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(<span class="built_in">l</span>(p), l, m, x, y) + <span class="built_in">query</span>(<span class="built_in">r</span>(p), m, r, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Info <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, n, l, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Apply</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">const</span> Tag &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= y <span class="keyword">or</span> r &lt;= x) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= x <span class="keyword">and</span> r &lt;= y) &#123;</span><br><span class="line">            <span class="built_in">apply</span>(p, v, r - l);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> m = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">push</span>(p, r - l);</span><br><span class="line">        <span class="built_in">Apply</span>(<span class="built_in">l</span>(p), l, m, x, y, v);</span><br><span class="line">        <span class="built_in">Apply</span>(<span class="built_in">r</span>(p), m, r, x, y, v);</span><br><span class="line">        <span class="built_in">pull</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Apply</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">const</span> Tag &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Apply</span>(<span class="number">1</span>, <span class="number">0</span>, n, l, r, v);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> l(p)</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> r(p)</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Tag</span> &#123;</span><br><span class="line">    <span class="type">int</span> add;</span><br><span class="line">    <span class="built_in">Tag</span>(<span class="type">int</span> add1=<span class="number">0</span>):<span class="built_in">add</span>(add1)&#123;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">apply</span><span class="params">(Tag t)</span> </span>&#123;</span><br><span class="line">        add+=(t.add);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Info</span> &#123;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">apply</span><span class="params">(Tag t, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        sum += <span class="number">1LL</span> * t.add * len;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Info <span class="keyword">operator</span>+(Info a, Info b) &#123;</span><br><span class="line">    Info c;</span><br><span class="line">    c.sum = (a.sum + b.sum);</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m,r,p;cin&gt;&gt;n&gt;&gt;m&gt;&gt;r&gt;&gt;p;</span><br><span class="line">    <span class="comment">//rä¸ºæ ¹,pä¸ºå–æ¨¡æ•°</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;<span class="built_in">a</span>(n<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;<span class="built_in">g</span>(n<span class="number">+1</span>);</span><br><span class="line">    <span class="function">HLD <span class="title">t</span><span class="params">(n<span class="number">+1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">        <span class="type">int</span> x,y;cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">        t.<span class="built_in">addEdge</span>(x,y);</span><br><span class="line">    &#125;</span><br><span class="line">    t.<span class="built_in">work</span>(r);</span><br><span class="line">    vector&lt;Info&gt;<span class="built_in">k</span>(n<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        k[t.in[i]].sum=a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    LSGT&lt;Info,Tag&gt;<span class="built_in">sgt</span>(k);</span><br><span class="line">    <span class="keyword">auto</span> range=[&amp;](<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)&#123;</span><br><span class="line">        <span class="keyword">while</span>(t.top[x]!=t.top[y])&#123;</span><br><span class="line">            <span class="keyword">if</span>(t.dep[t.top[x]]&lt;t.dep[t.top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">            sgt.<span class="built_in">Apply</span>(t.in[t.top[x]],t.in[x]<span class="number">+1</span>,z);</span><br><span class="line">            x=t.parent[t.top[x]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(t.dep[x]&gt;t.dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">        sgt.<span class="built_in">Apply</span>(t.in[x],t.in[y]<span class="number">+1</span>,z);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">auto</span> query=[&amp;](<span class="type">int</span> x,<span class="type">int</span> y)&#123;</span><br><span class="line">        <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(t.top[x]!=t.top[y])&#123;</span><br><span class="line">            <span class="keyword">if</span>(t.dep[t.top[x]]&lt;t.dep[t.top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">            ans=(ans+sgt.<span class="built_in">query</span>(t.in[t.top[x]],t.in[x]<span class="number">+1</span>).sum)%p;</span><br><span class="line">            x=t.parent[t.top[x]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(t.dep[x]&gt;t.dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">        ans=(ans+sgt.<span class="built_in">query</span>(t.in[x],t.in[y]<span class="number">+1</span>).sum)%p;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="type">int</span> op;cin&gt;&gt;op;</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="type">int</span> x,y,z;cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;</span><br><span class="line">            <span class="built_in">range</span>(x,y,z);<span class="comment">//åŒºé—´åŠ </span></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="type">int</span> x,y;cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">            cout&lt;&lt;<span class="built_in">query</span>(x,y)&lt;&lt;<span class="string">&quot;\n&quot;</span>;<span class="comment">//åŒºé—´å’Œ</span></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">3</span>)&#123;</span><br><span class="line">            <span class="type">int</span> x,z;cin&gt;&gt;x&gt;&gt;z;</span><br><span class="line">            sgt.<span class="built_in">Apply</span>(t.in[x],t.in[x]+t.siz[x],z);<span class="comment">//å­æ ‘åŠ </span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> x;cin&gt;&gt;x;</span><br><span class="line">            cout&lt;&lt;(sgt.<span class="built_in">query</span>(t.in[x],t.in[x]+t.siz[x]).sum)%p&lt;&lt;<span class="string">&quot;\n&quot;</span>;<span class="comment">//å­æ ‘å’Œ</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸»å¸­æ ‘"><a href="#ä¸»å¸­æ ‘" class="headerlink" title="ä¸»å¸­æ ‘"></a>ä¸»å¸­æ ‘</h2><p>Persistent Segment Treeï¼ˆå¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘ï¼‰</p>
<h3 id="åŒºé—´é™æ€ç¬¬kå°"><a href="#åŒºé—´é™æ€ç¬¬kå°" class="headerlink" title="åŒºé—´é™æ€ç¬¬kå°"></a>åŒºé—´é™æ€ç¬¬kå°</h3><p>åŒ…æ‹¬ç¦»æ•£åŒ–,pos-1æ˜¯å› ä¸ºbæ•°ç»„ä¸‹æ ‡ä»0å¼€å§‹</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="type">int</span> l,r,rt,sum;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;Node&gt;<span class="built_in">tr</span>(N&lt;&lt;<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> p=++cnt;</span><br><span class="line">    tr[p].sum=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;r)&#123;</span><br><span class="line">        tr[p].l=<span class="built_in">build</span>(l,mid);</span><br><span class="line">        tr[p].r=<span class="built_in">build</span>(mid<span class="number">+1</span>,r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">update</span><span class="params">(<span class="type">int</span> pre,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> p=++cnt;</span><br><span class="line">    tr[p]=tr[pre];tr[p].sum++;</span><br><span class="line">    <span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(x&lt;=mid)tr[p].l=<span class="built_in">update</span>(tr[pre].l,l,mid,x);</span><br><span class="line">        <span class="keyword">else</span> tr[p].r=<span class="built_in">update</span>(tr[pre].r,mid<span class="number">+1</span>,r,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="type">int</span> x=tr[tr[v].l].sum-tr[tr[u].l].sum;</span><br><span class="line">    <span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;=k) <span class="keyword">return</span> <span class="built_in">query</span>(tr[u].l,tr[v].l,l,mid,k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(tr[u].r,tr[v].r,mid<span class="number">+1</span>,r,k-x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m;cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;<span class="built_in">a</span>(n),<span class="built_in">b</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;a[i];</span><br><span class="line">        b[i]=a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(b.<span class="built_in">begin</span>(),b.<span class="built_in">end</span>());</span><br><span class="line">    b.<span class="built_in">erase</span>(<span class="built_in">unique</span>(b.<span class="built_in">begin</span>(),b.<span class="built_in">end</span>()),b.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> len=b.<span class="built_in">size</span>();</span><br><span class="line">    tr[<span class="number">0</span>].rt=<span class="built_in">build</span>(<span class="number">1</span>,len);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="type">int</span> x=<span class="built_in">lower_bound</span>(b.<span class="built_in">begin</span>(),b.<span class="built_in">end</span>(),a[i])-b.<span class="built_in">begin</span>()<span class="number">+1</span>;</span><br><span class="line">        tr[i<span class="number">+1</span>].rt=<span class="built_in">update</span>(tr[i].rt,<span class="number">1</span>,len,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="type">int</span> l,r,k;cin&gt;&gt;l&gt;&gt;r&gt;&gt;k;<span class="comment">//æ±‚åŒºé—´[l,r]å†…çš„ç¬¬kå°</span></span><br><span class="line">        <span class="type">int</span> pos=<span class="built_in">query</span>(tr[l<span class="number">-1</span>].rt,tr[r].rt,<span class="number">1</span>,len,k);</span><br><span class="line">        cout&lt;&lt;b[pos<span class="number">-1</span>]&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="FHQ-Treap"><a href="#FHQ-Treap" class="headerlink" title="FHQ Treap"></a>FHQ Treap</h2><p>æ“ä½œå¤æ‚åº¦$log_2n$ï¼Œ</p>
<p>èƒ½å¤Ÿè§£å†³</p>
<ol>
<li>æ’å…¥ä¸€ä¸ªæ•° xã€‚</li>
<li>åˆ é™¤ä¸€ä¸ªæ•° xï¼ˆè‹¥æœ‰å¤šä¸ªç›¸åŒçš„æ•°ï¼Œåº”åªåˆ é™¤ä¸€ä¸ªï¼‰ã€‚</li>
<li>å®šä¹‰<strong>æ’å</strong>ä¸ºæ¯”å½“å‰æ•°å°çš„æ•°çš„ä¸ªæ•° +1ã€‚æŸ¥è¯¢ xçš„æ’åã€‚</li>
<li>æŸ¥è¯¢æ•°æ®ç»“æ„ä¸­æ’åä¸º xçš„æ•°ã€‚</li>
<li>æ±‚ x çš„å‰é©±ï¼ˆå‰é©±å®šä¹‰ä¸ºå°äº xï¼Œä¸”æœ€å¤§çš„æ•°ï¼‰ã€‚</li>
<li>æ±‚ x çš„åç»§ï¼ˆåç»§å®šä¹‰ä¸ºå¤§äº xï¼Œä¸”æœ€å°çš„æ•°ï¼‰ã€‚</li>
<li></li>
</ol>
]]></content>
      <categories>
        <category>XCPC</category>
        <category>XCPCæ¨¡æ¿</category>
        <category>XCPCæ•°æ®ç»“æ„</category>
      </categories>
      <tags>
        <tag>STè¡¨</tag>
        <tag>DSU</tag>
        <tag>SegmentTree</tag>
        <tag>LazySegmentTree</tag>
        <tag>Monotonic Stack</tag>
        <tag>Monotonic Deque</tag>
        <tag>Trie</tag>
        <tag>Fenwick</tag>
        <tag>Mo&#39;s Algorithm</tag>
        <tag>HLD</tag>
        <tag>PST</tag>
        <tag>FHQ Treap</tag>
        <tag>Inversion</tag>
      </tags>
  </entry>
  <entry>
    <title>XCPCå›¾è®º</title>
    <url>/2024/09/11/XCPC/XCPC%E6%A8%A1%E6%9D%BF/XCPC/XCPC%E5%9B%BE%E8%AE%BA/</url>
    <content><![CDATA[<p>ä»‹ç»XCPCèµ›äº‹ä¸­å›¾è®ºç›¸å…³çš„çŸ¥è¯†</p>
<span id="more"></span>

<h1 id="å›¾è®º"><a href="#å›¾è®º" class="headerlink" title="å›¾è®º"></a>å›¾è®º</h1><h2 id="å•æºæ±‡æœ€çŸ­è·¯-SSSP"><a href="#å•æºæ±‡æœ€çŸ­è·¯-SSSP" class="headerlink" title="å•æºæ±‡æœ€çŸ­è·¯(SSSP)"></a>å•æºæ±‡æœ€çŸ­è·¯(SSSP)</h2><p>Single-Source Shortest Path</p>
<h3 id="æ­£æƒè¾¹-Dijikstra"><a href="#æ­£æƒè¾¹-Dijikstra" class="headerlink" title="æ­£æƒè¾¹(Dijikstra)"></a>æ­£æƒè¾¹(Dijikstra)</h3><p>å †ä¼˜åŒ–ç‰ˆæœ¬èƒ½åœ¨mlognæ—¶é—´å¤æ‚åº¦å†…æ±‚èµ·ç‚¹åˆ°å…¶ä½™æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·¯å¾„(mä¸ºè¾¹,nä¸ºç‚¹)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> dijkstra=[&amp;](<span class="type">int</span> fi,<span class="type">int</span> se)&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;<span class="built_in">dist</span>(n<span class="number">+10</span>,inf);</span><br><span class="line">        priority_queue&lt;PII, vector&lt;PII&gt;, greater&lt;&gt;&gt; heap;</span><br><span class="line">        heap.<span class="built_in">push</span>(&#123;<span class="number">0</span>, fi&#125;);</span><br><span class="line">        <span class="keyword">while</span> (heap.<span class="built_in">size</span>())&#123;</span><br><span class="line">            <span class="keyword">auto</span> [d,u] =heap.<span class="built_in">top</span>();</span><br><span class="line">            heap.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (dist[u]!=inf) <span class="keyword">continue</span>;</span><br><span class="line">            dist[u]=d;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> [i,w]:g[u])&#123;</span><br><span class="line">                <span class="keyword">if</span> (dist[i] &gt; dist[u] + w)&#123;</span><br><span class="line">                    dist[i] = dist[u] + w;</span><br><span class="line">                    heap.<span class="built_in">push</span>(&#123;dist[i], i&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dist[se];</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<h3 id="è´Ÿæƒè¾¹-Bellman-ford"><a href="#è´Ÿæƒè¾¹-Bellman-ford" class="headerlink" title="è´Ÿæƒè¾¹(Bellman ford)"></a>è´Ÿæƒè¾¹(Bellman ford)</h3><p>ä½¿ç”¨ç»“æ„ä½“å­˜è¾¹ï¼ˆè¯¥ç®—æ³•æ— éœ€å­˜å›¾ï¼‰ï¼Œä»¥O(NM) çš„å¤æ‚åº¦è®¡ç®—ï¼ŒNâˆ’1 è½®åä»æ— æ³•å¾—åˆ°ç­”æ¡ˆï¼ˆä¸€èˆ¬ä¸ INF&#x2F;2è¿›è¡Œæ¯”è¾ƒï¼‰çš„ç‚¹ï¼Œåˆ°è¾¾å…¶çš„è·¯å¾„ä¸Šå­˜åœ¨è´Ÿç¯ã€‚</p>
<p>ä¸‹æ–¹ä»£ç ä¾‹é¢˜ï¼šæ±‚è§£ä» 1 åˆ° n å·èŠ‚ç‚¹çš„ã€æœ€å¤šç»è¿‡ k æ¡è¾¹çš„æœ€çŸ­è·ç¦»ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">550</span>, M = <span class="number">1e5</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, k;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123; <span class="type">int</span> x, y, w; &#125; ver[M];</span><br><span class="line"><span class="type">int</span> d[N], backup[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(d, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> d); d[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++ i) &#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(backup, d, <span class="keyword">sizeof</span> d);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++ j) &#123;<span class="comment">//å¦‚æœä¸ºåŒå‘è¾¹ï¼Œmæ”¹ä¸ºè¾¹çš„æ€»æ¡æ•°</span></span><br><span class="line">            <span class="type">int</span> x = ver[j].x, y = ver[j].y, w = ver[j].w;</span><br><span class="line">            d[y] = <span class="built_in">min</span>(d[y], backup[x] + w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++ i) &#123;</span><br><span class="line">        <span class="type">int</span> x, y, w; cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class="line">        ver[i] = &#123;x, y, w&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">bf</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++ i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (d[i] &gt; INF / <span class="number">2</span>) cout &lt;&lt; <span class="string">&quot;N&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; d[n] &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è´Ÿæƒè¾¹-SPFA"><a href="#è´Ÿæƒè¾¹-SPFA" class="headerlink" title="è´Ÿæƒè¾¹(SPFA)"></a>è´Ÿæƒè¾¹(SPFA)</h3><p>æŒ‰ç†è¯´å¤æ‚åº¦ä¸ºO(KM),Kä¸ºå¸¸æ•°,ä½†æœ‰æ—¶ä¼šé€€åŒ–è‡³O(NM)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt;<span class="built_in">dist</span>(n<span class="number">+1</span>,<span class="number">1e9</span>),<span class="built_in">st</span>(n<span class="number">+1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">auto</span> spfa=[&amp;]()&#123;</span><br><span class="line">        dist[s]=<span class="number">0</span>;</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt;q;q.<span class="built_in">push</span>(s);</span><br><span class="line">        st[s]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(q.<span class="built_in">size</span>())&#123;</span><br><span class="line">            <span class="keyword">auto</span> t=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();st[t]=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> [x,y]:g[t])&#123;</span><br><span class="line">                <span class="keyword">if</span>(dist[x]&gt;dist[t]+y)&#123;</span><br><span class="line">                    dist[x]=dist[t]+y;</span><br><span class="line">                    <span class="keyword">if</span>(!st[x])&#123;</span><br><span class="line">                        q.<span class="built_in">push</span>(x);</span><br><span class="line">                        st[x]=<span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">spfa</span>();</span><br></pre></td></tr></table></figure>

<h2 id="å¤šæºæ±‡æœ€çŸ­è·¯-APSP"><a href="#å¤šæºæ±‡æœ€çŸ­è·¯-APSP" class="headerlink" title="å¤šæºæ±‡æœ€çŸ­è·¯(APSP)"></a>å¤šæºæ±‡æœ€çŸ­è·¯(APSP)</h2><p>All-Pairs Shortest Paths</p>
<h3 id="Floyd"><a href="#Floyd" class="headerlink" title="Floyd"></a>Floyd</h3><p>ä½¿ç”¨é‚»æ¥çŸ©é˜µå­˜å›¾ï¼Œå¯ä»¥å¤„ç†è´Ÿæƒè¾¹ï¼Œä»¥ O($N^3$) çš„å¤æ‚åº¦è®¡ç®—ã€‚<strong>æ³¨æ„ï¼Œè¿™é‡Œå»ºç«‹çš„æ˜¯å•å‘è¾¹ï¼Œè®¡ç®—åŒå‘è¾¹éœ€è¦é¢å¤–åŠ è¾¹</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">210</span>;</span><br><span class="line"><span class="type">int</span> n, m, d[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">floyd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= n; k ++ )<span class="comment">//æ³¨æ„ï¼Œæšä¸¾ä¸­é—´ç‚¹çš„è¦æ”¾åœ¨æœ€å¤–å±‚</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ )</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j ++ )</span><br><span class="line">                d[i][j] = <span class="built_in">min</span>(d[i][j], d[i][k] + d[k][j]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ )</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j ++ )</span><br><span class="line">            <span class="keyword">if</span> (i == j) d[i][j] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span> d[i][j] = INF;</span><br><span class="line">    <span class="keyword">while</span> (m -- ) &#123;</span><br><span class="line">        <span class="type">int</span> x, y, w; cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class="line">        d[x][y] = <span class="built_in">min</span>(d[x][y], w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">floyd</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++ i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++ j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (d[i][j] &gt; INF / <span class="number">2</span>) cout &lt;&lt; <span class="string">&quot;N&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">else</span> cout &lt;&lt; d[i][j] &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="äºŒåˆ†å›¾"><a href="#äºŒåˆ†å›¾" class="headerlink" title="äºŒåˆ†å›¾"></a>äºŒåˆ†å›¾</h2><h3 id="æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾"><a href="#æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾" class="headerlink" title="æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾"></a>æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vis</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> self, <span class="type">int</span> x, <span class="type">int</span> type) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    vis[x] = type;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : ver[x]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[y] == type) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;NO\n&quot;</span>;</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (vis[y]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">self</span>(self, y, <span class="number">3</span> - type);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (vis[i]) &#123;</span><br><span class="line">        <span class="built_in">dfs</span>(dfs, i, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="è¿é€šæ€§ç›¸å…³"><a href="#è¿é€šæ€§ç›¸å…³" class="headerlink" title="è¿é€šæ€§ç›¸å…³"></a>è¿é€šæ€§ç›¸å…³</h2><h3 id="å‰²ç‚¹ä¸æ¡¥"><a href="#å‰²ç‚¹ä¸æ¡¥" class="headerlink" title="å‰²ç‚¹ä¸æ¡¥"></a>å‰²ç‚¹ä¸æ¡¥</h3><h4 id="å‰²ç‚¹-cut-vertex-articulation-pointï¼‰"><a href="#å‰²ç‚¹-cut-vertex-articulation-pointï¼‰" class="headerlink" title="å‰²ç‚¹(cut vertex &#x2F; articulation pointï¼‰"></a>å‰²ç‚¹(cut vertex &#x2F; articulation pointï¼‰</h4><p>ç»™å‡ºå®šä¹‰ï¼šåˆ é™¤è¯¥ç‚¹åå¯¼è‡´å›¾ä¸å†è¿é€šçš„ç‚¹ç§°ä¸ºå‰²ç‚¹</p>
<p>æ±‚å‰²ç‚¹çš„æ–¹æ³•ç§°ä¸ºtarjanï¼Œåœ¨è¿é€šæ€§ç›¸å…³çš„é—®é¢˜ä¸­å¹¿æ³›è¿ç”¨äº†è¯¥æ–¹æ³•</p>
<p>tarjançš„ä¸»è¦æ€æƒ³å°±æ˜¯dfnä¸lowæ•°ç»„</p>
<p>dfnï¼šæ—¶é—´æˆ³æ•°ç»„ï¼Œdfn[i]ç§°ä¸ºèŠ‚ç‚¹içš„dfsåº</p>
<p>dfsåºæŒ‡çš„æ˜¯åœ¨dfsè¿‡ç¨‹ä¸­ï¼Œè¯¥èŠ‚ç‚¹æ˜¯ç¬¬å‡ ä¸ªè¢«è®¿é—®åˆ°çš„èŠ‚ç‚¹ã€‚dfnæ•°ç»„çš„å€¼éšdfsè¿‡ç¨‹å•è°ƒä¸Šå‡ã€‚</p>
<p>low[i] ä»£è¡¨èŠ‚ç‚¹ i åœ¨ä¸ç›´æ¥è¿”å›çˆ¶äº²èŠ‚ç‚¹çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡â€œç»•è·¯â€ï¼Œèƒ½å¤Ÿè®¿é—®åˆ°çš„èŠ‚ç‚¹é‡Œï¼Œæœ€å°çš„dfnå€¼</p>
<p>ç”±äºå‰²ç‚¹ä¸dfnæ•°ç»„çš„æ€§è´¨ï¼Œä¸è¿”å›çˆ¶äº²èŠ‚ç‚¹çš„æƒ…å†µä¸‹ï¼Œå‰²ç‚¹uçš„å­ç»“ç‚¹ä¸­ä¸€å®šå­˜åœ¨ä¸€ç‚¹vä½¿å¾—dfn[u]&lt;&#x3D;low[v]</p>
<p>ç‰¹åˆ«çš„ï¼Œæ ¹èŠ‚ç‚¹çš„åˆ¤æ–­æ–¹æ³•ä¸ºå­èŠ‚ç‚¹å¤§äº1</p>
<p>ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå‰²ç‚¹ä»£ç ä¸æä¾›å°è£…å†™æ³•ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªè¡Œå°è£…</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> dfs=[&amp;](<span class="keyword">auto</span> self,<span class="type">int</span> u,<span class="type">int</span> p)-&gt;<span class="type">void</span>&#123;</span><br><span class="line">        dfn[u]=low[u]=cur++;</span><br><span class="line">        <span class="type">int</span> son=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i:g[u])&#123;</span><br><span class="line">            <span class="keyword">if</span>(dfn[i]==<span class="number">-1</span>)&#123;</span><br><span class="line">                son++;</span><br><span class="line">                <span class="built_in">self</span>(self,i,u);</span><br><span class="line">                low[u]=<span class="built_in">min</span>(low[u],low[i]);</span><br><span class="line">                <span class="keyword">if</span>(p!=<span class="number">-1</span>&amp;&amp;low[i]&gt;=dfn[u])&#123;</span><br><span class="line">                    st[u]=<span class="number">1</span>;<span class="comment">//æ­¤æ—¶uä¸ºå‰²ç‚¹</span></span><br><span class="line">                    <span class="comment">//ä¸”æ¯æ ‡è®°ä¸€æ¬¡ï¼Œå…±ç”¨è¯¥ç‚¹çš„è¿é€šå—æ•°é‡å°±åŠ 1</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i!=p)&#123;</span><br><span class="line">                low[u]=<span class="built_in">min</span>(low[u],dfn[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(p==<span class="number">-1</span>&amp;&amp;son&gt;<span class="number">1</span>)&#123;</span><br><span class="line">            st[u]=<span class="number">1</span>;<span class="comment">//æ­¤æ—¶uä¸ºå‰²ç‚¹</span></span><br><span class="line">        &#125;</span><br><span class="line">    	<span class="comment">//æ ¹èŠ‚ç‚¹çš„å…±ç”¨è¿é€šå—æ•°é‡æ˜¯son-1ï¼Œæ±‚è¿é€šå—æ—¶ä¸å¿…ç‰¹åˆ¤son&gt;1</span></span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<h4 id="å‰²è¾¹-æ¡¥-cut-edge-bridge"><a href="#å‰²è¾¹-æ¡¥-cut-edge-bridge" class="headerlink" title="å‰²è¾¹&#x2F;æ¡¥(cut edge&#x2F;bridge)"></a>å‰²è¾¹&#x2F;æ¡¥(cut edge&#x2F;bridge)</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> dfs=[&amp;](<span class="keyword">auto</span> self,<span class="type">int</span> u, <span class="type">int</span> p)-&gt;<span class="type">void</span>&#123;</span><br><span class="line">        low[u] = dfn[u] = ++cur;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i:g[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!dfn[i]) &#123;</span><br><span class="line">                <span class="built_in">self</span>(self,i, u);</span><br><span class="line">                low[u] = <span class="built_in">min</span>(low[u], low[i]);</span><br><span class="line">                <span class="keyword">if</span> (low[i] &gt; dfn[u]) &#123;</span><br><span class="line">                    <span class="type">int</span> l=<span class="built_in">min</span>(u,i),r=<span class="built_in">max</span>(u,i);</span><br><span class="line">                    ans.<span class="built_in">push_back</span>(&#123;l,r&#125;);<span class="comment">//v,uä¸ºå‰²è¾¹</span></span><br><span class="line">                    ++cnt;<span class="comment">//cntä¸ºå‰²è¾¹æ•°é‡</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dfn[i]&lt;dfn[u]&amp;&amp;i != p) &#123;</span><br><span class="line">                low[u] = <span class="built_in">min</span>(low[u], dfn[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">dfs</span>(dfs,<span class="number">1</span>,<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<h3 id="å¼ºè¿é€šåˆ†é‡-SCC"><a href="#å¼ºè¿é€šåˆ†é‡-SCC" class="headerlink" title="å¼ºè¿é€šåˆ†é‡(SCC)"></a>å¼ºè¿é€šåˆ†é‡(SCC)</h3><p>å¼ºè¿é€šåˆ†é‡(Strongly Connected Components)ï¼Œè®¨è®ºæœ‰å‘å›¾</p>
<p>æœ‰å‘å›¾ G å¼ºè¿é€šæ˜¯æŒ‡ï¼ŒG ä¸­ä»»æ„ä¸¤ä¸ªç»“ç‚¹è¿é€šã€‚</p>
<p>å¼ºè¿é€šåˆ†é‡ç¼©ç‚¹</p>
<p>æ€§è´¨ï¼šç¼©ç‚¹åçš„å›¾æ‹¥æœ‰æ‹“æ‰‘åº colorcnt,colorcntâˆ’1,â€¦,1colorcnt,colorcntâˆ’1,â€¦,1 ï¼Œå¯ä»¥ä¸éœ€å†å¦è·‘ä¸€é topsort ï¼›ç¼©ç‚¹åçš„å›¾æ˜¯ä¸€å¼ æœ‰å‘æ— ç¯å›¾ï¼ˆ DAGã€æ‹“æ‰‘å›¾ï¼‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SCC</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; adj;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; stk;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dfn, low, bel;</span><br><span class="line">    <span class="type">int</span> cur, cnt;</span><br><span class="line">    <span class="built_in">SCC</span>() &#123;&#125;</span><br><span class="line">    <span class="built_in">SCC</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        adj.<span class="built_in">assign</span>(n, &#123;&#125;);</span><br><span class="line">        dfn.<span class="built_in">assign</span>(n, <span class="number">-1</span>);</span><br><span class="line">        low.<span class="built_in">resize</span>(n);</span><br><span class="line">        bel.<span class="built_in">assign</span>(n, <span class="number">-1</span>);</span><br><span class="line">        stk.<span class="built_in">clear</span>();</span><br><span class="line">        cur = cnt = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        dfn[x] = low[x] = cur++;</span><br><span class="line">        stk.<span class="built_in">push_back</span>(x);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : adj[x]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dfn[y] == <span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="built_in">dfs</span>(y);</span><br><span class="line">                low[x] = <span class="built_in">min</span>(low[x], low[y]);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (bel[y] == <span class="number">-1</span>) &#123;</span><br><span class="line">                low[x] = <span class="built_in">min</span>(low[x], dfn[y]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dfn[x] == low[x]) &#123;</span><br><span class="line">            <span class="type">int</span> y;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                y = stk.<span class="built_in">back</span>();</span><br><span class="line">                bel[y] = cnt;</span><br><span class="line">                stk.<span class="built_in">pop_back</span>();</span><br><span class="line">            &#125; <span class="keyword">while</span> (y != x);</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dfn[i] == <span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="built_in">dfs</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bel;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Employ"><a href="#Employ" class="headerlink" title="Employ"></a>Employ</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">SCC <span class="title">scc</span><span class="params">(n<span class="number">+1</span>)</span></span>;<span class="comment">//æ‰€æœ‰ç‚¹åˆå§‹åŒ–</span></span><br><span class="line">scc.<span class="built_in">addEdge</span>(u,v);<span class="comment">//u,vè¿æœ‰å‘è¾¹ï¼Œu-&gt;v</span></span><br><span class="line"><span class="keyword">auto</span> bel=scc.<span class="built_in">work</span>()<span class="comment">//æ‰§è¡Œå¼ºè¿é€šåˆ†é‡ç¼©ç‚¹ï¼Œè¿”å›çš„æ˜¯vector</span></span><br><span class="line"><span class="comment">//belè¡¨ç¤ºæ¯ä¸ªç‚¹æ‰€åœ¨çš„å¼ºè¿é€šåˆ†é‡æ ‡å·,nä¸ªç‚¹æœ€å¤šnä¸ªå¼ºè¿é€šåˆ†é‡</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/***ç¼©ç‚¹å®Œé‡æ–°å»ºå›¾***/</span></span><br><span class="line"><span class="comment">//â€œè¶…çº§ç‚¹çš„ç‚¹æƒæ ¹æ®é¢˜æ„ç¡®å®š,æ­¤æ—¶ç‚¹é‡æ–°å‘½åä¸ºbel[i]â€</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> j:g[i])&#123;</span><br><span class="line">            <span class="keyword">if</span>(bel[i]!=bel[j])&#123;</span><br><span class="line">                adj[bel[i]].<span class="built_in">push_back</span>(bel[j]);</span><br><span class="line">                in[bel[j]]++;<span class="comment">//å­˜å‚¨å…¥åº¦</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;scc.cnt;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(in[i]==<span class="number">0</span>)&#123;</span><br><span class="line">            ans+=sum[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;    </span><br></pre></td></tr></table></figure>

<h3 id="åŒè¿é€šåˆ†é‡-Biconnected-component"><a href="#åŒè¿é€šåˆ†é‡-Biconnected-component" class="headerlink" title="åŒè¿é€šåˆ†é‡ (Biconnected component)"></a>åŒè¿é€šåˆ†é‡ (Biconnected component)</h3><p>ç”±äºæ˜¯åŒè¿é€šå›¾ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†è®¨è®ºçš„å‡ä¸ºæ— å‘å›¾</p>
<h4 id="è¾¹åŒè¿é€šåˆ†é‡-EBC"><a href="#è¾¹åŒè¿é€šåˆ†é‡-EBC" class="headerlink" title="è¾¹åŒè¿é€šåˆ†é‡ (EBC)"></a>è¾¹åŒè¿é€šåˆ†é‡ (EBC)</h4><p>è¾¹åŒæ˜¯Edge Biconnected Componentï¼Œæ‰€ä»¥å…¶å®æ˜¯EBCCï¼Œä½†æ˜¯ä¸ºäº†å’Œå‰²è¾¹ç¼©ç‚¹(EBCC)åŒºåˆ«å¼€ï¼Œè¿™é‡Œæˆ‘ä»¬å‘½åä¸ºEBC</p>
<p>ç»™å‡ºå®šä¹‰ï¼šä¸å­˜åœ¨å‰²è¾¹&#x2F;æ¡¥çš„æå¤§åŒè¿é€šå­å›¾ç§°ä¸ºè¾¹åŒè¿é€šåˆ†é‡</p>
<p>æ‰€ä»¥æ±‚è¾¹åŒçš„æ–¹æ³•ä¹Ÿå¾ˆæ˜¾ç„¶ï¼Œå°†ä¸€å¼ å›¾ä¸­çš„æ‰€æœ‰å‰²è¾¹&#x2F;æ¡¥æ–­æ‰åï¼Œå‰©ä¸‹çš„è¿é€šå—å‡ä¸ºä¸€ä¸ªè¾¹åŒï¼Œè¾¹åŒä¸è¾¹åŒä¹‹é—´ä»¥å‰²è¾¹&#x2F;æ¡¥è¿æ¥æˆä¸€æ£µæ ‘</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">EBC</span> &#123;</span><br><span class="line">    vector&lt;vector&lt;PII&gt;&gt;adj;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;ans;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;dfn,low,stk;</span><br><span class="line">    <span class="type">int</span> cur,n;</span><br><span class="line">    <span class="built_in">EBC</span>()&#123;&#125;;</span><br><span class="line">    <span class="built_in">EBC</span>(<span class="type">int</span> n)&#123;</span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n=n;</span><br><span class="line">        adj.<span class="built_in">resize</span>(n,&#123;&#125;);</span><br><span class="line">        dfn.<span class="built_in">resize</span>(n,<span class="number">-1</span>);</span><br><span class="line">        low.<span class="built_in">resize</span>(n);</span><br><span class="line">        stk.<span class="built_in">clear</span>();</span><br><span class="line">        cur=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">edge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">        adj[u].<span class="built_in">push_back</span>(&#123;v,i&lt;&lt;<span class="number">1</span>&#125;);</span><br><span class="line">        adj[v].<span class="built_in">push_back</span>(&#123;u,i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> p)</span></span>&#123;</span><br><span class="line">        stk.<span class="built_in">push_back</span>(u);</span><br><span class="line">        dfn[u]=low[u]=cur++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i:adj[u])&#123;</span><br><span class="line">            <span class="keyword">if</span>(i.second==(p^<span class="number">1</span>)) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(dfn[i.first]==<span class="number">-1</span>)&#123;</span><br><span class="line">                <span class="built_in">dfs</span>(i.first,i.second);</span><br><span class="line">                low[u]=<span class="built_in">min</span>(low[u],low[i.first]);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                low[u]=<span class="built_in">min</span>(low[u],dfn[i.first]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(dfn[u]==low[u])&#123;</span><br><span class="line">            vector&lt;<span class="type">int</span>&gt;vec;</span><br><span class="line">            <span class="type">int</span> y;</span><br><span class="line">            <span class="keyword">do</span>&#123;</span><br><span class="line">                y=stk.<span class="built_in">back</span>();</span><br><span class="line">                vec.<span class="built_in">push_back</span>(y);</span><br><span class="line">                stk.<span class="built_in">pop_back</span>();</span><br><span class="line">            &#125;<span class="keyword">while</span>(y!=u);</span><br><span class="line">            ans.<span class="built_in">push_back</span>(vec);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">work</span>()&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(dfn[i]==<span class="number">-1</span>)&#123;</span><br><span class="line">                <span class="built_in">dfs</span>(i,<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="Employ-1"><a href="#Employ-1" class="headerlink" title="Employ"></a>Employ</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">EBC <span class="title">ebc</span><span class="params">(n<span class="number">+1</span>)</span></span>;<span class="comment">//å»ºEBC</span></span><br><span class="line">ebc.<span class="built_in">edge</span>(u,v,i)<span class="comment">//iæ˜¯forè¯»å…¥æ•°æ®çš„i</span></span><br><span class="line"><span class="keyword">auto</span> ans=ebc.<span class="built_in">work</span>()<span class="comment">//ansæ•°ç»„å­˜å‚¨æ¯ä¸ªåŒè¿é€šåˆ†é‡</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:ans)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> j:i)&#123;</span><br><span class="line">        <span class="comment">//æ¯ä¸ªè¾¹åŒçš„ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ç‚¹åŒè¿é€šåˆ†é‡-VBC"><a href="#ç‚¹åŒè¿é€šåˆ†é‡-VBC" class="headerlink" title="ç‚¹åŒè¿é€šåˆ†é‡(VBC)"></a>ç‚¹åŒè¿é€šåˆ†é‡(VBC)</h4><p>ç‚¹åŒVertex Biconnected Component</p>
<p>ä¸å­˜åœ¨å‰²ç‚¹çš„æå¤§åŒè¿é€šå­å›¾</p>
<p>å‰²ç‚¹ç¼©ç‚¹åçš„å›¾ç§°ä¸ºç‚¹åŒè¿é€šå›¾ (V-DCC)ï¼Œè¯¥æ¨¡æ¿å¯ä»¥åœ¨ O(N+M)O(N+M) å¤æ‚åº¦å†…æ±‚è§£å›¾ä¸­å…¨éƒ¨å‰²ç‚¹ã€åˆ’åˆ†ç‚¹åŒï¼ˆé¢œè‰²ç›¸åŒçš„ç‚¹ä½äºåŒä¸€ä¸ªç‚¹åŒè¿é€šåˆ†é‡ä¸­ï¼‰ã€‚</p>
<p>æ€§è´¨è¡¥å……ï¼šæ¯ä¸€ä¸ªå‰²ç‚¹è‡³å°‘å±äºä¸¤ä¸ªç‚¹åŒã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">V_DCC</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; ver, col;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dfn, low, S;</span><br><span class="line">    <span class="type">int</span> now, cnt;</span><br><span class="line">    vector&lt;<span class="type">bool</span>&gt; point; <span class="comment">// è®°å½•æ˜¯å¦ä¸ºå‰²ç‚¹</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">V_DCC</span>(<span class="type">int</span> n) : <span class="built_in">n</span>(n) &#123;</span><br><span class="line">        ver.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        dfn.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        low.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        col.<span class="built_in">resize</span>(<span class="number">2</span> * n + <span class="number">1</span>);</span><br><span class="line">        point.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        S.<span class="built_in">clear</span>();</span><br><span class="line">        cnt = now = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x == y) <span class="keyword">return</span>; <span class="comment">// æ‰‹åŠ¨å»é™¤é‡è¾¹</span></span><br><span class="line">        ver[x].<span class="built_in">push_back</span>(y);</span><br><span class="line">        ver[y].<span class="built_in">push_back</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> root)</span> </span>&#123;</span><br><span class="line">        low[x] = dfn[x] = now++;</span><br><span class="line">        S.<span class="built_in">push_back</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (x == root &amp;&amp; !ver[x].<span class="built_in">size</span>()) &#123; <span class="comment">// ç‰¹åˆ¤å­¤ç«‹ç‚¹</span></span><br><span class="line">            ++cnt;</span><br><span class="line">            col[cnt].<span class="built_in">push_back</span>(x);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> flag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : ver[x]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!dfn[y]) &#123;</span><br><span class="line">                <span class="built_in">tarjan</span>(y, root);</span><br><span class="line">                low[x] = <span class="built_in">min</span>(low[x], low[y]);</span><br><span class="line">                <span class="keyword">if</span> (dfn[x] &lt;= low[y]) &#123;</span><br><span class="line">                    flag++;</span><br><span class="line">                    <span class="keyword">if</span> (x != root || flag &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                        point[x] = <span class="literal">true</span>; <span class="comment">// æ ‡è®°ä¸ºå‰²ç‚¹</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">int</span> pre = <span class="number">0</span>;</span><br><span class="line">                    cnt++;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        pre = S.<span class="built_in">back</span>();</span><br><span class="line">                        col[cnt].<span class="built_in">push_back</span>(pre);</span><br><span class="line">                        S.<span class="built_in">pop_back</span>();</span><br><span class="line">                    &#125; <span class="keyword">while</span> (pre != y);</span><br><span class="line">                    col[cnt].<span class="built_in">push_back</span>(x);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                low[x] = <span class="built_in">min</span>(low[x], dfn[y]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    pair&lt;<span class="type">int</span>, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&gt; <span class="built_in">rebuild</span>() &#123; <span class="comment">// [æ–°å›¾çš„é¡¶ç‚¹æ•°é‡, æ–°å›¾]</span></span><br><span class="line">        <span class="built_in">work</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">adj</span>(cnt + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!col[i].<span class="built_in">size</span>()) &#123; <span class="comment">// æ³¨æ„ï¼Œå­¤ç«‹ç‚¹ä¹Ÿæ˜¯ V-DCC</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> j : col[i]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (point[j]) &#123; <span class="comment">// å¦‚æœ j æ˜¯å‰²ç‚¹</span></span><br><span class="line">                    adj[i].<span class="built_in">push_back</span>(point[j]);</span><br><span class="line">                    adj[point[j]].<span class="built_in">push_back</span>(i);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;cnt, adj&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123; <span class="comment">// é¿å…å›¾ä¸è¿é€š</span></span><br><span class="line">            <span class="keyword">if</span> (!dfn[i]) &#123;</span><br><span class="line">                <span class="built_in">tarjan</span>(i, i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="å‰²è¾¹ä¸å‰²è¾¹ç¼©ç‚¹-EBCC"><a href="#å‰²è¾¹ä¸å‰²è¾¹ç¼©ç‚¹-EBCC" class="headerlink" title="å‰²è¾¹ä¸å‰²è¾¹ç¼©ç‚¹(EBCC)"></a>å‰²è¾¹ä¸å‰²è¾¹ç¼©ç‚¹(EBCC)</h3><p>æ€§è´¨è¡¥å……ï¼šå¯¹äºä¸€ä¸ªè¾¹åŒï¼Œåˆ å»ä»»æ„è¾¹åä¾æ—§è”é€šï¼›å¯¹äºè¾¹åŒä¸­çš„ä»»æ„ä¸¤ç‚¹ï¼Œä¸€å®šå­˜åœ¨ä¸¤æ¡ä¸ç›¸äº¤çš„è·¯å¾„è¿æ¥è¿™ä¸¤ä¸ªç‚¹ï¼ˆè·¯å¾„ä¸Šå¯ä»¥æœ‰å…¬å…±ç‚¹ï¼Œä½†æ˜¯æ²¡æœ‰å…¬å…±è¾¹ï¼‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">set&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; E;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">EBCC</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    std::vector&lt;std::vector&lt;<span class="type">int</span>&gt;&gt; adj;</span><br><span class="line">    std::vector&lt;<span class="type">int</span>&gt; stk;</span><br><span class="line">    std::vector&lt;<span class="type">int</span>&gt; dfn, low, bel;</span><br><span class="line">    <span class="type">int</span> cur, cnt;</span><br><span class="line">    <span class="built_in">EBCC</span>() &#123;&#125;</span><br><span class="line">    <span class="built_in">EBCC</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        adj.<span class="built_in">assign</span>(n, &#123;&#125;);</span><br><span class="line">        dfn.<span class="built_in">assign</span>(n, <span class="number">-1</span>);</span><br><span class="line">        low.<span class="built_in">resize</span>(n);</span><br><span class="line">        bel.<span class="built_in">assign</span>(n, <span class="number">-1</span>);</span><br><span class="line">        stk.<span class="built_in">clear</span>();</span><br><span class="line">        cur = cnt = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        adj[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">        dfn[x] = low[x] = cur++;</span><br><span class="line">        stk.<span class="built_in">push_back</span>(x);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : adj[x]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (y == p) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (dfn[y] == <span class="number">-1</span>) &#123;</span><br><span class="line">                E.<span class="built_in">emplace</span>(x, y);</span><br><span class="line">                <span class="built_in">dfs</span>(y, x);</span><br><span class="line">                low[x] = std::<span class="built_in">min</span>(low[x], low[y]);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (bel[y] == <span class="number">-1</span> &amp;&amp; dfn[y] &lt; dfn[x]) &#123;</span><br><span class="line">                E.<span class="built_in">emplace</span>(x, y);</span><br><span class="line">                low[x] = std::<span class="built_in">min</span>(low[x], dfn[y]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (dfn[x] == low[x]) &#123;</span><br><span class="line">            <span class="type">int</span> y;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                y = stk.<span class="built_in">back</span>();</span><br><span class="line">                bel[y] = cnt;</span><br><span class="line">                stk.<span class="built_in">pop_back</span>();</span><br><span class="line">            &#125; <span class="keyword">while</span> (y != x);</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ‰§è¡Œä¸»ä½“,è¿”å›bel,bel[u]æŒ‡uç‚¹ç¼©ç‚¹åæ˜¯å“ªä¸ªç‚¹</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> bel;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Graph</span> &#123;</span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line">        <span class="comment">//ç¼©ç‚¹åçš„ç‚¹æ•°</span></span><br><span class="line">        vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; edges;</span><br><span class="line">        <span class="comment">//ç¼©ç‚¹åçš„è¾¹</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; siz;</span><br><span class="line">        <span class="comment">//ç¼©ç‚¹çš„ç‚¹åŒ…å«åŸå…ˆçš„ç‚¹æ•°</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; cnte;</span><br><span class="line">        <span class="comment">//ç¼©ç‚¹çš„ç‚¹åŒ…å«çš„åŸå…ˆçš„è¾¹+è¯¥ç‚¹åˆ°å…¶å„¿å­çš„è¾¹æ•°çš„ä¸ªæ•°</span></span><br><span class="line">        <span class="comment">//çˆ¶äº²å’Œå„¿å­ç”±dfnåºå†³å®š</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">Graph <span class="title">compress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Graph g;</span><br><span class="line">        g.n = cnt;</span><br><span class="line">        g.siz.<span class="built_in">resize</span>(cnt);</span><br><span class="line">        g.cnte.<span class="built_in">resize</span>(cnt);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            g.siz[bel[i]]++;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> j : adj[i]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (bel[i] &lt; bel[j]) &#123;</span><br><span class="line">                    g.edges.<span class="built_in">emplace_back</span>(bel[i], bel[j]);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">                    g.cnte[bel[i]]++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> g;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Employ-2"><a href="#Employ-2" class="headerlink" title="Employ"></a>Employ</h4><p>ä»…è¿é€šå›¾å¯ä»¥ç”¨ï¼Œå°†æ‰€æœ‰çš„æ¡¥è¾¹å‰²æ‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">EBCC <span class="title">g</span><span class="params">(n<span class="number">+1</span>)</span></span>; <span class="comment">//å»ºEBCC</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">    <span class="type">int</span> u,v;cin&gt;&gt;u&gt;&gt;v;</span><br><span class="line">    g.<span class="built_in">addEdge</span>(u,v);  <span class="comment">//åŠ è¾¹</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">auto</span> res=g.<span class="built_in">work</span>();  <span class="comment">//æ‰§è¡ŒEBCCå‰²è¾¹,è¿”å›å„ç‚¹ç¼©ç‚¹åçš„å¯¹åº”çš„ç‚¹</span></span><br><span class="line"><span class="comment">//åˆ¤æ–­æ•´ä¸ªå›¾æ˜¯è¾¹åŒçš„ï¼Œcount(res.begin(),res.end(),0)&lt;nä¸æ˜¯è¾¹åŒ</span></span><br><span class="line"><span class="keyword">auto</span> [ng,edges,siz,cnte]=g.<span class="built_in">compress</span>(); <span class="comment">//è·å–å‰²è¾¹ç¼©ç‚¹åçš„å›¾çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">//å»ºç«‹å‰²è¾¹ç¼©ç‚¹åçš„å›¾(æ³¨æ„å¦‚æœåŸå›¾ç»™çš„æœ‰é‡è¾¹ï¼Œedgesä¹Ÿä¼šå­˜æœ‰é‡è¾¹)</span></span><br><span class="line"><span class="comment">//é‡è¾¹æƒ…å†µå°†Graphé‡Œçš„edgesæ”¹ä¸ºsetå­˜å‚¨å³å¯</span></span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;<span class="built_in">adj</span>(ng);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> &amp;[u,v]:edges)&#123;</span><br><span class="line">    adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">    adj[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¾“å‡ºä¸€ç§æ— å‘è¾¹æ”¹æœ‰å‘è¾¹çš„æ–¹å¼,ä½¿å¾—æ›´æ”¹åæ»¡è¶³:æ•´ä¸ªå›¾æ˜¯å¼ºè¿é€šçš„</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span>[x,y]:E) &#123;</span><br><span class="line">    cout&lt;&lt;x&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;y&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ ‘é“¾å‰–åˆ†-HLD"><a href="#æ ‘é“¾å‰–åˆ†-HLD" class="headerlink" title="æ ‘é“¾å‰–åˆ†(HLD)"></a>æ ‘é“¾å‰–åˆ†(HLD)</h2><p>é‡é“¾å‰–åˆ†</p>
<p>Heavy-Light Decomposition</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">HLD</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; siz, top, dep, parent, in, out, seq;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; adj;</span><br><span class="line">    <span class="type">int</span> cur;</span><br><span class="line">    <span class="built_in">HLD</span>() &#123;&#125;</span><br><span class="line">    <span class="built_in">HLD</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        siz.<span class="built_in">resize</span>(n);</span><br><span class="line">        top.<span class="built_in">resize</span>(n);</span><br><span class="line">        dep.<span class="built_in">resize</span>(n);</span><br><span class="line">        parent.<span class="built_in">resize</span>(n);</span><br><span class="line">        in.<span class="built_in">resize</span>(n);</span><br><span class="line">        out.<span class="built_in">resize</span>(n);</span><br><span class="line">        seq.<span class="built_in">resize</span>(n);</span><br><span class="line">        cur = <span class="number">0</span>;</span><br><span class="line">        adj.<span class="built_in">assign</span>(n, &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        adj[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">work</span><span class="params">(<span class="type">int</span> root = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">        top[root] = root;</span><br><span class="line">        dep[root] = <span class="number">0</span>;</span><br><span class="line">        parent[root] = <span class="number">-1</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(root);</span><br><span class="line">        <span class="built_in">dfs2</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">           æ ‡è®°æ¯ä¸ªç‚¹çš„æ·±åº¦dep[]</span></span><br><span class="line"><span class="comment">           æ ‡è®°æ¯ä¸ªç‚¹çš„çˆ¶äº²parent[]</span></span><br><span class="line"><span class="comment">           æ ‡è®°æ¯ä¸ªéå¶å­èŠ‚ç‚¹çš„å­æ ‘å¤§å°(å«å®ƒè‡ªå·±)</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span> (parent[u] != <span class="number">-1</span>) &#123;</span><br><span class="line">            adj[u].<span class="built_in">erase</span>(<span class="built_in">find</span>(adj[u].<span class="built_in">begin</span>(), adj[u].<span class="built_in">end</span>(), parent[u]));</span><br><span class="line">        &#125;</span><br><span class="line">        siz[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;v : adj[u]) &#123;</span><br><span class="line">            parent[v] = u;</span><br><span class="line">            dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">dfs1</span>(v);</span><br><span class="line">            siz[u] += siz[v];</span><br><span class="line">            <span class="keyword">if</span> (siz[v] &gt; siz[adj[u][<span class="number">0</span>]]) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(v, adj[u][<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        in[u] = cur++;</span><br><span class="line">        seq[in[u]] = u;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> v : adj[u]) &#123;</span><br><span class="line">            top[v] = v == adj[u][<span class="number">0</span>] ? top[u] : v;</span><br><span class="line">            <span class="built_in">dfs2</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">        out[u] = cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (top[u] != top[v]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dep[top[u]] &gt; dep[top[v]]) &#123;</span><br><span class="line">                u = parent[top[u]];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                v = parent[top[v]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dep[u] &lt; dep[v] ? u : v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">dist</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è¿”å›ä¸¤ç‚¹çš„è·ç¦»</span></span><br><span class="line">        <span class="keyword">return</span> dep[u] + dep[v] - <span class="number">2</span> * dep[<span class="built_in">lca</span>(u, v)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">jump</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å‘ä¸Šè·³kæ­¥ï¼Œè¿”å›è·³è·ƒåçš„èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (dep[u] &lt; k) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> d = dep[u] - k;</span><br><span class="line">        <span class="keyword">while</span> (dep[top[u]] &gt; d) &#123;</span><br><span class="line">            u = parent[top[u]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> seq[in[u] - dep[u] + d];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isAncester</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­uæ˜¯å¦æ˜¯vçš„ç¥–å…ˆ</span></span><br><span class="line">        <span class="keyword">return</span> in[u] &lt;= in[v] &amp;&amp; in[v] &lt; out[u];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">rootedParent</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            åœ¨ä»¥uä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œæ‰¾åˆ°vçš„ç›´æ¥çˆ¶èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="built_in">swap</span>(u, v);</span><br><span class="line">        <span class="keyword">if</span> (u == v) &#123;</span><br><span class="line">            <span class="keyword">return</span> u;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">isAncester</span>(u, v)) &#123;</span><br><span class="line">            <span class="keyword">return</span> parent[u];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> it = <span class="built_in">upper_bound</span>(adj[u].<span class="built_in">begin</span>(), adj[u].<span class="built_in">end</span>(), v, [&amp;](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">            <span class="keyword">return</span> in[x] &lt; in[y];</span><br><span class="line">        &#125;) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> *it;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">rootedSize</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * åœ¨ä»¥uä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œè®¡ç®—ä»¥vä¸ºæ ¹çš„å­æ ‘çš„å¤§å°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (u == v) &#123;</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">isAncester</span>(v, u)) &#123;</span><br><span class="line">            <span class="keyword">return</span> siz[v];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n - siz[<span class="built_in">rootedParent</span>(u, v)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">rootedLca</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">lca</span>(a, b) ^ <span class="built_in">lca</span>(b, c) ^ <span class="built_in">lca</span>(c, a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="æ ‘ç›¸å…³"><a href="#æ ‘ç›¸å…³" class="headerlink" title="æ ‘ç›¸å…³"></a>æ ‘ç›¸å…³</h2><h3 id="æ ‘çš„ç›´å¾„"><a href="#æ ‘çš„ç›´å¾„" class="headerlink" title="æ ‘çš„ç›´å¾„"></a>æ ‘çš„ç›´å¾„</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; ver;</span><br><span class="line">    <span class="built_in">Tree</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        ver.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        ver[x].<span class="built_in">push_back</span>(y);</span><br><span class="line">        ver[y].<span class="built_in">push_back</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> root)</span> </span>&#123; <span class="comment">// è·å–xæ‰€åœ¨æ ‘çš„ç›´å¾„</span></span><br><span class="line">        map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; dep; <span class="comment">// mapç”¨äºä¼˜åŒ–è¾“å…¥ä¸ºæ£®æ—æ—¶çš„æ·±åº¦è®¡ç®—ï¼Œäº¦å¯ç”¨vector</span></span><br><span class="line">        function&lt;<span class="type">void</span>(<span class="type">int</span>, <span class="type">int</span>)&gt; dfs = [&amp;](<span class="type">int</span> x, <span class="type">int</span> fa) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> y : ver[x]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">                dep[y] = dep[x] + <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">dfs</span>(y, x);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (dep[x] &gt; dep[root]) &#123;</span><br><span class="line">                root = x;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">dfs</span>(root, <span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> st = root; <span class="comment">// è®°å½•ç›´å¾„ç«¯ç‚¹</span></span><br><span class="line">        </span><br><span class="line">        dep.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">dfs</span>(root, <span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> ed = root; <span class="comment">// è®°å½•ç›´å¾„å¦ä¸€ç«¯ç‚¹</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> dep[root];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æ ‘è®ºå¤§å°è£…"><a href="#æ ‘è®ºå¤§å°è£…" class="headerlink" title="æ ‘è®ºå¤§å°è£…"></a>æ ‘è®ºå¤§å°è£…</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;&gt; e;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dep, parent, maxdep, d1, d2, s1, s2, up;</span><br><span class="line">    <span class="built_in">Tree</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        e.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        dep.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        parent.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        maxdep.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        d<span class="number">1.</span><span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        d<span class="number">2.</span><span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        s<span class="number">1.</span><span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        s<span class="number">2.</span><span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        up.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">        e[u].<span class="built_in">push_back</span>(&#123;w, v&#125;);</span><br><span class="line">        e[v].<span class="built_in">push_back</span>(&#123;w, u&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">        maxdep[u] = dep[u];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> [w, v] : e[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">            dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">            parent[v] = u;</span><br><span class="line">            <span class="built_in">dfs</span>(v, u);</span><br><span class="line">            maxdep[u] = <span class="built_in">max</span>(maxdep[u], maxdep[v]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> [w, v] : e[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">dfs1</span>(v, u);</span><br><span class="line">            <span class="type">int</span> x = d1[v] + w;</span><br><span class="line">            <span class="keyword">if</span> (x &gt; d1[u]) &#123;</span><br><span class="line">                d2[u] = d1[u], s2[u] = s1[u];</span><br><span class="line">                d1[u] = x, s1[u] = v;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (x &gt; d2[u]) &#123;</span><br><span class="line">                d2[u] = x, s2[u] = v;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> [w, v] : e[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (s1[u] == v) &#123;</span><br><span class="line">                up[v] = <span class="built_in">max</span>(up[u], d2[u]) + w;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                up[v] = <span class="built_in">max</span>(up[u], d1[u]) + w;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">dfs2</span>(v, u);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> radius, center, diam;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getCenter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        center = <span class="number">1</span>; <span class="comment">//ä¸­å¿ƒ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">max</span>(d1[i], up[i]) &lt; <span class="built_in">max</span>(d1[center], up[center])) &#123;</span><br><span class="line">                center = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        radius = <span class="built_in">max</span>(d1[center], up[center]); <span class="comment">//è·ç¦»æœ€è¿œç‚¹çš„è·ç¦»çš„æœ€å°å€¼</span></span><br><span class="line">        diam = d1[center] + up[center] + <span class="number">1</span>; <span class="comment">//ç›´å¾„</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> rem; <span class="comment">//åˆ é™¤é‡å¿ƒåå‰©ä½™è¿é€šå—ä½“ç§¯çš„æœ€å°å€¼</span></span><br><span class="line">    <span class="type">int</span> cog; <span class="comment">//é‡å¿ƒ</span></span><br><span class="line">    vector&lt;<span class="type">bool</span>&gt; vis;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getCog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        vis.<span class="built_in">resize</span>(n);</span><br><span class="line">        rem = INT_MAX;</span><br><span class="line">        cog = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfsCog</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">dfsCog</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        vis[u] = <span class="literal">true</span>;</span><br><span class="line">        <span class="type">int</span> s = <span class="number">1</span>, res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> [w, v] : e[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[v]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> t = <span class="built_in">dfsCog</span>(v);</span><br><span class="line">            res = <span class="built_in">max</span>(res, t);</span><br><span class="line">            s += t;</span><br><span class="line">        &#125;</span><br><span class="line">        res = <span class="built_in">max</span>(res, n - s);</span><br><span class="line">        <span class="keyword">if</span> (res &lt; rem) &#123;</span><br><span class="line">            rem = res;</span><br><span class="line">            cog = u;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="æœ€å°ç”Ÿæˆæ ‘-MST"><a href="#æœ€å°ç”Ÿæˆæ ‘-MST" class="headerlink" title="æœ€å°ç”Ÿæˆæ ‘(MST)"></a>æœ€å°ç”Ÿæˆæ ‘(MST)</h2><p>Minimum Spanning Tree</p>
<h3 id="Prim-ç¨€ç–å›¾"><a href="#Prim-ç¨€ç–å›¾" class="headerlink" title="Prim(ç¨€ç–å›¾)"></a>Prim(ç¨€ç–å›¾)</h3><p>ä½¿ç”¨é‚»æ¥çŸ©é˜µå­˜å›¾ï¼Œä»¥ O($N^2+M$)çš„å¤æ‚åº¦è®¡ç®—ï¼Œæ€æƒ³ä¸djikstra åŸºæœ¬ä¸€è‡´ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">550</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m, g[N][N];</span><br><span class="line"><span class="type">int</span> d[N], v[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">prim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">ms</span>(d, <span class="number">0x3f</span>); <span class="comment">//è¿™é‡Œçš„dè¡¨ç¤ºåˆ°â€œæœ€å°ç”Ÿæˆæ ‘é›†åˆâ€çš„è·ç¦»</span></span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++ i) &#123; <span class="comment">//éå† n è½®</span></span><br><span class="line">        <span class="type">int</span> t = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (v[j] == <span class="number">0</span> &amp;&amp; (t == <span class="number">-1</span> || d[j] &lt; d[t])) <span class="comment">//å¦‚æœè¿™ä¸ªç‚¹ä¸åœ¨é›†åˆå†…ä¸”å½“å‰è·ç¦»é›†åˆæœ€è¿‘</span></span><br><span class="line">                t = j;</span><br><span class="line">        v[t] = <span class="number">1</span>; <span class="comment">//å°†tåŠ å…¥â€œæœ€å°ç”Ÿæˆæ ‘é›†åˆâ€</span></span><br><span class="line">        <span class="keyword">if</span> (i &amp;&amp; d[t] == INF) <span class="keyword">return</span> INF; <span class="comment">//å¦‚æœå‘ç°ä¸è¿é€šï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (i) ans += d[t];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++ j) d[j] = <span class="built_in">min</span>(d[j], g[t][j]); <span class="comment">//ç”¨tæ›´æ–°å…¶ä»–ç‚¹åˆ°é›†åˆçš„è·ç¦»</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">ms</span>(g, <span class="number">0x3f</span>); cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">while</span> (m -- ) &#123;</span><br><span class="line">        <span class="type">int</span> x, y, w; cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class="line">        g[x][y] = g[y][x] = <span class="built_in">min</span>(g[x][y], w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">prim</span>();</span><br><span class="line">    <span class="keyword">if</span> (t == INF) cout &lt;&lt; <span class="string">&quot;impossible&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; t &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Kruskal-ç¨ å¯†å›¾"><a href="#Kruskal-ç¨ å¯†å›¾" class="headerlink" title="Kruskal(ç¨ å¯†å›¾)"></a>Kruskal(ç¨ å¯†å›¾)</h3><p>å¹³å‡æ—¶é—´å¤æ‚åº¦O(MlogM)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">DSU</span> &#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; fa;</span><br><span class="line">    <span class="built_in">DSU</span>(<span class="type">int</span> n) : <span class="built_in">fa</span>(n + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">iota</span>(fa.<span class="built_in">begin</span>(), fa.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (x != fa[x]) &#123;</span><br><span class="line">            x = fa[x] = fa[fa[x]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; <span class="comment">// è®¾xæ˜¯yçš„ç¥–å…ˆ</span></span><br><span class="line">        x = <span class="built_in">get</span>(x), y = <span class="built_in">get</span>(y);</span><br><span class="line">        <span class="keyword">if</span> (x == y) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        fa[y] = x;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">same</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">get</span>(x) == <span class="built_in">get</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span> &#123;</span><br><span class="line">    <span class="keyword">using</span> TII = tuple&lt;<span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    priority_queue&lt;TII, vector&lt;TII&gt;, greater&lt;TII&gt;&gt; ver;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Tree</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">        ver.<span class="built_in">emplace</span>(w, x, y); <span class="comment">// æ³¨æ„é¡ºåº</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">kruskal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="function">DSU <span class="title">dsu</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (ver.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="keyword">auto</span> [w, x, y] = ver.<span class="built_in">top</span>();</span><br><span class="line">            ver.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (dsu.<span class="built_in">same</span>(x, y)) <span class="keyword">continue</span>;</span><br><span class="line">            dsu.<span class="built_in">merge</span>(x, y);</span><br><span class="line">            ans += w;</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">assert</span>(cnt &lt; n - <span class="number">1</span>); <span class="comment">// è¾“å…¥æœ‰è¯¯ï¼Œå»ºæ ‘å¤±è´¥</span></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Kruskal-é‡æ„æ ‘"><a href="#Kruskal-é‡æ„æ ‘" class="headerlink" title="Kruskal é‡æ„æ ‘"></a>Kruskal é‡æ„æ ‘</h2>]]></content>
      <categories>
        <category>XCPC</category>
        <category>XCPCæ¨¡æ¿</category>
        <category>XCPCå›¾è®º</category>
      </categories>
      <tags>
        <tag>HLD</tag>
        <tag>SSSP</tag>
        <tag>APSP</tag>
        <tag>Bipartite Graph</tag>
        <tag>Cut point</tag>
        <tag>SCC</tag>
        <tag>BCC</tag>
        <tag>EBCC</tag>
        <tag>Tree</tag>
        <tag>MST</tag>
        <tag>Kruskal</tag>
        <tag>Dijkstral</tag>
        <tag>Bellman ford</tag>
        <tag>SPFA</tag>
        <tag>Floyd</tag>
      </tags>
  </entry>
  <entry>
    <title>XCPCæ‚é¡¹</title>
    <url>/2024/09/11/XCPC/XCPC%E6%A8%A1%E6%9D%BF/XCPC/XCPC%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<p>ä»‹ç»XCPCèµ›äº‹ä¸­çš„æ‚é¡¹çŸ¥è¯†ç‚¹</p>
<span id="more"></span>

<h1 id="XCPC-åŸºç¡€"><a href="#XCPC-åŸºç¡€" class="headerlink" title="XCPC åŸºç¡€"></a>XCPC åŸºç¡€</h1><h2 id="å¯¹æ‹æ¿å­"><a href="#å¯¹æ‹æ¿å­" class="headerlink" title="å¯¹æ‹æ¿å­"></a>å¯¹æ‹æ¿å­</h2><p>ä»‹ç»Windowsç¯å¢ƒä¸‹ä¸Linuxç¯å¢ƒä¸‹çš„å¯¹æ‹</p>
<p>å¯¹æ‹å»DEV</p>
<h3 id="Windowsç¯å¢ƒ"><a href="#Windowsç¯å¢ƒ" class="headerlink" title="Windowsç¯å¢ƒ"></a>Windowsç¯å¢ƒ</h3><p>ä»¥DEVä¸ºä¾‹ï¼Œé¦–å…ˆå»ºå››ä¸ªæºä»£ç åˆ°ä¸€ä¸ªæ–°å»ºæ–‡ä»¶å¤¹ä¸­ï¼Œæºä»£ç åˆ†åˆ«å‘½åä¸ºwa.cpp,data.cpp,violent.cpp,windows.cpp,é™¤æ­¤ä¹‹å¤–ä»€ä¹ˆä¹Ÿä¸éœ€è¦æ·»åŠ </p>
<ol>
<li>ä¸€ä»½é”™è¯¯çš„&#x2F;éœ€è¦æ¯”å¯¹çš„ä»£ç ï¼Œå¯¼å…¥wa.cpp</li>
<li>ä¸€ä»½æš´åŠ›çš„&#x2F;ç”¨æ¥æ¯”å¯¹çš„ä»£ç ï¼Œå¯¼å…¥violent.cpp</li>
<li>ä¸€ä»½ç”¨æ¥é€ æ•°æ®çš„ä»£ç </li>
<li>ä¸€ä»½æ‰§è¡Œå¯¹æ‹ç¨‹åºçš„ä»£ç </li>
</ol>
<h4 id="wa-cpp"><a href="#wa-cpp" class="headerlink" title="wa.cpp"></a>wa.cpp</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;in.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin); <span class="comment">//è¯»å…¥æ•°æ®ç”Ÿæˆå™¨é€ å‡ºæ¥çš„æ•°æ®</span></span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;wa.txt&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout); <span class="comment">//è¾“å‡ºç­”æ¡ˆ</span></span><br><span class="line">	<span class="comment">//ä¸‹æ–¹æ³¨é‡Šä¸ºä½ çš„ç¨‹åº</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">	int a, b;</span></span><br><span class="line"><span class="comment">	cin &gt;&gt; a &gt;&gt; b;</span></span><br><span class="line"><span class="comment">	cout &lt;&lt; a;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="violent-cpp"><a href="#violent-cpp" class="headerlink" title="violent.cpp"></a>violent.cpp</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;in.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);      <span class="comment">//è¯»å…¥æ•°æ®ç”Ÿæˆå™¨é€ å‡ºæ¥çš„æ•°æ®</span></span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;violent.txt&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout); <span class="comment">//è¾“å‡ºç­”æ¡ˆ</span></span><br><span class="line">	<span class="comment">//ä¸‹æ–¹ç¨‹åºä¸ºä½ å·²ç»å¯¼å…¥çš„ç¨‹åº</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">	int a, b;</span></span><br><span class="line"><span class="comment">	cin &gt;&gt; a &gt;&gt; b;</span></span><br><span class="line"><span class="comment">	cout &lt;&lt; a + b;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="data-cpp"><a href="#data-cpp" class="headerlink" title="data.cpp"></a>data.cpp</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">_timeb</span> T;</span><br><span class="line">	_ftime(&amp;T);</span><br><span class="line">	<span class="built_in">srand</span>(T.millitm); <span class="comment">//è·å¾—æ¯«ç§’ï¼Œå‡å°è¿è¡Œæ—¶é—´</span></span><br><span class="line">	<span class="type">int</span> a = <span class="built_in">rand</span>(); <span class="comment">//æ­¤æ—¶aæ˜¯ä¸€ä¸ªéšæœºæ•°å­—</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="windows-cpp"><a href="#windows-cpp" class="headerlink" title="windows.cpp"></a>windows.cpp</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123; <span class="comment">//ä¸€ç›´å¾ªç¯ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ä¸€æ ·çš„æ•°æ®</span></span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;data.exe&quot;</span>);</span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;violent.exe&quot;</span>);</span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;wa.exe&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">system</span>(<span class="string">&quot;fc wa.txt violent.txt&quot;</span>)) <span class="comment">//å½“ fc è¿”å› 1 æ—¶ï¼Œè¯´æ˜è¿™æ—¶æ•°æ®ä¸ä¸€æ ·</span></span><br><span class="line">			<span class="keyword">break</span>;                          <span class="comment">//ä¸ä¸€æ ·å°±è·³å‡ºå¾ªç¯</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ï¼Œä»¥ä¸Šæ‰€æœ‰ç¨‹åºå‡éœ€è¦ç¼–è¯‘å¹¶è¿è¡Œ</strong></p>
<h2 id="å‰ç¼€å’Œ-Prefix-Sum"><a href="#å‰ç¼€å’Œ-Prefix-Sum" class="headerlink" title="å‰ç¼€å’Œ(Prefix Sum)"></a>å‰ç¼€å’Œ(Prefix Sum)</h2><p>é€šè¿‡æ„å»ºå‰ç¼€å’Œæ•°ç»„ï¼Œä»è€Œèƒ½åšåˆ°O(1)æ—¶é—´å¤æ‚åº¦çš„åŒºé—´æŸ¥è¯¢(rangeQuery)</p>
<h3 id="ä¸€ç»´å‰ç¼€å’Œ"><a href="#ä¸€ç»´å‰ç¼€å’Œ" class="headerlink" title="ä¸€ç»´å‰ç¼€å’Œ"></a>ä¸€ç»´å‰ç¼€å’Œ</h3><h4 id="æ„å»ºå‰ç¼€å’Œæ•°ç»„"><a href="#æ„å»ºå‰ç¼€å’Œæ•°ç»„" class="headerlink" title="æ„å»ºå‰ç¼€å’Œæ•°ç»„"></a>æ„å»ºå‰ç¼€å’Œæ•°ç»„</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt;<span class="built_in">pre</span>(n<span class="number">+1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) pre[i]=pre[i<span class="number">-1</span>]+a[i];</span><br></pre></td></tr></table></figure>

<h4 id="rangeQuery"><a href="#rangeQuery" class="headerlink" title="rangeQuery"></a>rangeQuery</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">pre[r]-pre[l<span class="number">-1</span>]<span class="comment">//æ±‚(l,r)åŒºé—´å’Œ</span></span><br></pre></td></tr></table></figure>

<h3 id="äºŒç»´å‰ç¼€å’Œ"><a href="#äºŒç»´å‰ç¼€å’Œ" class="headerlink" title="äºŒç»´å‰ç¼€å’Œ"></a>äºŒç»´å‰ç¼€å’Œ</h3><h4 id="æ„å»ºå‰ç¼€å’Œæ•°ç»„-1"><a href="#æ„å»ºå‰ç¼€å’Œæ•°ç»„-1" class="headerlink" title="æ„å»ºå‰ç¼€å’Œæ•°ç»„"></a>æ„å»ºå‰ç¼€å’Œæ•°ç»„</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;<span class="built_in">pre</span>(n<span class="number">+1</span>,<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(m<span class="number">+1</span>));</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;j++)&#123;</span><br><span class="line">        pre[i][j]=pre[i<span class="number">-1</span>][j]+pre[i][j<span class="number">-1</span>]-pre[i<span class="number">-1</span>][j<span class="number">-1</span>]+a[i][j];</span><br><span class="line">        <span class="comment">//pre[i][j]è¡¨ç¤º(1,1)ä¸ºå·¦ä¸Šè§’,(i,j)ä¸ºå³ä¸‹è§’çš„çŸ©é˜µçš„å’Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="rangeQuery-1"><a href="#rangeQuery-1" class="headerlink" title="rangeQuery"></a>rangeQuery</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">pre[x2][y2]-pre[x2][y1<span class="number">-1</span>]-pre[x1<span class="number">-1</span>][y2]+pre[x1<span class="number">-1</span>][y1<span class="number">-1</span>];</span><br><span class="line"><span class="comment">//æ±‚å·¦ä¸Šè§’ä¸º(x1,y1)ï¼Œå³ä¸‹è§’ä¸º(x2,y2)çš„çŸ©é˜µå’Œ    </span></span><br></pre></td></tr></table></figure>

<h2 id="å·®åˆ†-Difference"><a href="#å·®åˆ†-Difference" class="headerlink" title="å·®åˆ†(Difference)"></a>å·®åˆ†(Difference)</h2><p>é€šè¿‡æ„å»ºå·®åˆ†æ•°ç»„ï¼Œä»è€Œèƒ½åšåˆ°O(1)æ—¶é—´å¤æ‚åº¦çš„åŒºé—´ä¿®æ”¹(rangeModify)</p>
<h3 id="ä¸€ç»´å·®åˆ†"><a href="#ä¸€ç»´å·®åˆ†" class="headerlink" title="ä¸€ç»´å·®åˆ†"></a>ä¸€ç»´å·®åˆ†</h3><ol>
<li>å•ç‚¹ä¿®æ”¹ï¼Œå•ç‚¹è¯¢é—®</li>
</ol>
<p>æ„å»ºå·®åˆ†æ•°ç»„</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt;<span class="built_in">dif</span>(n<span class="number">+5</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) dif[i]=a[i]-a[i<span class="number">-1</span>];</span><br></pre></td></tr></table></figure>

<p>rangeModify</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">dif[l]+=k;dif[r<span class="number">+1</span>]-=k;<span class="comment">//(l,r)åŒºé—´æ¯ä¸ªæ•°éƒ½åŠ k</span></span><br></pre></td></tr></table></figure>

<p>Query</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) b[i]+=b[i<span class="number">-1</span>];<span class="comment">//æ­¤æ—¶b[i]å°±æ˜¯ä¿®æ”¹å®Œåçš„ç¬¬iä¸ªæ•°çš„å€¼</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´è¯¢é—®</p>
<p>å…·ä½“å°±æ˜¯æ„å»ºä¸¤ä¸ªå·®åˆ†æ•°ç»„ï¼Œæ¯æ¬¡å•ç‚¹ä¿®æ”¹çš„å·¦ç«¯åŠ 1ï¼Œå³ç«¯ä¹ŸåŠ 1ï¼Œå…¨éƒ¨æ“ä½œæ‰§è¡Œå®Œæ±‚å‰ç¼€å’Œ,åŒºé—´è¯¢é—®[l,r]çš„æ—¶å€™ç›¸å‡å³å¯</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt;<span class="built_in">L</span>(n<span class="number">+10</span>),<span class="built_in">R</span>(n<span class="number">+10</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;k;i++)&#123;</span><br><span class="line">    <span class="type">int</span> u,v;cin&gt;&gt;u&gt;&gt;v;</span><br><span class="line">    L[u]++;R[v]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</span><br><span class="line">    L[i]+=L[i<span class="number">-1</span>];</span><br><span class="line">    R[i]+=R[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=k;i++)&#123;</span><br><span class="line">    <span class="type">int</span> l,r;cin&gt;&gt;l&gt;&gt;r;</span><br><span class="line">    cout&lt;&lt;R[r]-L[l<span class="number">-1</span>]&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="äºŒç»´å·®åˆ†"><a href="#äºŒç»´å·®åˆ†" class="headerlink" title="äºŒç»´å·®åˆ†"></a>äºŒç»´å·®åˆ†</h3><p>ä¸ä¸€ç»´å·®åˆ†ä¸åŒçš„æ˜¯ï¼ŒäºŒç»´å·®åˆ†æ•°ç»„çš„æ„å»ºä¸ä¿®æ”¹å‡å¯ä»¥é€šè¿‡å·®åˆ†å‡½æ•°æ¥å®Œæˆ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;<span class="built_in">dif</span>(n<span class="number">+5</span>,<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(m<span class="number">+5</span>));</span><br><span class="line"><span class="keyword">auto</span> modify=[&amp;](<span class="type">int</span> x1,<span class="type">int</span> y1,<span class="type">int</span> x2,<span class="type">int</span> y2,<span class="type">int</span> x)&#123;</span><br><span class="line">    dif[x1][y1]+=x;</span><br><span class="line">    dif[x1][y2<span class="number">+1</span>]-=x;</span><br><span class="line">    dif[x2<span class="number">+1</span>][y1]-=x;</span><br><span class="line">    dif[x2<span class="number">+1</span>][y2<span class="number">+1</span>]+=x;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="æ„å»ºå·®åˆ†æ•°ç»„"><a href="#æ„å»ºå·®åˆ†æ•°ç»„" class="headerlink" title="æ„å»ºå·®åˆ†æ•°ç»„"></a>æ„å»ºå·®åˆ†æ•°ç»„</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;j++)&#123;</span><br><span class="line">        <span class="built_in">modify</span>(i,j,i,j,a[i][j]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="rangeModify"><a href="#rangeModify" class="headerlink" title="rangeModify"></a>rangeModify</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">modify</span>(x1,y1,x2,y2,x);<span class="comment">//å¯¹å·¦ä¸Šè§’ä¸º(x1,y1),å³ä¸‹è§’ä¸º(x2,y2)çš„çŸ©é˜µæ¯ä¸ªæ•°éƒ½åŠ ä¸Šx</span></span><br></pre></td></tr></table></figure>

<h4 id="Query"><a href="#Query" class="headerlink" title="Query"></a>Query</h4><p>å‰ç¼€å’Œæ±‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;j++)&#123;</span><br><span class="line">        dif[i][j]+=dif[i<span class="number">-1</span>][j]+dif[i][j<span class="number">-1</span>]-dif[i<span class="number">-1</span>][j<span class="number">-1</span>];</span><br><span class="line">        <span class="comment">//pre[i][j]è¡¨ç¤º(1,1)ä¸ºå·¦ä¸Šè§’,(i,j)ä¸ºå³ä¸‹è§’çš„çŸ©é˜µçš„å’Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é—´éš”å·®åˆ†"><a href="#é—´éš”å·®åˆ†" class="headerlink" title="é—´éš”å·®åˆ†"></a>é—´éš”å·®åˆ†</h3><p>[l,r]ä¸­é—´éš”kä¸ªæ•°å­—ä¿®æ”¹ï¼Œå…¶ä¸­r&#x3D;l + k * n, ç›¸å½“äº[l,l+k,l+2 * k,â€¦ l + n * k]è¿™ä¹ˆå¤šæ•°ä¿®æ”¹</p>
<p>æ„å»ºå·®åˆ†æ•°ç»„</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">pre[l]++;pre[r]--;<span class="comment">//æ³¨æ„æ­¤æ—¶ä¸€å®šæ˜¯æœ€å³ä¾§çš„ç‚¹è¿›è¡Œå‡ï¼Œä¸æ˜¯æœ€å³è¾¹å‡ä¸€</span></span><br></pre></td></tr></table></figure>

<p>æ±‚å’Œ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=sum;i++)<span class="comment">//sumä¸ºæ•´ä¸ªæ•°ç»„å¤§èŒƒå›´,å†™æˆè¿™æ ·ï¼Œå³ä½¿å¤šæ¬¡ä¿®æ”¹åŒºé—´ä¹Ÿèƒ½åœ¨ä¸€æ¬¡éå†çš„æ—¶é—´é‡Œç®—å®Œ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=k;i&lt;=sum;i++)&#123;</span><br><span class="line">â€‹	pre[i]+=pre[i-k];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é«˜ç²¾åº¦"><a href="#é«˜ç²¾åº¦" class="headerlink" title="é«˜ç²¾åº¦"></a>é«˜ç²¾åº¦</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5005</span>;<span class="comment">//ä½æ•°</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">bign</span>&#123;</span><br><span class="line">    <span class="type">int</span> len, s[MAXN];</span><br><span class="line">    <span class="built_in">bign</span> ()&#123;  </span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">        <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="built_in">sizeof</span>(s));</span><br><span class="line">        len = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">bign</span> (<span class="type">int</span> num) &#123; *<span class="keyword">this</span> = num; &#125;</span><br><span class="line">    <span class="built_in">bign</span> (<span class="type">const</span> <span class="type">char</span> *num) &#123; *<span class="keyword">this</span> = num; &#125;  <span class="comment">//è®©thisæŒ‡é’ˆæŒ‡å‘å½“å‰å­—ç¬¦ä¸²</span></span><br><span class="line">    bign <span class="keyword">operator</span> = (<span class="type">const</span> <span class="type">int</span> num)&#123;</span><br><span class="line">        <span class="type">char</span> s[MAXN];</span><br><span class="line">        <span class="built_in">sprintf</span>(s, <span class="string">&quot;%d&quot;</span>, num);  <span class="comment">//sprintfå‡½æ•°å°†æ•´å‹æ˜ åˆ°å­—ç¬¦ä¸²ä¸­</span></span><br><span class="line">        *<span class="keyword">this</span> = s;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;  <span class="comment">//å†å°†å­—ç¬¦ä¸²è½¬åˆ°ä¸‹é¢å­—ç¬¦ä¸²è½¬åŒ–çš„å‡½æ•°ä¸­</span></span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> = (<span class="type">const</span> <span class="type">char</span> *num)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; num[i] == <span class="string">&#x27;0&#x27;</span>; num++) ;  <span class="comment">//å»å‰å¯¼0</span></span><br><span class="line">        len = <span class="built_in">strlen</span>(num);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) s[i] = num[len-i<span class="number">-1</span>] - <span class="string">&#x27;0&#x27;</span>; <span class="comment">//åç€å­˜</span></span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> + (<span class="type">const</span> bign &amp;b) <span class="type">const</span>&#123; </span><br><span class="line">    <span class="comment">//å¯¹åº”ä½ç›¸åŠ ï¼Œæœ€ä¸ºç®€å•</span></span><br><span class="line">        bign c;</span><br><span class="line">        c.len = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, g = <span class="number">0</span>; g || i &lt; <span class="built_in">max</span>(len, b.len); i++)&#123;</span><br><span class="line">            <span class="type">int</span> x = g;</span><br><span class="line">            <span class="keyword">if</span>(i &lt; len) x += s[i];</span><br><span class="line">            <span class="keyword">if</span>(i &lt; b.len) x += b.s[i];</span><br><span class="line">            c.s[c.len++] = x % <span class="number">10</span>;  <span class="comment">//å…³äºåŠ æ³•è¿›ä½</span></span><br><span class="line">            g = x / <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> += (<span class="type">const</span> bign &amp;b)&#123;</span><br><span class="line">        <span class="comment">//å¦‚ä¸Šæ–‡æ‰€è¯´ï¼Œæ­¤ç±»è¿ç®—ç¬¦çš†å¦‚æ­¤é‡è½½</span></span><br><span class="line">        *<span class="keyword">this</span> = *<span class="keyword">this</span> + b;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clean</span><span class="params">()</span></span>&#123;  </span><br><span class="line">    <span class="comment">//ç”±äºæ¥ä¸‹æ¥çš„è¿ç®—ä¸èƒ½ç¡®å®šç»“æœçš„é•¿åº¦ï¼Œå…ˆå¤§è€Œä¼°ä¹‹ç„¶åå†æŸ¥</span></span><br><span class="line">        <span class="keyword">while</span>(len &gt; <span class="number">1</span> &amp;&amp; !s[len<span class="number">-1</span>]) len--;  <span class="comment">//é¦–ä½éƒ¨åˆ†â€˜0â€™æ•…åˆ é™¤è¯¥éƒ¨åˆ†é•¿åº¦</span></span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> * (<span class="type">const</span> bign &amp;b)&#123; </span><br><span class="line">    <span class="comment">//ä¹˜æ³•é‡è½½åœ¨äºåˆ—ç«–å¼ï¼Œå†å°†ç«–å¼ä¸­çš„æ•°è½¬ä¸ºæŠ½è±¡ï¼Œå³å¯çœ‹å‡ºè¿ç®—æ³•åˆ™ã€‚</span></span><br><span class="line">        bign c;</span><br><span class="line">        c.len = len + b.len;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; b.len; j++)&#123;</span><br><span class="line">                c.s[i+j] += s[i] * b.s[j];<span class="comment">//ä¸å¦¨åˆ—ä¸ªç«–å¼çœ‹ä¸€çœ‹</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; c.len; i++)&#123; </span><br><span class="line">            <span class="comment">//å…³äºè¿›ä½ï¼Œä¸åŠ æ³•æ„åŒ</span></span><br><span class="line">            c.s[i<span class="number">+1</span>] += c.s[i]/<span class="number">10</span>;</span><br><span class="line">            c.s[i] %= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        c.<span class="built_in">clean</span>();  <span class="comment">//æˆ‘ä»¬ä¼°çš„ä½æ•°æ˜¯a+bçš„é•¿åº¦å’Œï¼Œä½†å¯èƒ½æ¯”å®ƒå°ï¼ˆ1*1 = 1ï¼‰</span></span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> *= (<span class="type">const</span> bign &amp;b)&#123;</span><br><span class="line">        *<span class="keyword">this</span> = *<span class="keyword">this</span> * b;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> - (<span class="type">const</span> bign &amp;b)&#123;  </span><br><span class="line">    <span class="comment">//å¯¹åº”ä½ç›¸å‡ï¼ŒåŠ æ³•çš„è¿›ä½æ”¹ä¸ºå€Ÿ1</span></span><br><span class="line">        <span class="comment">//ä¸è€ƒè™‘è´Ÿæ•°</span></span><br><span class="line">        bign c;</span><br><span class="line">        c.len = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, g = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">            <span class="type">int</span> x = s[i] - g;</span><br><span class="line">            <span class="keyword">if</span>(i &lt; b.len) x -= b.s[i];  <span class="comment">//å¯èƒ½é•¿åº¦ä¸ç­‰</span></span><br><span class="line">            <span class="keyword">if</span>(x &gt;= <span class="number">0</span>) g = <span class="number">0</span>;  <span class="comment">//æ˜¯å¦å‘ä¸Šç§»ä½å€Ÿ1</span></span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                g = <span class="number">1</span>;</span><br><span class="line">                x += <span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            c.s[c.len++] = x;</span><br><span class="line">        &#125;</span><br><span class="line">        c.<span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> -= (<span class="type">const</span> bign &amp;b)&#123;</span><br><span class="line">        *<span class="keyword">this</span> = *<span class="keyword">this</span> - b;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> / (<span class="type">const</span> bign &amp;b) &#123;</span><br><span class="line">    <span class="comment">//è¿ç”¨é™¤æ˜¯å‡çš„æœ¬è´¨ï¼Œä¸åœåœ°å‡ï¼Œç›´åˆ°å°äºè¢«å‡æ•°</span></span><br><span class="line">        bign c, f = <span class="number">0</span>; <span class="comment">//å¯èƒ½ä¼šåœ¨ä½¿ç”¨å‡æ³•æ—¶å‡ºç°é«˜ç²¾åº¦è¿ç®—</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = len<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--)&#123;  </span><br><span class="line">            <span class="comment">//æ­£å¸¸é¡ºåºï¼Œä»æœ€é«˜ä½å¼€å§‹</span></span><br><span class="line">            f = f*<span class="number">10</span>;  <span class="comment">//ä¸Šé¢ä½çš„å‰©ä½™åˆ°ä¸‹ä¸€ä½*10</span></span><br><span class="line">            f.s[<span class="number">0</span>] = s[i];  <span class="comment">//åŠ ä¸Šå½“å‰ä½</span></span><br><span class="line">            <span class="keyword">while</span>(f &gt;= b)&#123;</span><br><span class="line">                f -= b;</span><br><span class="line">                c.s[i]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        c.len = len;  <span class="comment">//ä¼°æœ€é•¿ä½</span></span><br><span class="line">        c.<span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> /= (<span class="type">const</span> bign &amp;b)&#123;</span><br><span class="line">        *<span class="keyword">this</span>  = *<span class="keyword">this</span> / b;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> % (<span class="type">const</span> bign &amp;b)&#123;  </span><br><span class="line">    <span class="comment">//å–æ¨¡å°±æ˜¯é™¤å®Œå‰©ä¸‹çš„</span></span><br><span class="line">        bign r = *<span class="keyword">this</span> / b;</span><br><span class="line">        r = *<span class="keyword">this</span> - r*b;</span><br><span class="line">        r.<span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> %= (<span class="type">const</span> bign &amp;b)&#123;</span><br><span class="line">        *<span class="keyword">this</span> = *<span class="keyword">this</span> % b;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> bign &amp;b)&#123; </span><br><span class="line">    <span class="comment">//å­—ç¬¦ä¸²æ¯”è¾ƒåŸç†</span></span><br><span class="line">        <span class="keyword">if</span>(len != b.len) <span class="keyword">return</span> len &lt; b.len;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = len<span class="number">-1</span>; i != <span class="number">-1</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i] != b.s[i]) <span class="keyword">return</span> s[i] &lt; b.s[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &gt; (<span class="type">const</span> bign &amp;b)&#123;  </span><br><span class="line">    <span class="comment">//åŒç†</span></span><br><span class="line">        <span class="keyword">if</span>(len != b.len) <span class="keyword">return</span> len &gt; b.len;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = len<span class="number">-1</span>; i != <span class="number">-1</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i] != b.s[i]) <span class="keyword">return</span> s[i] &gt; b.s[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> == (<span class="type">const</span> bign &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> !(*<span class="keyword">this</span> &gt; b) &amp;&amp; !(*<span class="keyword">this</span> &lt; b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> != (<span class="type">const</span> bign &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> !(*<span class="keyword">this</span> == b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt;= (<span class="type">const</span> bign &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span> &lt; b || *<span class="keyword">this</span> == b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &gt;= (<span class="type">const</span> bign &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span> &gt; b || *<span class="keyword">this</span> == b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">()</span> <span class="type">const</span></span>&#123;  </span><br><span class="line">    <span class="comment">//å°†ç»“æœè½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼ˆç”¨äºè¾“å‡ºï¼‰</span></span><br><span class="line">        string res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) res = <span class="built_in">char</span>(s[i]+<span class="string">&#x27;0&#x27;</span>)+res;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">istream&amp; <span class="keyword">operator</span> &gt;&gt; (istream &amp;in, bign &amp;x)&#123;</span><br><span class="line"><span class="comment">//é‡è½½è¾“å…¥æµ</span></span><br><span class="line">    string s;</span><br><span class="line">    in &gt;&gt; s;</span><br><span class="line">    x = s.<span class="built_in">c_str</span>();  <span class="comment">//stringè½¬åŒ–ä¸ºchar[]</span></span><br><span class="line">    <span class="keyword">return</span> in;</span><br><span class="line">&#125;</span><br><span class="line">ostream&amp; <span class="keyword">operator</span> &lt;&lt; (ostream &amp;out, <span class="type">const</span> bign &amp;x)&#123;  </span><br><span class="line"><span class="comment">//é‡è½½è¾“å‡ºæµ</span></span><br><span class="line">    out &lt;&lt; x.<span class="built_in">str</span>();</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å£°æ˜æ–¹å¼"><a href="#å£°æ˜æ–¹å¼" class="headerlink" title="å£°æ˜æ–¹å¼"></a>å£°æ˜æ–¹å¼</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">bign a;<span class="comment">//é™¤äº†å£°æ˜å¤–å…¶ä»–å¦‚æ•´å‹èˆ¬ä½¿ç”¨</span></span><br><span class="line">    a=<span class="string">&quot;333333333333333333333333333&quot;</span>;</span><br><span class="line">    cout&lt;&lt;a*a&lt;&lt;endl;</span><br></pre></td></tr></table></figure>

<h2 id="STL"><a href="#STL" class="headerlink" title="STL"></a>STL</h2><h3 id="sqrt"><a href="#sqrt" class="headerlink" title="sqrt"></a>sqrt</h3><p>å¯¹long longä½¿ç”¨sqrtï¼Œç±»å‹è½¬æ¢ä¸ºlong double</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">x=(<span class="type">long</span> <span class="type">double</span>)<span class="built_in">sqrt</span>(x);<span class="comment">//xä¸ºlong longç±»å‹</span></span><br></pre></td></tr></table></figure>

<h3 id="pdbs"><a href="#pdbs" class="headerlink" title="pdbs"></a>pdbs</h3><p>å¤´æ–‡ä»¶åŠå‘½åç©ºé—´ï¼Œæ³¨æ„ç¼–è¯‘å™¨å¼€g++</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/extc++.h&gt;</span> <span class="comment">//ç±»ä¼¼ä¸‡èƒ½å¤´ï¼ŒåŒ…å«å¤§å¤šæ‰©å±•åº“</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br></pre></td></tr></table></figure>

<h4 id="å †-ä¼˜å…ˆé˜Ÿåˆ—"><a href="#å †-ä¼˜å…ˆé˜Ÿåˆ—" class="headerlink" title="å †(ä¼˜å…ˆé˜Ÿåˆ—)"></a>å †(ä¼˜å…ˆé˜Ÿåˆ—)</h4><h3 id="é˜²å¡unordered-map"><a href="#é˜²å¡unordered-map" class="headerlink" title="é˜²å¡unordered_map"></a>é˜²å¡unordered_map</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;mp;</span><br><span class="line">mp.<span class="built_in">reserve</span>(<span class="number">1024</span>);</span><br><span class="line">mp.<span class="built_in">max_load_factor</span>(<span class="number">0.25</span>);</span><br></pre></td></tr></table></figure>



<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="number">1.f</span>indï¼ˆstrï¼Œposï¼‰<span class="comment">//æ‰¾åˆ°çš„è¿”å›ä¸‹æ ‡ï¼Œæ‰¾ä¸åˆ°è¿”å›stringï¼šï¼šnpos</span></span><br><span class="line"><span class="number">2.</span>count<span class="comment">//ï¼ˆèµ·å§‹ä½ï¼Œç»ˆæ­¢ä½ï¼Œç›®æ ‡ç‰©ï¼‰</span></span><br><span class="line"><span class="number">3.</span><span class="built_in">getline</span>(cin,s)<span class="comment">//æ•´è¡Œè¯»å…¥ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨å­—ç¬¦ä¸²sé‡Œé¢</span></span><br><span class="line"><span class="number">4.</span>s.<span class="built_in">erase</span>(pos,n)<span class="comment">//æŠŠå­—ç¬¦ä¸²sä»poså¼€å§‹çš„nä¸ªå­—ç¬¦åˆ é™¤</span></span><br><span class="line"><span class="number">5.</span><span class="function">mt19937_64 <span class="title">rng</span><span class="params">(chrono::steady_clock::now().time_since_epoch().count())</span></span>;</span><br><span class="line"><span class="comment">//ä»¥å®æ—¶æ—¶é—´ä½œä¸ºç§å­äº§ç”Ÿä¸€ä¸ª64ä½æ•°çš„éšæœºæ•°ï¼Œè°ƒç”¨çš„æ—¶å€™å†™rng(),å¯èƒ½ä¸ºæ­£ä¹Ÿå¯èƒ½ä¸ºè´Ÿ</span></span><br><span class="line"><span class="number">6.</span>__builtin_popcount( )<span class="comment">//è¿”å›æ‹¬å·å†…æ•°å­—äºŒè¿›åˆ¶è¡¨è¾¾ä¸­1çš„ä¸ªæ•°</span></span><br><span class="line"><span class="number">7.</span><span class="comment">//äºŒç»´mapï¼ˆä»¥intä¸ºä¾‹ï¼‰</span></span><br><span class="line">map&lt;<span class="type">int</span>,map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;mp;</span><br><span class="line"><span class="number">8.f</span><span class="keyword">or</span> (<span class="keyword">auto</span> t : &#123;<span class="string">&quot;DFS&quot;</span>, <span class="string">&quot;dfs&quot;</span>&#125;<span class="comment">//t[0]æœ‰ä¸¤ä¸ªï¼Œæ˜¯Då’Œdã€‚éƒ½ç­‰æ•ˆä¸ºt[0]</span></span><br><span class="line"><span class="number">9.</span><span class="built_in">substr</span>(èµ·å§‹ä½ç½®ï¼Œé•¿åº¦)<span class="comment">//ç”¨æ¥æˆªå–stringç±»å‹çš„å­—ç¬¦ä¸² </span></span><br><span class="line"><span class="number">10</span> s.<span class="built_in">replace</span>(p0,n0,n,ch)<span class="comment">//åˆ é™¤p0å¼€å§‹çš„n0ä¸ªå­—ç¬¦ï¼Œç„¶ååœ¨p0å¤„æ’å…¥nä¸ªå­—ç¬¦ch</span></span><br><span class="line"><span class="number">11.</span><span class="comment">//åœ¨å¹³é¢å†…ï¼Œä»(0,0)åˆ°ç‚¹(x,y)çš„è·¯å¾„æ•°f[x][y]=f[x-1][y]+f[x][y-1]</span></span><br><span class="line"><span class="number">12.</span><span class="comment">//ceilå‡½æ•°å‘ä¸Šå–æ•´ï¼ˆå¯¹æµ®ç‚¹ï¼‰</span></span><br><span class="line"><span class="number">13.</span><span class="comment">// 0x7fffffffè¡¨ç¤ºintç±»å‹çš„æœ€å¤§å€¼(7ä¸ªf)</span></span><br><span class="line"><span class="number">14.</span><span class="comment">//åœ¨æ•°å­—å‰é¢è¡¥é›¶ printf(â€œ%050dâ€,n)-----æ ¼å¼åŒ–è¾“å‡º50ä½çš„nï¼Œä¸å¤Ÿçš„åœ¨å‰é¢è¡¥é›¶ã€‚</span></span><br><span class="line"><span class="number">15.</span><span class="comment">//doubleå‹ä¸èƒ½ç”¨ä½è¿ç®—</span></span><br><span class="line"><span class="number">16.</span><span class="comment">// ç”¨coutè¾“å‡ºçš„æ—¶å€™Setprecision(p)è¡¨ç¤ºä¿ç•™æœ‰æ•ˆæ•°å­—pä½</span></span><br><span class="line"><span class="comment">//å†åŠ fixedå‰é¢ä¿®é¥°å¯ä»¥æ”¹ä¸ºä¿ç•™å°æ•°ç‚¹åpä½</span></span><br><span class="line"><span class="number">17.</span><span class="comment">//setwç”¨æ¥è®¾ç½®å­—æ®µå®½åº¦</span></span><br><span class="line"><span class="number">18.</span><span class="comment">//åŠ 0è¾¹ascllï¼Œå‡0å˜intï¼Œå‡â€˜aâ€™æ±‚ç¬¬å‡ ä¸ªä½ç½®ï¼Œ%26é˜²æ­¢çˆ†ä½</span></span><br><span class="line"><span class="number">19.</span><span class="comment">//ç±»ä¼¼å¯¹1e9+7å–æ¨¡è¦ä»ä¸€å¼€å§‹è®¡ç®—çš„æ—¶å€™å°±å–ï¼Œä¸èƒ½åªå¯¹ç­”æ¡ˆå–æ¨¡</span></span><br><span class="line"><span class="number">20.</span><span class="comment">//gcd(a,b)å’Œlcm(a,b)åœ¨a,bæœ€å°çš„æƒ…å†µä¸‹å°±æ˜¯a=gcdï¼ˆa,bï¼‰ä¸b=lcmï¼ˆa,bï¼‰;</span></span><br><span class="line"><span class="number">21.</span><span class="comment">//ç”¨kåŠ  ï¼ˆ1e9+7ï¼‰å†æ¨¡1e9+7é˜²æ­¢å› kå°äº0é€ æˆçš„é”™è¯¯</span></span><br><span class="line"><span class="number">22.</span><span class="comment">//å¼‚æˆ–å®é™…ä¸Šå°±æ˜¯äºŒè¿›åˆ¶çš„ä¸è¿›ä½åŠ æ³•ï¼Œå¼‚æˆ–åŒä¸€ä¸ªæ•°ä¸¤æ¬¡ç›¸å½“äºæ²¡æœ‰å¼‚æˆ–è¿™ä¸ªæ•°</span></span><br><span class="line"><span class="number">23.</span><span class="comment">//iotaé…åˆsortå®ç°å•æ•°ç»„çš„å¤šæ•°ç»„å¯¹åº”ä¸‹æ ‡ç»‘å®šæ’åº</span></span><br><span class="line"><span class="number">24.</span>.iotaï¼ˆèµ·å§‹ä½ï¼Œæœ«ä½ï¼Œåˆå§‹å€¼ï¼‰<span class="comment">//ç”¨æ¥æ‰¹é‡é€’å¢èµ‹å€¼æ•°ç»„ï¼Œå¢é‡ä¸º1 </span></span><br><span class="line"><span class="number">25.</span><span class="comment">//ç”¨STLåŒ…æ‹¬ä½è¿ç®—å¯èƒ½çˆ†intçš„æ—¶å€™è®°å¾—å†™æˆ0LL,1LL</span></span><br><span class="line"><span class="number">26.</span><span class="comment">//äºŒåˆ†æŸ¥æ‰¾.lower_boundå’Œupperæ‰¾ä¸åˆ°ä¼šè¿”å›æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ ä¸‹æ ‡+1       </span></span><br><span class="line"><span class="number">27.</span><span class="comment">//æ¸…ç©ºæ ‡è®°å½¢ä¸è¦ç”¨vector,ç”¨C-arrayè€å®çš„memset</span></span><br><span class="line"><span class="number">28.</span><span class="comment">//iotaé…åˆsortæ‰§è¡Œç»“æ„åŒ–æ’åº ä¸¾ä¾‹</span></span><br><span class="line"><span class="comment">//iota(p.begin(),p.end(),0);</span></span><br><span class="line"><span class="comment">//sort(p.begin(),p.end(),[&amp;](int i,int j)&#123;</span></span><br><span class="line"><span class="comment">//  return a[i]&lt;a[j];</span></span><br><span class="line"><span class="comment">//&#125;);</span></span><br><span class="line"><span class="comment">//è¯¥ä»£ç æ‰§è¡Œåæ˜¯pä¸­å…ƒç´ æŒ‰ç…§açš„å…ƒç´ å¤§å°è¿›è¡Œæ’åº,a[p[0]]å°±æ˜¯aä¸­ç¬¬0å°çš„å…ƒç´ å€¼</span></span><br><span class="line"><span class="comment">//p[0]å°±æ˜¯è¿™ä¸ªç¬¬ä¸€å°çš„å…ƒç´ åœ¨åŸæ•°ç»„ä¸­çš„åæ ‡</span></span><br><span class="line"><span class="number">29</span> <span class="comment">//è½¬ç§»çš„æ—¶å€™,è®°å¾—åˆå§‹åŒ–æ‰€æœ‰çš„æœ€å·¦ç«¯ç‚¹çš„å‰ä¸€ä¸ªæ•°(-1/0)</span></span><br><span class="line"><span class="comment">//æ‰€æœ‰çš„å³ç«¯ç‚¹åˆå§‹åŒ–ä¸ºå³ç«¯ç‚¹çš„åä¸€ä¸ªæ•°(n/n+1)</span></span><br><span class="line"><span class="number">30</span> <span class="comment">//vectoräºŒåˆ†æ’å…¥ï¼Œä¿è¯æ•°ç»„æœ‰åº</span></span><br><span class="line"><span class="comment">//a.insert(upper_bound(a.begin(),a.end(),x),x);</span></span><br><span class="line"><span class="comment">//insertæ˜¯åœ¨è¿­ä»£å™¨å‰ä¸€ä¸ªä½ç½®æ’å…¥å…ƒç´ </span></span><br></pre></td></tr></table></figure>

<h2 id="è¿›åˆ¶è½¬æ¢"><a href="#è¿›åˆ¶è½¬æ¢" class="headerlink" title="è¿›åˆ¶è½¬æ¢"></a>è¿›åˆ¶è½¬æ¢</h2><p>10è¿›åˆ¶è½¬å…¶ä»–è¿›åˆ¶ï¼ˆnæ˜¯æ•°å­—ï¼Œræ˜¯è¿›åˆ¶ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">unordered_map&lt;<span class="type">int</span>,<span class="type">char</span>&gt;it;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">char</span> s=<span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">10</span>;i&lt;=<span class="number">15</span>;i++)&#123;</span><br><span class="line">        it[i]=s++;</span><br><span class="line">        cout&lt;&lt;it[i]&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">init</span>();<span class="type">int</span> r,n;stack&lt;<span class="type">int</span>&gt; s; cin&gt;&gt;n&gt;&gt;r;</span><br><span class="line">    <span class="keyword">while</span>(n)&#123;</span><br><span class="line">        s.<span class="built_in">push</span>(n%r);</span><br><span class="line">        n/=r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(s.<span class="built_in">size</span>())&#123;</span><br><span class="line">        <span class="keyword">if</span>(s.<span class="built_in">top</span>()&lt;<span class="number">10</span>) cout&lt;&lt;s.<span class="built_in">top</span>();</span><br><span class="line">        <span class="keyword">else</span> cout&lt;&lt;it[s.<span class="built_in">top</span>()];</span><br><span class="line">        s.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–è¿›åˆ¶è½¬åè¿›åˆ¶</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">unordered_map&lt;<span class="type">char</span>,<span class="type">int</span>&gt;it;</span><br><span class="line"><span class="type">int</span> r,ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> s=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> i=<span class="string">&#x27;A&#x27;</span>;i&lt;=<span class="string">&#x27;Z&#x27;</span>;i++) &#123;</span><br><span class="line">        it[i]=s++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string n;cin&gt;&gt;r&gt;&gt;n;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        ans*=r;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">isalpha</span>(n[i])) ans+=it[n[i]];</span><br><span class="line">        <span class="keyword">else</span> ans+=n[i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans&lt;&lt;endl;</span><br></pre></td></tr></table></figure>

<p>å­—ç¬¦ä¸²è¿›åˆ¶è½¬åŒ–</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">stoi</span>(s) <span class="comment">//séœ€è¦æ˜¯å­—ç¬¦ä¸²ï¼Œåªèƒ½å°†stringç±»å‹å­—ç¬¦ä¸²è½¬åŒ–ä¸º10è¿›åˆ¶ï¼Œä¸”ä¸è¶…è¿‡intèŒƒå›´</span></span><br><span class="line"><span class="keyword">auto</span> s=<span class="built_in">to_string</span>(x)<span class="comment">//å°†xè½¬åŒ–ä¸ºå­—ç¬¦ä¸²å½¢å¼    </span></span><br></pre></td></tr></table></figure>

<h2 id="äºŒåˆ†"><a href="#äºŒåˆ†" class="headerlink" title="äºŒåˆ†"></a>äºŒåˆ†</h2><p>å·¦ç«¯ç‚¹å‡1ï¼Œå³ç«¯ç‚¹åŠ 1</p>
<h2 id="ä¸‰åˆ†æ¨¡æ¿"><a href="#ä¸‰åˆ†æ¨¡æ¿" class="headerlink" title="ä¸‰åˆ†æ¨¡æ¿"></a>ä¸‰åˆ†æ¨¡æ¿</h2><h3 id="æ•´æ•°ä¸‰åˆ†"><a href="#æ•´æ•°ä¸‰åˆ†" class="headerlink" title="æ•´æ•°ä¸‰åˆ†"></a>æ•´æ•°ä¸‰åˆ†</h3><p>æ¯æ¬¡éƒ½å°†åŒºé—´å˜ä¸º[l,mid1],(mid1,mid2],(mid2,r]ä¸‰ä¸ªåŒºé—´<br>æ ¹æ®æ¡ä»¶åˆ¤æ–­å°†l,ræŒ‡é’ˆç§»åŠ¨è‡³å“ªä¸ªåŒºé—´ï¼Œå¤æ‚åº¦ä¸ºlogä»¥3ä¸ºåº•(åŒºé—´å¤§å°)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> l=<span class="number">2</span>,r=<span class="number">999</span>;</span><br><span class="line">    <span class="keyword">while</span> (l&lt;r)&#123;</span><br><span class="line">        <span class="type">int</span> mid1 = l + (r - l) / <span class="number">3</span>;</span><br><span class="line">        <span class="type">int</span> mid2 = r - (r - l) / <span class="number">3</span>;</span><br><span class="line">        <span class="type">int</span> s=<span class="built_in">query</span>(mid1,mid2);</span><br><span class="line">        <span class="keyword">if</span> (s == mid1 * mid2)&#123;</span><br><span class="line">            l = mid2 + <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (s == mid1 * mid2 + mid1)&#123;</span><br><span class="line">            l = mid1 + <span class="number">1</span>;</span><br><span class="line">            r = mid2;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            r = mid1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;! &quot;</span> &lt;&lt; l &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å®æ•°ä¸‰åˆ†"><a href="#å®æ•°ä¸‰åˆ†" class="headerlink" title="å®æ•°ä¸‰åˆ†"></a>å®æ•°ä¸‰åˆ†</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-9</span>;<span class="comment">//æ ¹æ®æ¡ä»¶åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">while</span>(r - l &lt; eps) &#123;</span><br><span class="line">    <span class="type">double</span> lmid = l + (r - l) / <span class="number">3</span>;</span><br><span class="line">    <span class="type">double</span> rmid = r - (r - l) / <span class="number">3</span>;</span><br><span class="line">    lans = <span class="built_in">cal</span>(lmid),rans = <span class="built_in">cal</span>(rmid);</span><br><span class="line">    <span class="comment">// æ±‚å‡¹å‡½æ•°çš„æå°å€¼</span></span><br><span class="line">    <span class="keyword">if</span>(lans &lt;= rans) r = rmid;</span><br><span class="line">    <span class="keyword">else</span> l = lmid;</span><br><span class="line">    <span class="comment">// æ±‚å‡¸å‡½æ•°çš„æå¤§å€¼</span></span><br><span class="line">    <span class="keyword">if</span>(lans &gt;= rans) l = lmid;</span><br><span class="line">    <span class="keyword">else</span> r = rmid;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; l &lt;&lt; endl;</span><br></pre></td></tr></table></figure>

<h2 id="Trick"><a href="#Trick" class="headerlink" title="Trick"></a>Trick</h2><h3 id="æ¯”èµ›ç›¸å…³"><a href="#æ¯”èµ›ç›¸å…³" class="headerlink" title="æ¯”èµ›ç›¸å…³"></a>æ¯”èµ›ç›¸å…³</h3><ol>
<li>è®¤çœŸè¯»é¢˜è‡³å°‘2éï¼Œå¿…è¦æ—¶å’Œé˜Ÿå‹ç¡®è®¤é¢˜æ„</li>
<li>æƒ³æ€è·¯å‰åŠ¡å¿…å¸¦å…¥æ ·ä¾‹éªŒè¯æ€è·¯ï¼Œå¦åˆ™è¯·é‡å¤æ­¥éª¤1</li>
</ol>
<h3 id="åˆ‡å…¥ç‚¹-å…¸ä¸­å…¸"><a href="#åˆ‡å…¥ç‚¹-å…¸ä¸­å…¸" class="headerlink" title="åˆ‡å…¥ç‚¹&#x2F;å…¸ä¸­å…¸"></a>åˆ‡å…¥ç‚¹&#x2F;å…¸ä¸­å…¸</h3><ol>
<li>å­åºåˆ—é€‰æ‹©é—®é¢˜ï¼Œæš´åŠ›åšæ³•æ˜¯æšä¸¾æ‰€æœ‰å¯èƒ½çš„å­åºåˆ—ï¼Œå½“ç„¶è¿™ä¸€å®šåšä¸åˆ°ï¼Œå¤æ‚åº¦æ˜¯$2^n$çº§åˆ«çš„</li>
</ol>
<p>â€‹      sol1 ä¸€èˆ¬è¿™ç±»é—®é¢˜éƒ½å¯ä»¥é€šè¿‡dpè§£å†³ï¼Œæ‰¾åˆ°èƒ½å¤Ÿâ€æ‹¼æ¥â€èµ·æ¥çš„è½¬ç§»æ–¹ç¨‹</p>
<p>â€‹	  sol2 é€šè¿‡ç»„åˆæ•°è§£å†³ï¼Œæ³¨æ„åº”è¯¥ç›´æ¥è®¡ç®—ä¿ç•™çš„å­åºåˆ—æ–¹æ¡ˆæ•° not åˆ é™¤çš„ç§ç±»æ•°</p>
<ol start="2">
<li><p>qä¸ªè¯¢é—®æ­¤ç±»é—®é¢˜ä¸€èˆ¬éƒ½æ˜¯å¤æ‚åº¦O(1)[æå‰é¢„å¤„ç†]ï¼ŒO(logn)[é¢„å¤„ç†ååœ¨çº¿è¯¢é—®]</p>
</li>
<li><p>åŒºé—´[l,r]è¯¢é—®,è½¬æ¢æˆå‰ç¼€å’Œå¤„ç†,å³pre[r]-pre[l-1]</p>
</li>
</ol>
<h3 id="æ•°è®º"><a href="#æ•°è®º" class="headerlink" title="æ•°è®º"></a>æ•°è®º</h3><ol>
<li>å°†æ•°xåˆ†å¼€ï¼Œæ¯å—æœ€å¤štï¼Œåˆ†å¼€çš„æ“ä½œä¸ºæ‹†æˆä¸¤ä¸ªå’Œä¸ºxçš„æ­£æ•´æ•°ï¼Œæ±‚æ¬¡æ•°</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">ans += (a[i] - <span class="number">1</span>) / t;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ä¸­ä½æ•°å°±æƒ³äºŒåˆ†</li>
<li>äºŒè¿›åˆ¶ä¹˜ä»¥2ï¼Œç›¸å½“äºæ•´ä¸ªæ•°å·¦ç§»ä¸€ä½ï¼Œæœ«ä½è¡¥0ï¼Œä¹˜$2^{k}$å°±æ˜¯å·¦ç§»kä½</li>
<li>6x+8y+10z,å–æ•°ä¸é™å¯ä»¥éå†&gt;&#x3D;6çš„æ‰€æœ‰å¶æ•°</li>
<li>å¯¹äºä¸€ä¸ªæ•°ç»„ä¸­çš„gcdï¼Œä»å·¦åˆ°å³gcdå¦‚æœé€’å‡ï¼Œæ¯æ¬¡èµ·ç ç¼©å°ä¸€åŠ(åŸå› å°±æ˜¯gcdä¸€æ—¦å˜åŒ–ï¼Œä¸€å®šä¼šå˜æˆåŸæœ‰gcdçš„å› æ•°)ï¼Œæ‰€ä»¥gcdçš„å˜åŒ–æ˜¯logçº§åˆ«çš„</li>
</ol>
<h3 id="æ“ä½œé—®é¢˜"><a href="#æ“ä½œé—®é¢˜" class="headerlink" title="æ“ä½œé—®é¢˜"></a>æ“ä½œé—®é¢˜</h3><ol>
<li>æ•°ç»„ä¸­å¼‚æˆ–æœ€ç»ˆå˜æˆæŸä¸ªç¡®å®šæ•°çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨å‰&#x2F;åç¼€å¼‚æˆ–å’Œçš„æ–¹æ³•dpè½¬ç§»</li>
<li>å¾ªç¯ç§»ä½ - åŠ é•¿æ•°ç»„è‡³2å€,ç„¶åç›´æ¥æ‰¾å¾ªç¯èŠ‚å‡ºç°çš„èµ·å§‹å’Œç»“æŸä½ç½®</li>
<li>$æ“ä½œa_{i}-&#x3D;1;a_{i+1}+&#x3D;1$ï¼Œæ— æ“ä½œé™åˆ¶æ±‚æå·®ï¼Œå°†ä½¿å¾—åºåˆ—å˜æˆä¸é€’å‡åºåˆ—ï¼ŒäºŒåˆ†æ±‚æå¤§æå°åšå·®</li>
<li>æ“ä½œ$a_i+&#x3D;x$,æ¬¡æ•°ä¸é™ï¼Œæœ€ç»ˆè¦æ±‚åˆ°æŸä¸ªæ•°&#x2F;æ±‚mexâ€¦,å¯ä»¥ç”¨dp,dp[a[i]+x]+&#x3D;(dp[$a[i]$]-1)ï¼Œæˆ–è€…å¯¹xå–æ¨¡,ç”¨mapå­˜å‚¨,</li>
</ol>
<h3 id="å›¾è®º"><a href="#å›¾è®º" class="headerlink" title="å›¾è®º"></a>å›¾è®º</h3><ol>
<li>æœ‰å…¶ä»–å¢é¡¹çš„æœ€çŸ­è·¯</li>
<li>æœ‰æ— æŸç§ç‰¹æ€§å¯ä»¥ç‚¹æ•°*2ä¸ºæ— ï¼Œç‚¹æ•° *2+1ä¸ºæœ‰</li>
</ol>
]]></content>
      <categories>
        <category>XCPC</category>
        <category>XCPCæ¨¡æ¿</category>
        <category>XCPCæ‚é¡¹</category>
      </categories>
      <tags>
        <tag>STL</tag>
        <tag>Pre</tag>
        <tag>Dif</tag>
        <tag>Suf</tag>
        <tag>Stoi</tag>
        <tag>trisection</tag>
        <tag>Trick</tag>
        <tag>Cross-verification</tag>
        <tag>high precision</tag>
      </tags>
  </entry>
</search>
